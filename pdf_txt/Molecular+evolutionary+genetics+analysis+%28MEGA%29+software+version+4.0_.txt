 
MEGA 
Molecular Evolutionary Genetics Analysis 
VERSION 4 
 
 
 
 
 
 
 
 
Koichiro Tamura, Joel Dudley 
Masatoshi Nei, Sudhir Kumar 
 
Center of Evolutionary Functional Genomics 
Biodesign Institute 
Arizona State University 
  
  
i 1 Table of Contents 
2 PREFACE....................................................................................................... 1 
2.1 Copyright................................................................................................................. 1 
2.2 Guide to Notations Used ......................................................................................... 2 
2.3 Preface.................................................................................................................... 3 
2.4 Acknowledgements ................................................................................................. 5 
2.5 MEGA Software Development Team ...................................................................... 6 
2.6 Citing MEGA in Publications ................................................................................... 7 
3 PART I: GETTI NG ST ARTED ........................................................................ 9 
3.1 Installing MEGA....................................................................................................... 9 
3.1.1 System Requirements .................................................................................................... 9 
3.1.2 Installi ng ME GA.............................................................................................................. 9 
3.1.3 Uninstalli ng ME GA ......................................................................................................... 9 
3.2 Features & Support ............................................................................................... 10 
3.2.1 Feature List................................................................................................................... 10 
3.2.2 Using MEGA in the Classroom..................................................................................... 22 
3.2.3 Technical Suppor t and Updates ................................................................................... 22 
3.2.4 Reporti ng Bugs............................................................................................................. 22 
3.2.5 Guide to Nota tions Used .............................................................................................. 22 
3.3 A Walk Through MEGA......................................................................................... 23 
3.3.1 Introduction to Wa lk through MEGA............................................................................. 23 
3.3.2 Creating Multiple S equence Ali gnments ...................................................................... 24 
3.3.3 Estimating Evolutionary Distanc es from Nucleot ide Sequences ................................. 25 
3.3.4 Constructing Trees and Selecting OTUs from Nucleotide Sequences ........................ 26 
3.3.5 Tests of the Reliabilit y of a Tree Obtained ................................................................... 28 
3.3.6 Working With G enes and Do mains .............................................................................. 29 
3.3.7 Test of Positive Selection ............................................................................................. 30 
3.3.8 Managing Taxa wi th Groups ........................................................................................ 31 
3.3.9 Computing Statistical Quantiti es for Nucleoti de Sequences........................................ 31 
3.3.10  Constructing Trees fr om Distance Data ....................................................................... 33 
4 PART II: ASSEMBLING DATA FOR ANA LYSIS......................................... 35 
4.1 Text File Editor and Format Converter.................................................................. 35 
4.2 Trace Data File Viewer/Editor ............................................................................... 37 
4.3 Web Browser & Data Miner................................................................................... 38 
4.4 Some Text Editor Utilities...................................................................................... 39 
4.4.1 Open Saved Ali gnment Se ssion ................................................................................... 39 
4.4.2 Copy Screenshot to Clipboard ..................................................................................... 39 
4.4.3 Format Sele cted Sequence.......................................................................................... 40 
4.4.4 Reverse Co mplement................................................................................................... 40 
4.4.5 Convert to Mega Format  (in Text Editor)...................................................................... 40 
4.5 Building Sequence Alignments.............................................................................. 40 
4.5.1 Alignment Explorer ....................................................................................................... 40 
4.5.2 Creating Multiple S equence Ali gnments ...................................................................... 41 
4.5.3 Aligning coding sequences via protein sequences ...................................................... 42 
4.5.4 CLUSTALW .................................................................................................................. 43 
4.5.5 BLAST .......................................................................................................................... 45 
4.5.6 Menu Items in the A lignment Ex plorer ......................................................................... 47 
5 PART III:  INPUT DATA TYPES AND FILE  FORMAT................................. 55 Table of Contents 
ii 5.1.1 MEGA Format............................................................................................................... 55 
5.1.2 General Co nventions.................................................................................................... 55 
5.1.3 Sequence Input Data.................................................................................................... 57 
5.1.4 Distance I nput Data...................................................................................................... 62 
5.1.5 Tree Inpu t Data............................................................................................................. 65 
5.2 Importing Data from other Formats ....................................................................... 65 
5.2.1 Importing Data from  Other Fo rmats ............................................................................. 65 
5.2.2 Convert To MEGA Form at (Main F ile Menu)................................................................ 66 
5.3 Genetic Code Tables............................................................................................. 77 
5.3.1 Built-in Gene tic Codes.................................................................................................. 77 
5.3.2 Adding/Modifying Genet ic Code Tables....................................................................... 78 
5.3.3 Computing Statistical Attr ibutes (Genet ic Code).......................................................... 78 
5.3.4 Setup/Select Taxa & Groups Dialog............................................................................. 79 
5.3.5 Select Genetic Co de Table Dialog ............................................................................... 80 
5.4 Viewing and Exploring Input Data ......................................................................... 81 
5.4.1 Sequence Data  Explorer .............................................................................................. 81 
5.4.2 Distance Data  Explorer................................................................................................. 90 
5.5 Text File Editor and Format Converter.................................................................. 93 
5.6 Visual Tools for Data Management....................................................................... 98 
5.6.1 Setup/Select Taxa & Groups Dialog............................................................................. 98 
5.6.2 Groups of  taxa .............................................................................................................. 99 
5.6.3 Data Subset Selection.................................................................................................. 99 
6 PART IV:  EVOLUT IONARY AN ALYSIS ................................................... 101 
6.1 Computing Basic Statistical Quantities for Sequence Data................................. 101 
6.1.1 Basic Sequence Statistics .......................................................................................... 101 
6.1.2 Nucleotide and Amino Acid Compositions ................................................................. 101 
6.1.3 Pattern Menu .............................................................................................................. 101 
6.2 Computing Evolutionary Distances ..................................................................... 102 
6.2.1 Distance Models......................................................................................................... 102 
6.2.2 Specifying Distance Estimation Options..................................................................... 136 
6.3 Constructing Phylogenetic Trees ........................................................................ 138 
6.3.1 Phylogenetic In ference............................................................................................... 138 
6.3.2 NJ/UPGMA Methods .................................................................................................. 139 
6.3.3 Minimum Evolut ion Me thod ........................................................................................ 140 
6.3.4 Maximum Parsimony  (MP) Method ............................................................................ 142 
6.3.5 Statistical Tests of  a Tree Obtained ........................................................................... 144 
6.3.6 Molecular Clock Tests ................................................................................................ 146 
6.3.7 Handling Missing Data and Alignment Gaps.............................................................. 147 
6.4 Tests of Selection................................................................................................ 148 
6.4.1 Synonymous/Non-syn onymous Tests........................................................................ 148 
6.4.2 Other Tests................................................................................................................. 152 
7 PART V: VISUALIZING AND EX PLORING DATA AND RESULTS.......... 153 
7.1 Distance Matrix Explorer ..................................................................................... 153 
7.1.1 Distance Matr ix Explorer ............................................................................................ 153 
7.1.2 Average Menu (in Distance  Matrix Ex plorer).............................................................. 154 
7.1.3 Display Menu (in Distan ce Matrix Explorer) ............................................................... 154 
7.1.4 File Menu (in Distance  Matrix Ex plorer) ..................................................................... 155 
7.2 Sequence Data Explorer ..................................................................................... 155 
7.2.1 Data Menu .................................................................................................................. 157 
7.2.2 Display Menu.............................................................................................................. 159 
7.2.3 Highlight Menu............................................................................................................ 162 
7.2.4 Statistics Menu ........................................................................................................... 163 Table of Contents 
iii 7.3 Tree Explorer....................................................................................................... 164 
7.3.1 Tree Expl orer.............................................................................................................. 164 
7.3.2 Informati on Box .......................................................................................................... 165 
7.3.3 File Menu (in Tr ee Explorer)....................................................................................... 165 
7.3.4 Image Menu (in Tr ee Explorer) .................................................................................. 166 
7.3.5 Subtree Menu (in Tree Expl orer)................................................................................ 166 
7.3.6 Subtree Drawing Option s (in Tree Ex plorer) .............................................................. 166 
7.3.7 Cutoff Val ues Tab....................................................................................................... 167 
7.3.8 Divergence Time  Dialog Box...................................................................................... 167 
7.3.9 View Menu (in Tree Explorer)..................................................................................... 167 
7.3.10  Options dialog box (i n Tree Ex plorer)......................................................................... 168 
7.3.11  Tree tab (in Option s dialog box) ................................................................................. 168 
7.3.12  Branch tab (in Op tions dialog box)............................................................................. 168 
7.3.13  Labels tab (in Options  dialog box).............................................................................. 169 
7.3.14  Scale Bar tab (in Op tions dialog box)......................................................................... 169 
7.3.15  Compute Menu (in Tree Expl orer).............................................................................. 169 
7.4 Alignment Explorer.............................................................................................. 169 
7.4.1 Alignment Explorer ..................................................................................................... 169 
7.4.2 Creating Multiple S equence Ali gnments .................................................................... 170 
7.4.3 Aligning coding sequences via protein sequences .................................................... 171 
7.4.4 Menu Ite ms................................................................................................................. 174 
8 APPENDIX.................................................................................................. 181 
8.1 Appendix A: Frequently Asked Questions........................................................... 181 
8.1.1 Computing statistics on only high lighted sites in Data Ex plorer................................. 181 
8.1.2 Finding the number of sites in pair-wise comparisons ............................................... 181 
8.1.3 Get more information about the c odon based Z-test for selection ............................. 181 
8.1.4 Menus in MEGA are so short; where are all the options?.......................................... 181 
8.1.5 Writing only 4-fold degenerate  sites to an output file ................................................. 182 
8.2 Appendix B: Main Menu Items and Dialogs Reference....................................... 183 
8.2.1 Main MEGA Menus .................................................................................................... 183 
8.2.2 Setup/Select Taxa & Groups Dialog........................................................................... 188 
8.2.3 Setup/Select Taxa & Groups Dialog........................................................................... 190 
8.2.4 MEGA Dialogs ............................................................................................................ 199 
8.3 Appendix C: Error Messages .............................................................................. 204 
8.3.1 Blank Names Are Not Permitted ................................................................................ 204 
8.3.2 Data File Pa rsing Error............................................................................................... 204 
8.3.3 Dayhoff/JTT Distance C ould Not Be Computed......................................................... 204 
8.3.4 Domains Cannot  Overlap ........................................................................................... 204 
8.3.5 Equal Input Corr ection Failed..................................................................................... 204 
8.3.6 Fisher's Exact Test Has Failed................................................................................... 204 
8.3.7 Gamma Distance Fail ed Because p > 0.99................................................................ 204 
8.3.8 Gene Names Must  Be Unique.................................................................................... 205 
8.3.9 Inapplicable Computat ion Requ ested ........................................................................ 205 
8.3.10  Incorrect Co mmand Used........................................................................................... 205 
8.3.11  Invalid special symbol in molecula r sequences ......................................................... 205 
8.3.12  Jukes-Cantor Distance Failed .................................................................................... 205 
8.3.13  Kimura Distance Failed .............................................................................................. 205 
8.3.14  LogDet Distance Coul d Not Be Computed................................................................. 205 
8.3.15  Missing data or invalid di stances in the matrix........................................................... 206 
8.3.16  No Common Sites ...................................................................................................... 206 
8.3.17  Not Enough Grou ps Selected..................................................................................... 206 
8.3.18  Not Enough Taxa  Selected ........................................................................................ 206 
8.3.19  Not Yet Im plemented.................................................................................................. 206 
8.3.20  p distance is found to be > 1 ...................................................................................... 206 Table of Contents 
iv 8.3.21  Poisson Correction Fail ed because p > 0.99 ............................................................. 206 
8.3.22  Tajima-Nei Distance C ould Not Be Computed........................................................... 207 
8.3.23  Tamura (1992) Distance Could Not Be  Computed .................................................... 207 
8.3.24  Tamura-Nei Distance C ould Not Be Computed ......................................................... 207 
8.3.25  Unexpected Error ....................................................................................................... 207 
8.3.26  User Stopped Computation ........................................................................................ 207 
8.4 Appendix D: Glossary.......................................................................................... 208 
8.4.1 ABI File Form at........................................................................................................... 208 
8.4.2 Alignment  Gaps.......................................................................................................... 208 
8.4.3 Alignment session ...................................................................................................... 208 
8.4.4 Bifurcatin g Tree .......................................................................................................... 208 
8.4.5 Branch ........................................................................................................................ 208 
8.4.6 ClustalW ..................................................................................................................... 209 
8.4.7 Codon ......................................................................................................................... 209 
8.4.8 Codon Usage.............................................................................................................. 209 
8.4.9 Complete-Delet ion Op tion .......................................................................................... 209 
8.4.10  Composition Distance................................................................................................. 209 
8.4.11  Compress/Uncompress.............................................................................................. 210 
8.4.12  Condens ed Tree......................................................................................................... 210 
8.4.13  Constant Site .............................................................................................................. 210 
8.4.14  Degeneracy ................................................................................................................ 210 
8.4.15  Disparity Index............................................................................................................ 210 
8.4.16  Domains ..................................................................................................................... 211 
8.4.17  Exon........................................................................................................................... .211 
8.4.18  Extant Taxa ................................................................................................................ 211 
8.4.19  Flip........................................................................................................................... ...211 
8.4.20  Format command ....................................................................................................... 211 
8.4.21  Gamma para meter ..................................................................................................... 211 
8.4.22  Gene........................................................................................................................... 212 
8.4.23  Groups of  taxa ............................................................................................................ 212 
8.4.24  Indels ......................................................................................................................... .212 
8.4.25  Independent Sites....................................................................................................... 212 
8.4.26  Intron......................................................................................................................... ..212 
8.4.27  Maximum Compos ite Like lihood ................................................................................ 213 
8.4.28  Max-mini branch-a nd-bound search........................................................................... 213 
8.4.29  Maximum Parsimony  Principle ................................................................................... 213 
8.4.30  Mid-point rootin g......................................................................................................... 213 
8.4.31  Monophyletic .............................................................................................................. 213 
8.4.32  mRNA ......................................................................................................................... 213 
8.4.33  NCBI ........................................................................................................................... 214 
8.4.34  Newick Format............................................................................................................ 214 
8.4.35  Node ........................................................................................................................... 214 
8.4.36  Non-synonym ous change........................................................................................... 214 
8.4.37  Nucleotide Pair Frequencies ...................................................................................... 215 
8.4.38  OLS branch lengt h estimates ..................................................................................... 215 
8.4.39  Orthologous Genes .................................................................................................... 215 
8.4.40  Out-group ................................................................................................................... 215 
8.4.41  Pair-wise-delet ion option ............................................................................................ 216 
8.4.42  Parsimony-infor mative site ......................................................................................... 216 
8.4.43  Polypept ide................................................................................................................. 216 
8.4.44  Positive selection........................................................................................................ 216 
8.4.45  Protein pa rsimony....................................................................................................... 216 
8.4.46  Purifying se lection ...................................................................................................... 216 
8.4.47  Purines........................................................................................................................ 216 
8.4.48  Pyrimidines ................................................................................................................. 216 
8.4.49  Random addi tion trees ............................................................................................... 216 Table of Contents 
v 8.4.50  RSCU.......................................................................................................................... 217 
8.4.51  Singleton Sites............................................................................................................ 217 
8.4.52  Staden ........................................................................................................................ 218 
8.4.53  Statements in input files ............................................................................................. 218 
8.4.54  Swap........................................................................................................................... 218 
8.4.55  Synonymous change.................................................................................................. 218 
8.4.56  Taxa........................................................................................................................... .218 
8.4.57  Topological distance................................................................................................... 219 
8.4.58  Topology..................................................................................................................... 219 
8.4.59  Transition.................................................................................................................... 219 
8.4.60  Transition Matrix......................................................................................................... 219 
8.4.61  Transition/Transvers ion Ratio (R) .............................................................................. 219 
8.4.62  Translation.................................................................................................................. 219 
8.4.63  Transversion............................................................................................................... 219 
8.4.64  Unrooted tree.............................................................................................................. 219 
8.4.65  Variable site................................................................................................................ 220 
9 INDEX......................................................................................................... 221  
1 2 Preface 
2.1 Copyright 
Copyright © 1993 - 2008.  
This software is protected under the copyri ght law.  No part of this manual or 
program design may be reproduced without written permission from copyright 
holders.  Please e-mail all in quires to s.kumar@asu.edu. 
 
 Molecular Evolutionary Genetics Analysis 
2 2.2 Guide to Notations Used 
Item Convention Example 
Directory & file 
names Small Cap + Bold I
NSTALL .TXT 
File name 
extensions Small Cap + 
Bold .TXT, .DOC, .MEG 
Email address/URLs Underlined www.megasoftware.net 
 
Pop-up help links Dotted 
Underlined + 
Green statement  
Help Jumps Underlined + Green set of rules  
Menu/Screen Items Italic Data Menu 
User-Entered 
Text Monospace font !Title 
 Preface 
3 2.3 Preface 
Genome sequencing is generating vast am ounts of DNA sequence data from a 
wide range of organisms. As a resu lt, gene sequence databases are growing 
rapidly.  In order to co nduct efficient analyses of thes e data, there is a need for 
easy-to-use computer programs, containi ng fast computational algorithms and 
useful statistical methods.   
The objective of the MEGA  software has been to provide tools for exploring, 
discovering, and analyzing DNA and protei n sequences from an evolutionary 
perspective.  The first version was developed for the lim ited computational 
resources that were available on the av erage personal computer  in early 1990s. 
MEGA1  made many methods of evolutionary analysis easily accessible to the 
scientific community for research and education.  MEGA2 was designed to 
harness the exponentially great er computing power and a graphical interface of 
the late 1990’s, fulfilling the fast-gro wing need for more ex tensive biological 
sequence analysis and exploration softw are.  It expanded the scope of its 
predecessor from single gene to genome wide analyses. Two versions were 
developed (2.0 and 2.1), each supporti ng the analyses of molecular sequence 
(DNA and protein sequences) and pair-wise distance data.  Both  could specify 
domains and genes for multi-gene com parative sequence analysis and could 
create groups of sequences t hat would facilitate the estimation of within- and 
among- group diversities and infer the highe r-level evolutionary relationships of 
genes and species.  MEGA2  implemented many methods for the estimation of 
evolutionary distances, the calculat ion of molecular sequence and genetic 
diversities within and among groups, and t he inference of phylogenetic trees 
under minimum evolution and maximum par simony criteria. It included the 
bootstrap and the confidence probability tests of relia bility of the inferred 
phylogenies, and the disparity index te st for examining the heterogeneity of 
substitution pattern between lineages. 
MEGA 4  continues where MEGA2  left off, emphasizing the integration of 
sequence acquisition with evolut ionary analysis. It contains  an array of input data 
and multiple results explorers for visual  representation; the handling and editing 
of sequence data, sequence alignments,  inferred phylogenetic trees; and 
estimated evolutionary distances.  The re sults explorers allow users to browse, 
edit, summarize, export, and generate publ ication-quality captions for their 
results. MEGA 4  also includes distance matrix and phylogeny explorers as well 
as advanced graphical modules for the visual representation of input data and output results. These features, which we discuss below, set MEGA apart from 
other comparative s equence analysis programs 
As with previous versions, MEGA 4  is specifically designed to reduce the time 
needed for mundane tasks in data analysis and to provide statistical methods of 
molecular evolutionary genetic analysis in an easy-to-use computing workbench.  
While MEGA 4  is distinct from previous vers ions, we have made a special effort 
to retain the user-friendl y interface that researcher s have come to identify with 
MEGA
.  This interface is obtains info rmation from the user only on a need-to-Molecular Evolutionary Genetics Analysis 
4 know basis.  Furthermore, the data subset s and output results are stored in files 
for viewing only if the user specifically needs to do so.   
 
 
 Preface 
5 2.4 Acknowledgements 
Many friends and colleagues have prov ided encouragement and assistance in 
the development of MEGA .  Beta Test versions of MEGA have been used in the 
research laboratories of the authors, in  the classrooms of Sudhir Kumar at the 
Arizona State University and Masatoshi Nei at the Pennsylvania State University, 
and by the thousands of users that signed up for the MEGA Beta program.  The 
feedback and bug reports provided by these gr oups of users were invaluable to 
the development team.  Almost all facets  of design and implementation benefited 
from their comments and suggestions. 
MEGA  software development is currently s upported by research grants from the 
National Institutes of Health.  Molecular Evolutionary Genetics Analysis 
6 2.5 MEGA Software Development Team 
Project  Directors and Principal Programmers  
 Sudhir Kumar and Koichiro Tamura 
Associate Programmers  
 Joel Dudley and Daniel Peterson Website Manager and Designs
 
 Linwei Wu and Wayne Parkhurst Quality Assurance
 
 Linwei Wu and the MEGA team 
See also Acknowledgements.  
 Preface 
7 2.6 Citing MEGA in Publications 
If you wish to cite MEGA  in your publications, we suggest the following: 
(1) When referring to MEGA  in the main text of your publication, you may choose a 
format such as:  
Phylogenetic and molecular evolutionary analyses were conducted using MEGA  
version 4 (Tamura, Dudley, Nei, and Kumar 2007).  
(2) When including a MEGA  citation in the Literature Cited/Bibliography section, you may 
use the following: 
Tamura K, Dudley J, Nei M & Kumar S ( 2007 ) MEGA4 : Molecular Evolutionary 
Genetics Analysis (MEGA) software version 4.0. Molecular Biology and Evolution 
24:1596-1599.  (Publication PDF at http://www.kumarlab.net/publications ) 
  
9 3 Part I: Getting Started 
3.1 Installing MEGA 
3.1.1 System Requirements 
MEGA  was developed for use on Micros oft Windows® operating systems: 
Windows 95/98, NT, ME, 2000, XP, or late r.  We recommend a computer with at 
least 64 MB of RAM, 20 MB of availa ble hard disk space, and an entry- level 
Pentium® processor or equivale nt.  Our tests show that MEGA  runs well on 
computers with an entry-level  Pentium® CPU.  However, for quick computation 
of large datasets, you should have a fast er processor and larger amount of 
physical memory (RAM).  MEGA  also can be run on other operating systems for 
which Windows emulators are available. 
 Platform Software 
Macintosh Windows using VirtualPC  
Sun Workstation SoftWindows95 
Linux Windows using VMWare  
 
3.1.2 Installing MEGA 
The preferred way to install MEGA  is directly from the website 
(www.megasoftware.net).  A specially designed installation program 
automatically downloads MEGA  and installs it in the location (directory) you 
specify.   
If you are unable to install MEGA  directly from the webs ite, you can download it 
as a single compressed ZIP file.  Then y ou must use a program, such as WinZip, 
to uncompress this ZIP file in a temporary director y.  Click on the 
MEGAS
ETUP .EXE file to install MEGA  on your computer automatically. 
Finally, you may install MEGA  from a CD obtained from the authors.  In this case, 
insert the media into the co mputer and then click on MEGAS ETUP .EXE. 
We recommend that you install MEGA  in one of the three ways described above.  
Please do not simply copy MEGA -related files from one computer to another, as 
MEGA  may not work properly if installed in this manner. 
 
3.1.3 Uninstalling MEGA 
The preferred way to uninstall programs in Windows  is to use Add/Remove 
Programs  option in the control panel, which is accessible from the Start  button on 
the lower left corner of your computer  desktop.  A dialog box (usually named 
Add/Remove programs ) will display a list of pr ograms.  To remove MEGA , scroll Molecular Evolutionary Genetics Analysis 
10 down to MEGA  so that it is highlighted, then click Add/Remove . 
 
3.2 Features & Support 
3.2.1 Feature List 
MEGA Version  1.0  2.x  3.x  4.x 
Platform  DOS Win Win Win 
Input Data  
DNA, Protein, Pair-wise distance 
matrix • • • • 
Sequence Alignment Construction  
Alignment Editor   
      Manual editing of DNA and Protein sequences       • • 
      Motif searching/highlighting       • • 
      Synchronous alignment editing of 
original and translated cDNA        • • 
      Copy/Paste sequences To/From 
Clipboard       • • 
      Save alignment session for future 
display       • • 
      Ability to read sequencer, MEGA, 
NEXUS, FASTA, and other formats       • • 
      Apply color/highlight schemes to sequence data       • • 
      Write alignment to MEGA file for       • • Part I: Getting Started 
11 direct analysis in MEGA 
      BLAST sequences from alignment 
directly       • • 
Multiple Sequence Alignment  
      Complete native implementation 
of ClustalW       • • 
      Ability to select all options on the 
fly       • • 
      Ability to align any user-selected region       • • 
      Ability to align translated cDNA 
sequences and automatic adjustment       • • 
Sequencer (Trace) File editor/viewer  
      View ABI (*.abi, .ab1) and Studfen (*.std?)       • • 
      Edit trace file       • • 
      Mask vector (or any other region)       • • 
      Launch direct BLAST search for whole or selected sequence       • • 
      Send data directly to Alignment 
Editor       • • 
Integrated Web Browser  and Sequence Fetching   
      Direct "u sual" web and GenBank 
browsing from MEGA       • • 
      One-click sequence fetching from 
databanks queries       • • 
      Send sequence data from BLAST       • • Molecular Evolutionary Genetics Analysis 
12 search directly into alignment 
      Bookmark favorite sequence 
databank sites       • • 
Data Handling  
Handling ambiguous states (R,Y,T, etc.)    • • • 
Extended MEGA format to save all data attributes    • • • 
Importing Data from other formats 
(Clustal/Nexus/etc.)    • • • 
Data Explorers   
      Sequence  • • • • 
      Distance matrix     • • • 
Attributes supported   
      Groups of Sequences/Taxa     • • • 
      Domains  • • • • 
      Genes and Mixed Domain 
attributes     • • • 
      Explicit labels for sites     • • • 
      Automatic codon translation  • • • • 
      Selection of codon positions  • • • • 
      Selection of different site categories     • • • 
Visual Specification of Domains/Groups     • • • Part I: Getting Started 
13 Center Analysis Preferences Dialog       • • 
Unlimited Data size for Analysis    • • • 
Genetic Code Table Selection  
Choose a desired table • • • • 
Ability to add/edit user defined tables    • • • 
Computation of statistical attributes of a code table   
      Degeneracy of codon positions     • • • 
      Numbers of potential synonymous 
sites     • • • 
Inclusion of all known code tables    • • • 
Real-Time Caption Expert Engine 
Generate Captions for Distance Matrices      • 
Generate Captions for Phylogenies      • 
Generate Captions for Tests      • 
Generate Captions for Alignments    • 
Copy Captions to External Programs    • 
Save/Print Captions    • 
Integrated Text File Editor  
Unlimited Text File Size    • • • 
Multi-file Tabbed Display    • • • 
Columnar Block selection/Editing    • • • Molecular Evolutionary Genetics Analysis 
14 Undo/Redo operations    • • • 
Line numbers    • • • 
Utilities to Format Sequences/Reverse 
complement etc.    • • • 
Copy Screenshots to 
EMF/WMF/Bitmap for presentation    • • • 
Sequence Data Viewer  
Two dimensional display of molecular 
sequences • • • • 
Display with identity symbol     • • • 
Drag-drop sorting of sequences    • • • 
Mixing coding and non-coding sequence display    • • • 
One-click translation • • • • 
Display with all or only selected taxa    • • • 
Data Export   
      PAUP3, PHYLIP  • • • • 
      PAUP4, PHYLIP Interleaved     • • • 
Highlighting   
      0,2,4-fold degenerate sites  • • • • 
Variable, parsimony informative sites • • • • 
      Constant Sites     • • • 
Statistical Quantities estimation   Part I: Getting Started 
15 DNA and protein sequence 
compositions • • • • 
Estimation by genes/domains/groups     • • • 
                Codon Usage  • • • • 
Estimation by genes/domains/groups    • • • 
                Use only highlighted sites     • • • 
MCL-based Estimation of Nucl eotide Substitution Patterns 
4x4 Rate Matrix     • • 
Transition/Transversion Rate Ratios 
(k1, k2)   • • 
Transition/Transversion Rate Bias (R)   • • 
Substitution Pattern Homogeneity Test  
Composition Distance    • • • 
Disparity Index    • • • 
Monte-Carlo Test    • • • 
Distance Estimation Methods  
Nucleotide-by-Nucleotide   
      Models  
                No. of differences, p-distance, Jukes-Cantor, Kimura 2P  • • • • 
                Tajima-Nei, Tamura 3-parameter, Tamura-Nei distance  • • • • 
                LogDet (Tamura-Kumar)               • • Molecular Evolutionary Genetics Analysis 
16 Maximum Composite Likelihood    • 
      Subcomponents  
                Transitions (ts), 
tranversions (tv), ts/tv ratio  • • • • 
                Number of common sites     • • • 
      Account for rate variation among sites • • • • 
      Relaxation of the homogeneity assumption       • • 
Synonymous/Non-synonymous (Codon-by-Codon)  
      Models  
               Nei-Gojobori (1986) method • • • • 
           Modified Nei-Gojobori method    • • • 
       Li-Wu-Lou, PBL, Kumar method    • • • 
      Subcomponents  
                Synonymous (s), non-synonymous (n) distances  • • • • 
                Numbers of synonymous and non-synonymous sites     • • • 
                Differences and ratios (s-n, n-s, s/n, n/s)     • • • 
                4-fold degenerate site 
distances     • • • 
                0-fold degenerate site 
distances     • • • Part I: Getting Started 
17                 Number of 0-fold and 4-fold 
degenerate sites     • • • 
Protein distance   
      Number of differences, p-distance, Poisson  • • • • 
      Dayhoff and JTT distances       • • 
      Account for rate variation among 
sites    • • • 
      Relaxation of the homogeneity 
assumption       • • 
Distance Calculations   
      Pair-wise  • • • • 
      Between Group Average         • • • 
      Within Group Average     • • • 
      Net between group Average     • • • 
      Overall average     • • • 
Sequence Diversity Calculations  
      Mean Diversity within Subpopulations    • • • 
      Mean Diversity for Entire 
Population     • • • 
      Mean Interpopulational Diversity     • • • 
      Coefficient of Differentiation     • • • 
Variance Calculations   
      Analytical  • • • • Molecular Evolutionary Genetics Analysis 
18       Bootstrap     • • • 
Handling missing data • • • • 
Automatic translation • • • • 
Automatic pasting of partial codons 
between exons    • • • 
Tests of Selection  
Codon-based tests  
      Large sample Z-test  • • • • 
                Between Sequences  • • • • 
                Within groups     • • • 
                Overall sequences     • • • 
      Fisher's Exact Test     • • • 
Tajima's Test of Neutrality    • • • 
Molecular Clock Test  
Tajima's relative rate test    • • • 
Tree-making Methods  
Neighbor-Joining   • • • • 
      Randomized tie-breaking in 
bootstrapping     • • • 
Minimum Evolution method      • • • 
      Branch-swapping (Close-
Neighbor-Interchange; CNI)     • • • Part I: Getting Started 
19       Fast OLS computation method     • • • 
UPGMA   • • • • 
      Randomized tie-breaking in 
bootstrapping     • • • 
Maximum Parsimony   
      Nucleotide sequences  • • • • 
      Protein sequences     • • • 
      Max-mini branch-and-bound and min-mini searches • • • • 
      Branch-swapping (CNI)     • • • 
      Average branch length estimation    • • • 
Bootstrap Test of Phylogeny   
      Neighbor-joining/UPGMA  • • • • 
      Minimum Evolution     • • • 
      Maximum Parsimony     • • • 
Confidence Probability Test  
      Neighbor-joining  • • • • 
      Minimum Evolution     • • • 
Consensus tree construction • • • • 
Condensed tree construction • • • • 
Distance Matrix Viewer  
View pair-wise distances     • • • Molecular Evolutionary Genetics Analysis 
20 View between group distances     • • • 
View within group distances     • • • 
View distances and standard errors 
simultaneously     • • • 
Sort the distance matrix     • • • 
      Drag-and-drop     • • • 
      Group-wise     • • • 
      By Sequence names     • • • 
Control display precision     • • • 
Export Data for printing or re-importing     • • • 
Tree Explorers  
Phylogeny Display and Graphic printing  • • • • 
On-the-spot taxa name editing     • • • 
Multiple phylogeny views     • • • 
Linearized Tree     • • • 
Estimation of divergence time by calibrating molecular clock     • • • 
Copy to Clipboard/sav e to file as an 
EMF drawing     • • • 
Save to Newick format        • • 
Read trees from Newick format       • • Part I: Getting Started 
21 User specified control for   
      Placement and precision of branch 
length     • • • 
      Scale bar addition     • • • 
      Collapsing branches or groups     • • • 
      Display only a subtree     • • • 
      Ability to view multiple trees in 
different viewers     • • • 
Tree Editing  
      Flipping, re-rooting     • • • 
      Add marker symbols to names     • • • 
      Multi-color display and printing     • • • 
Change Tree Size  
      Vertical se paration between taxa     • • • 
      Horizontal size     • • • 
      Change Tree shape     • • • 
Multiple tree display     • • • 
Save tree session for future display     • • • 
What you see is what you get printing    • • • 
Multi- or single page printing     • • • 
Display images on tree for groups and taxa       • • 
       Molecular Evolutionary Genetics Analysis 
22 3.2.2 Using MEGA in the Classroom 
Because MEGA  includes many statistical met hods for the study of molecular 
evolution in an interactive fr amework, it is instructive for classroom teaching.  If 
you are interested in using MEGA  in the classroom, ther e are no restrictions. 
Your students may download a copy from  the website www.m egasoftware.net or 
you may install copies on multiple com puters in a common co mputing area.    
However, if you want to use MEGA  in any other form, please contact the authors 
by e-mail (s.kumar@asu.edu). 
If you are using MEGA  in classroom teaching, please send us the following 
information by e-mail for our records (s .kumar@asu.edu).  (1) Your name, 
position and institution, (2 ) course number and title, (3) number of students, and 
(4) course semester and year.   
3.2.3 Technical Support and Updates 
All minor (bug fix) and major updates of MEGA  will be made available at the 
website www.megasoftware.net.  We will send e-mail to all registered MEGA  
users whenever an updated version of the program or the on line help manual is 
made available. 
 
3.2.4 Reporting Bugs 
If you encounter technical problems such  as unexplained errors, documentation 
inconsistencies, or program crashes, please report them to us by e-mail at 
bugs@megasoftware.net.  For further in formation on reporting problems, consult 
the bug report page on the MEGA websit e (www.megasoftware.net).  Please 
note that telephone inquiri es will not be accepted. 
Please include the following information in  your report: (1) your name and 
address, (2) the version of MEGA you are working with, (3) the version of 
Windows you are working in, (4) a copy of  your data file (if possible), (5) a 
description of the problem, and (6) the sequence of events that led to that 
problem [this often is crucial to understanding and remedying the problem 
quickly]. 
 
3.2.5 Guide to Notations Used 
Item Convention Example 
Directory & file 
names Small Cap + Bold I
NSTALL .TXT 
File name 
extensions Small Cap + 
Bold .TXT, .DOC, .MEG 
Email address/URLs Underlined www.megasoftware.net 
 Part I: Getting Started 
23 Pop-up help links Dotted 
Underlined + 
Green statement  
Help Jumps Underlined + 
Green set of rules  
Menu/Screen 
Items Italic Data Menu 
User-Entered Text Monospace font !Title 
 
3.3 A Walk Through MEGA 
3.3.1 Introduction to Walk through MEGA 
This section provides a MEGA tutorial. The data files for these examples can be 
found in the EXAMPLES  folder, located in the MEGA installation directory 
(example in C:\Program Files\MEGA\Examples) .  In these example files, data 
are deliberately written in different input  formats. We recommend that you study 
the examples in the order presented because the techniques explained in the 
initial examples are used again in the subsequent ones.  
In the following write-up, highlighted  words indicate the keys you must press on 
the keyboard. If you must press two ke ys simultaneously, they are shown with a 
+ sign between them ( e.g., Alt + F3 means that the Alt and F3 keys should be 
pressed simultaneously). Italicized letters  are used to mark the commands found 
in menus, submenus, and other locations  as they appear on the computer 
screen. In every example, we discuss many procedures introducing analytical 
techniques. For ease of reference in later examples, these procedures are 
numbered in the Ex u.v.w  format, where u is the example number, v is the 
procedure number, and w is the step number. For instan ce, Ex 1.3.2 refers to the 
2nd step of the 3rd proc edure in example 1. 
 
A list of tutorials is as follows: 
1. Aligning Sequences  2. Estimating Evolutionary Distances  3. Building Trees  
4. Testing Tree Reliability  
5. Marking Genes/Domains  6. Testing for Selection  
7. Grouping Sequences  
8. Computing Seque nce Statistics  Molecular Evolutionary Genetics Analysis 
24 9. Trees from Distance Data  
 
3.3.2 Creating Multiple Sequence Alignments 
In this example, we will create an ali gnment from protein sequence data that will 
be imported into the alignment ed itor using different methods.  
Ex 1.0.1: Start MEGA by double-clicking on the MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. 
Ex 1.0.2: Launch the Alignment Expl orer by selecting the Alignment|Alignment 
Explorer/CLUSTAL  menu command. 
In order to align sequenc es contained in a Sequence Data File, do the following: 
Ex 1.1.1: Add unaligned sequences from the hs p20.fas example file into the 
Alignment Explorer by clicking selecting the Data|Open|Retrieve  Sequences 
from File menu command. 
Ex 1.1.2:  Select the Edit|Select All  menu command to select every site for all 
sequences in the alignment. Ex 1.1.3:  Select the Alignment|Align by ClustalW  menu command to align the 
selected sequences data usi ng the ClustalW algorithm. 
Ex 1.1.4:  Save the current alignment  session by selecting the Data|Save 
Session menu item. This will allow the current  alignment session to be restored 
for future editing. Ex 1.1.5:  Exit the Alignment Explorer by selecting the Data|Exit Alignment 
Explorer menu item. A mess age will appear asking if you would like to save the 
data to a MEGA file. Choose "YES," and then a "Save As" dialog box will 
appear. Enter hsp20_aligned.meg as the file name, and click the "Save" button. 
An input box will appear asking for a ti tle for the data. Enter "HSP 20 Aligned by 
MEGA" as the title, and click the "OK"  button. Another di alog box will appear 
asking you if the sequence data is protein coding. In this case, click "Yes." A 
final dialog box will appear asking you if you would like to open the data file in 
MEGA. Click "Yes."  
Now, we will examine how to send seque nce data from the Internet (Web 
Explorer) to the Alignment Explorer.  
Ex 1.2.1:  If the Alignment Explorer already contains sequence data, select the 
Data| Create new menu command to create a new alignment from Alignment 
Explorer window. Choose "YES" on the di alog box that appears to indicate that 
you are creating a DNA sequence.  Ex 1.2.2:  Activate the Web Expl orer tab by selecting Web|Query Gene Banks  
from the menu. Ex 1.2.3:  When the NCBI Entrez  site is loaded, select either the nucleotide or 
protein database, enter a search term in to the search box, and press the "GO" 
button. 
Ex 1.2.4:  When the search results are displayed,  select the specific search item 
and choose "Sequence" from the menu bar. Press the "Add to Alignment" button Part I: Getting Started 
25 located to the left of the address box. This will display the Web Fetch dialog 
window. 
Ex 1.2.5:  Click the box to the left of each accession number whose sequences’ 
information you would like to fetch from  the web. When you are done, you can 
select accessions by pressing the "Fetch" button. 
Ex 1.2.6:  When the status column indicate s that all sequences are fetched, 
press the "Send to Alignment" button to send the fetched sequence data to the 
Alignment Explorer. Ex 1.2.7:  Align the fetched data using the steps detailed in Ex 1.1.2 – Ex 1.1.5.  
You may also open a trace file in the Trace Data Viewer/Editor  and send it 
directly to the Alignment Explorer. 
 
3.3.3 Estimating Evolutionary Di stances from Nucleotide Sequences 
In this example, we will compute various distances for the Adh sequences from 
11 Drosophila  species. We will use the data from the previous example to study 
various sequence statistics. In addition, we will see how these distances can be 
written in a file in vari ous formats through options fo r page size, precision, and 
relative placement of distanc es and their standard errors.  
 
Ex 2.0.1:   Start MEGA by double-clicking on the MEGA desktop icon, or by 
using the Windows start-menu to cli ck on the MEGA icon located in the 
programs folder. Activate the data file Dr osophila_Adh.meg using the in structions given in Ex 
2.2.1 – Ex 2.2.3.  We will begin by computing the proporti on of nucleotide differences between 
each pair of Adh sequences.  
Ex 2.1.1:   Select the Distance|Compute Pair-wise  command (F7) to display the 
distance analysis preferences dialog box. Ex 2.1.2:   In the Options Summary tab, click the Model preference pull-down 
and then select the Nucleotide|p-distance  option.  
Ex 2.1.3:   You may look around at the other opt ions, but at this moment, we will 
be using the defaults for the remainin g options. Click "Compute" to begin the 
computation. Ex 2.1.4:   A progress indicator will appear briefly, and then the distance 
computation results will be displayed in grid form in a new window. We will now compute distances and co mpare them using other methods. 
Ex 2.2.1:   Select the Distance|Compute Pair-wise command. Use the  Models  
pull-down to select the Nucleotide|Jukes-Cantor method. Now click "Compute" 
to begin the computation.  Ex 2.2.2:   Follow the steps in Ex. 2. 1.1- Ex 2.1.3 and compute the Tamura-Nei 
Distance . 
Ex 2.2.3:   You should now have open results windows containing the distances 
estimated by three different met hods, which you can now compare. 
Ex 2.2.4:   After you’ve compared the results, select the File|Quit Viewer option 
for each result window. Molecular Evolutionary Genetics Analysis 
26 Summary: we have computed nucleotide di stances from the nucleotide sequence 
data in the file Dr osophila_Adh.meg.  
Let us now compute the proportion of ami no acid differences. Note that MEGA 
will automatically translate the nucleot ide sequences into amino acid sequences 
using the selected genetic code table.  
Ex 2.3.1:  Select the Distance|Compute Pair-wise  command (F7) to display the 
distance analysis preferences dialog box. 
Ex 2.3.2:   In the  Options Summary tab, click the Models pulldown and then 
select the Amino Acid|p-distance  option.  
Ex 2.3.3:   Click the "Compute" button to accept the default values for the rest of 
the options and begin the computation. 
Ex 2.3.4:   A progress dialog bo x will appear briefly. As  with the previous 
nucleotide estimation, a results viewer  window will be displayed, showing the 
distances in a grid format.  
Ex 2.3.5:   After you have inspected the results, use the File|Quit Viewer  
command to close the results viewer. To shut down MEGA, select the File|Exit 
menu command from the main MEGA applic ation window and indicate that you 
would like to close the data file. 
  
3.3.4 Constructing Trees and Selecti ng OTUs from Nucleotide Sequences 
The Crab_rRNA.meg file contains nucl eotide sequences for the large subunit 
mitochondrial rRNA gene from di fferent crab species (Cunningham et al. 1992). 
Since the rRNA gene is transcr ibed, but not transla ted, it falls in the category of 
non-coding genes. Let us use this data file to illustrate the procedures of building 
trees and in-memory sequence data editing, using the commands present in the 
Data and Phylogeny  menus.  
 
Ex 3.0.1:   Start MEGA by double-clicking on the MEGA desktop icon, or by 
using the Windows start-menu to cli ck on the MEGA icon located in the 
programs folder.  
Ex 3.1.1:   Activate the data file Crab_rRNA.meg using the instructions given in 
Ex 2.1.1 - Ex 2.1.3.  
Let us start by building a neighbor-joining tree.  
Ex 3.2.1:   Select the Phylogeny|Construct Phylogeny|Neighbor-Joining  
command to display the analysi s preferences dialog box. 
Ex 3.2.2:   In the Options Summary tab, click the Models  pull-down (found in the 
Substitution Model section), and then select the Nucleotide|p-distance option.  
Ex 3.2.3:   Click "Compute" to accept the defaults  for the rest of  the options and 
begin the computations. A progress indica tor will appear briefly before the tree 
displays in the Tree Explorer. 
Ex 3.2.4:   
To select a branch, click on it with the left mouse button. If you click 
on a branch with the right m ouse button, you will get a small options menu that 
will let you flip the branch and perform vari ous other operations on it. To edit the Part I: Getting Started 
27 OTU labels, double click on them.  
Ex 3.2.5:   Change the branch style by using the View|Tree/Branch Style  
command from the Tree Explorer menu. 
Ex 3.2.6:   Press the Up arrow key ( ↑) just once to move t he cursor upwards to 
the next branch.  
Ex 3.2.7:   Select the View|Topology Only  command from the Tree Explorer 
menu to display the branching pattern ( without actual branch lengths on the 
screen.  
Ex 3.2.8:   Press F1 to examine the help for tree editor. Use this feature to 
become familiar with the many operations  that Tree Explorer is capable of 
performing.  
Ex 3.2.9:   DO NOT remove the tree from t he screen. We shall use it for 
illustrating how a tree can be printed.  
Now, you will print the NJ tree that you have on your screen in MEGA.   
Ex 3.3.1:   Select the File|Print  command from the Tree Explorer menu to bring 
up a standard Windows print dialog.  
Ex 3.3.2:   To restrict the size of the print ed tree to a single sheet of paper, 
choose the File|Print in a Sheet  command from the Tree Explorer menu.  
Ex 3.3.3:   Select the File|Exit  Tree Explorer (Ctrl-Q) command to exit the Tree 
Explorer. A warning box will inform you t hat your tree data has not been saved. 
Click the "OK" button to close Tree Expl orer without saving the tree session. 
 
In MEGA, you can also construct M aximum Parsimony (MP) trees. Let us 
construct a Maximum Parsimony tree(s) by using the branch-&-bound 
search  option.  
 
Ex 3.4.1:   Select the Phylogeny |Construct Phyl ogeny | Maximum Parsimony  
command. In the Analysis Preference  window, choose the Max-Mini Branch-&-
Bound Search option in the MP  Tree Search Options tab.  
Ex 3.4.2:   Click the "Compute" button to accept the defaults for the other options 
and begin the calculation. A progress window will appear  briefly, and the tree 
will be displayed in Tree Explorer. Ex 3.4.3:   Now print this tree (See Ex 3.3.1 - 3.3.2). You do not have to specify 
the printer name again, because MEGA  remembers your selection.  
Ex 3.4.4:   Select the File|Exit  Tree Explorer (Ctrl-Q) command to exit the Tree 
Explorer. A warning box will inform you that your tree data has not been saved. 
Click "OK" to close Tree Explorer  without saving the tree session. 
Ex 3.4.5:   Compare the NJ and MP trees. Fo r this data set, the branching 
pattern of these two trees is identical.  
As an exercise, use the Heuristic Search fo r finding the MP tree. In this example, 
you will find the same tree as that obtained by the branc h-and-bound method if 
you use the default option (search factor e qual to 2 for all steps of OTU addition). 
However, the computational time will be much  shorter. Actually, in this example, 
even a search factor equal to 0 will recover the MP tree.  
 Molecular Evolutionary Genetics Analysis 
28 We will now examine how some data editi ng features work in MEGA. For 
noncoding sequence data, OTUs as well as  sites can be selected for analysis. 
Let us remove the first OTU from the current data set.  
Ex 3.5.1:   Select the Data|Setup/Select Taxa & Groups  command. A dialog box 
is displayed. 
Ex 3.5.2:   All the OTU labels are checked ( ) in  the left box. This indicates that 
all OTUs are included in the current acti ve data subset. To remove the first OTU 
from the data, uncheck the checkbox ne xt to the OTU name in the left pane.  
Ex 3.5.3:  Now, from this data set, construc t a neighbor-joining tree (Ex 3.2.1) 
that contains 12 OTUs instead of 13. To  inactivate the operational data set and 
end the current session of MEGA , press the hot-key Alt + X.   
  
3.3.5 Tests of the Reliabili ty of a Tree Obtained 
In this example, we will conduct two diffe rent tests using protein-coding genes 
from the chloroplast genomes  of nine different species.  
Ex 4.0.1:   Start MEGA by double-clicking on the MEGA desktop icon, or by 
using the Windows start-menu to cli ck on the MEGA icon located in the 
programs folder. 
Ex 4.0.2:   Activate the data in the Chloro plast_Martin.meg file by using the 
File|Open  command.  
 We will begin with the bootstrap test for the neighbor-joining tree.  
Ex 4.1.1:   Select the Phylogeny |Bootstrap Test of Phylogeny|Neighbor-Joining 
Tree command from the main  application menu. 
Ex 4.1.2:   An analysis preferences dialog box appear s. Use the Models  pull-
down to ensure that the Amino Acid|p-distance model is selected. Note that only 
the Amino Acid submenu is available. 
Ex 4.1.3:  Click "Compute" to accept the default values for the rest of the options. 
A progress indicator provides the progress of the test as well as the details of 
your analysis preferences. Ex 4.1.4:  Once the computation is complete , the Tree Explorer appears and 
displays two tree tabs. The first tab is the original Neighbor-Joining tree, and the 
second is the Bootstrap consensus tree.  Ex 4.1.5:  To produce a condensed tree, use the Compute|Condensed Tree 
menu command from the Tree Expl orer menu. This tree shows all the branches 
that are supported at the default cutoff value of  BCL  ≥ 50.  
Ex 4.1.6:  To change this value, select the  View|Options  menu command and 
click the  cutoff values  tab. Select the Compute|Condensed Tree menu 
command and the NJ tree will reappear. Ex 4.1.7:  Print this tree. (see Ex 3.3.1 - Ex 3.3.2) 
Ex 4.1.8:
 Select the File|Exit Tree Explorer (Ctrl-Q) command to exit the Tree 
Explorer. A warning box will inform you t hat your tree data has not been saved. 
Click "OK" to close Tree Explorer  without saving the tree session. 
 Part I: Getting Started 
29 For neighbor-joining trees, you may conduc t the standard error test for every 
interior branch by using the Phylogeny|Neighbor-Joining  command. In MEGA, 
this test is available for the p-distance, Poisson Correction, and Gamma distance 
for amino acid sequences. Since we di d the above analysis fo r the p-distance, 
we will use the same distance estimation method to compare the results from the 
bootstrap and standard error tests. 
 
Ex 4.2.1:  Go to the Phylogeny  menu and select the Construct 
Phylogeny|Neighbor-Joining  command to produce an analysis preferences 
dialog box. In the Models preference pull-down, be sure that p-distance is the 
model chosen. Click on the Test of Phylogeny tab to reveal the test options. 
Under the Test of Inferred Phylogeny option group, check the  Interior Branch 
Test option.  
Ex 4.2.2:  Click "Compute" to begin the comp utation. A progress indicator will 
appear briefly. The neighbor-joining tr ee with confidence probabilities ( CP) from 
the standard error test of branch l engths is displayed on the screen. 
Ex 4.2.3: Compare the CP values on this tree with the BCL values of the tree 
that you printed in t he previous procedure. 
Ex 4.2.4:  Now exit MEGA using the Alt + X command.  
 
 
3.3.6 Working With Genes and Domains 
Ex 5.0.1:  Start MEGA by double-clicking on t he MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. 
Ex 5.0.2:  Activate the data present in t he Contigs.meg file by using the 
File|Open  command. 
 
We will now examine how to  define and edit gene and domain definitions 
Ex 5.1.1:  Select the Data|Setup/Select Genes & Domains  menu command. 
Ex 5.1.2:  Delete the Data domain by right clicking on it and selecting Delete 
Gene/Domain  from the popup menu. 
Ex 5.1.3:  Right-click on the Genes/Domains item in the Names column, and 
select Add New Domain . Right-click on the new domai n and select Edit Name 
from the popup menu and set the name to "Exon1." 
Ex 5.1.4:  Select the ellipsis button next to the question mark in the From  
column to set the first site of the domain. When the site selection window 
appears, select site number 1 and push the "OK" button. Ex 5.1.5:  Select the ellipsis button in the To column to set the last site of the 
domain. When the site selection windo w appears, select site number 3918 and 
push the "OK" button. Ex 5.1.6:  Check the box in the Coding
 column to indicate that this domain is 
protein coding. 
Ex 5.1.7:  Add two more domains to the G enes/Domains item. One of these 
domains will be named "Int ron1" and will begin at si te 3919 and end at site Molecular Evolutionary Genetics Analysis 
30 5191. The other will be named "Exon2" and will begin at site 5192 and end at 
site 8421. Be sure to c heck the checkbox in the Coding  column for "Exon2" to 
indicate a protein-coding domain. 
Ex 5.1.8:  Right-click on the Genes/Domains item and select Insert New Gene 
from the popup menu. Change the name of this gene to "Predicted Gene," and 
click-and-drag all of the domains to this  new gene such that they are displayed 
as children of the "Predicted Gene" node in the display tree. 
Ex 5.1.9:  Press the "Close" button at the bottom of the window to exit the 
Gene/Domain manager. 
We will now use these domain defi nitions in computing pair-wise 
distances. 
Ex 5.2.1:  Select the Distances|Compute Pair-wise  menu item from the main 
menu.  
Ex 5.2.2:  On the Include Sites  tab, make sure that t he "Noncoding sites" option 
does not have a checkmark next to it. Go back to the main menu and press the 
"Compute" button to begin the analysis. 
Ex 5.2.3:  When the computation is complete  the Distance Explorer will display 
the pair-wise distance computed using on ly the sequence data from exonic 
domains of the "Predicted Gene." 
  
3.3.7 Test of Positive Selection 
In this example, we present various  analyses of protein-coding nucleotide 
sequences for five alleles from the human HLA-A locus (Nei and Hughes 1991).  
Ex 6.0.1:  Start MEGA by double-clicking on t he MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. 
Ex 6.1.1:  Activate the data present in t he HLA_3Seq.meg file by using the 
File|Open  command.  
Ex 6.1.2:  Now that the data file is active, not e that various details about the data 
file are displayed at the bottom of the main application win dow, and more menu 
items have become availa ble on the main menu. 
Let us compute the synonymous and non-sy nonymous distances appropriate for 
studying positive Darwinian selection in this set of antigen recognition codons. 
 
Ex 6.2.1:  Select the Selection|Codon-based  Z-Tests from the  menu command. 
An analysis preferences dialog appears. Use the Models pull-down in the 
Options Summary tab  to select Syn-Nonsysnonymous|Nei-Gojobori Method|p-
distance model. In the  Test Hypothesis (HA: alternative) tab, select Positive 
Selection (HA: dN > dS) from the pull-down, and select the Overall Average 
from the Analysis Scope  tab. Click the GAPS/Missing Data tab and make sure 
that the Pair-wise Deletion  option is selected. 
Ex 6.2.2:  Click on "Compute" to accept the default values for the remaining 
options. A progress indicator appears br iefly; the computation results are Part I: Getting Started 
31 displayed in a results window in grid format. 
Ex 6.2.3:  The Prob column contains the probability  computed (must be <0.05 for 
hypothesis rejection at 5% level), and the Stat column contains the statistic used 
to compute the probability. The diffe rence in synonymous and non-synonymous 
substitutions should be significant at the 5% level. 
Ex 6.2.4:  Exit MEGA and deactivate the active data file using the Alt + X 
command. 
  
3.3.8 Managing Taxa with Groups 
Ex 7.0.1:  Start MEGA by double-clicking on t he MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. Ex 7.0.2:  Activate the data present in the Crab_rRNA.meg  file by using the 
File|Open  command. 
 
We will now examine ho w to define and edit groups of taxa. 
 
Ex 7.1.2:  Select the Data|Setup/Select Taxa & Groups  menu command. 
Ex 7.1.3:  Press the "New Group" button found below the Taxa/Groups pane to 
add a new group to the data. Name this new group "Pagurus." 
Ex 7.1.4:  While holding the Cont rol button on the keyboard, click on all of the 
Pagurus species in the Ungrouped Taxa p ane to highlight them. When they are 
all highlighted, press the left-facing arro w button found on the vertical toolbar 
between the two windowpanes. Ex 7.1.5:  Select the "All" group in t he Taxa/Groups pane and press the " New 
Group " button to add a second group. Name this group "Non-Pagurus." Add the 
remaining unassigned taxa to  this group and press the " Close " button at the 
bottom of the window to exit this view. Ex 7.1.6:  Now that groups have been defined, the Compute Within Group Mean , 
Compute Between Group Means , and Compute Net Between Group Means  
menu commands from the Distance  menu item may be used to analyze the 
data. 
  
3.3.9 Computing Statistical Quan tities for Nucleotide Sequences 
In this exercise, we ill ustrate the use of the Data Explorer  for computing various 
statistical quantities of nucl eotide sequences. In addition, we explain shortcuts for 
obtaining frequently used commands, methods of accessing on-line help, and the 
distinction between enabled and disabled commands.  
 
Ex 8.0.1:   Start MEGA by double-clicking on the MEGA  desktop icon, or by 
using the Windows start -menu to click on the MEGA  icon located in the 
programs folder. 
We now will examine the contents of the file Drosophila_Adh.meg by using Molecular Evolutionary Genetics Analysis 
32 the built-in Text Editor .  
Ex 8.1.1:   Click on the File menu item to expand the menu options.  To activate 
the text editor, either click File |Text Editor  or press the F3 key on your 
keyboard. In the text editor, use the File|Open command to open the 
Drosophila_Adh.meg  file. 
Ex 8.1.2:   Examine the Drosophila_Adh.meg  file. Take note of the #mega 
format specifier, title, OTU names , and the interleaved sequence data. 
Ex 8.1.3:   We advise that you exit the te xt editor before proceeding with data 
analysis. Select the File menu item from t he text editor's menu, and click the Exit 
option from the expanded menu.  If the editor asks you if you would like to save 
the changes that you have m ade to the file, select No. 
To study statistical quantities of the data in the file Drosophila_Adh.meg, 
we must first activate it.  
Ex 8.2.1:   You can activate a data file using the link titled "Click me to activate a 
data file" in the main applic ation window, or select the File menu item from the 
main menu and click the Open Data option from the expanded menu. You may 
also press the F5 key on your keyboard. All of these methods will display a 
standard Windows open f ile dialog box.  
Ex 8.2.2:   Open the Drosophila_Adh.meg data file under the Examples  folder. 
Ex 8.2.3:   A progress dialog box wil l appear briefly. When t he data file is active, 
details about it are displa yed at the bottom of the ma in application window. More 
menu items now are avail able on the main menu. 
Examine the main menu. Now that the data file is active, the menu items Data, 
Distances, Pattern, and Selection have become available. 
 
We now will use Data Explorer to com pute some basic statistics for these 
data.   
Ex 8.3.1:   Select the Data|Data Explorer  command, or press the  F4 key if the 
Sequence Data Viewer  is not available. 
Ex 8.3.2:   DNA sequences are displayed on t he screen in a grid format. Use the 
left and right arrow keys ( ←→) or the mouse to move from site to site; note a 
change in the bottom-left corner of the display. Use the up and down ( ↑↓) arrow 
keys or the mouse to move between OTUs. The Total Sites  view on the bottom-
left panel displays the sequence length under the current site position, and the 
Highlighted  Sites  display "None" because no special site attributes are yet 
highlighted. 
Ex 8.3.3:   To highlight variabl e sites, select the  Highlight|Variable Sites  option, 
click the button labeled "V" from the shor tcut bar below the menu, or press the V 
key. All sites that are variable are hi ghlighted, and the number in the Highlighted  
Sites  displays changes. When you press V again, the sites return to the normal 
color, and  Highlighted Sites  displays "None." 
Ex 8.3.4:   Now to highlight the parsimony-informative, press the P key, click on 
the button labeled "Pi" from the shortc ut bar below the m enu, or select the 
Highlight/Parsim-info sites menu command. To highlig ht 0, 2, and 4-fold 
degenerate sites, press the  0, 2, or 4 keys from the Sequence Data Explorer , 
respectively, click on the corresponding bu tton from the shortcut bar below the Part I: Getting Started 
33 menu, or select the corresponding command from the highlight menu.  
Ex 8.3.5:   To compute the nucleoti de base frequencies, select the 
Statistics|Nucleotide Composition menu command. This will calculate the 
composition and display the resu lts of the calculat ion in a text file using the built-
in text editor. 
Ex 8.3.6:   To compute codon usage, select the Statistics|Codon Usage menu 
command. This will calculate the codon usage and display t he results of the 
calculation in a text file us ing the built-in text editor. 
Ex 8.3.7:   To compute nucleotide pair frequencies, select the 
Statistics|Nucleotide Pair  Frequencies|Directional, or the Statistics|Nucleotide 
Pair Frequencies|Unidirectional menu command. This will calculate the pair 
frequencies and display the result s of the calculation in a text file using the built-
in text editor. Ex 8.3.8:   To translate these protein-c oding sequences into amino acid 
sequences and back, press the T key, or select the Data|Translate/Untranslate 
menu command from the Da ta Explorer menu.  
Ex 8.3.9:   Once the sequences are transla ted, calculate the amino acid 
composition by selecting the Statistics|Amino Acid Composition menu command 
from the Data Explorer  Menu. 
Ex 8.3.10:   To shut down MEGA, select the File|Exit menu command from the 
main MEGA application window and close the data file. 
 
 
3.3.10 Constructing Trees from Distance Data 
This example introduces procedures for selecting options from menus, opening 
files in the read-only mode, activating a di stance data file, and building trees from 
the distance data.  
Ex 9.0.1:   Start MEGA by double-clicking on the MEGA desktop icon, or by 
using the Windows start-menu to cli ck on the MEGA icon located in the 
programs folder. 
Ex 9.0.2:   A Splash screen  appears which displays the current version of 
MEGA.  Ex 9.0.3:   The Splash screen  automatically dis appears, and the MEGA 
application becomes available.  
In this example, we use the data in the Hum_Dist.meg file. Although we will 
not edit the file, we w ill use MEGA's built-in t ext editor to examine its 
contents before we proceed further. 
Ex 9.1.1:   Click on File menu to expand the menu options. Click on the menu 
item labeled  Text Editor,  or press the F3 key to activate the built-in text editor.  
Ex 9.1.2:   Use the Text Editor to view the contents of the  Hum_Dist.meg file. 
To open a file with the 
Text Editor,  click on the folder icon below the main menu 
or on the File menu item, then choose Open  from the expanded menu. You may 
also use the key combination Ctrl+O to open a file. All of these options will lead 
you to a standard Windows open file dialog box. Use this dialog box to locate 
the Examples folder found in the MEGA inst allation director y, and open the Molecular Evolutionary Genetics Analysis 
34 Hum_Dist.meg file. After you open the file with the dialog box, you will see the 
file contents displayed in the Text Editor window.  
Ex 9.1.3:   Examine the contents of t he data file and then exit the Text Editor 
before proceeding with data analysis. Select the File menu item from the Text 
Editor‘s menu, and click Exit from the expanded menu. If the editor asks you if 
you would like to save your changes, select No. A data file must be activated 
before an analysis can be performed. (Note t hat opening a file for browsing or 
editing is different from ac tivating it for analysis).  
Now we will activate the Hu m_Dist.meg data file.  
Ex 9.2.1:   You can activate a data file by  using the link titled "Click me to 
activate a data file" in the main ap plication window, or by selecting the File menu 
item from the main  menu and clicking the Open Data option from the expanded 
menu. You can also press the F5 key. All of these methods will display a 
standard Windows open f ile dialog box.  
Ex 9.2.2:   Use the open file dialog box to locate and open the Hum_Dist.meg 
file located in the Examples folder. After you have selected the file for opening, 
a progress indicator will appear briefly. 
Ex 9.2.3:   When the data file is active, the Input Distance Data Viewer  is 
launched to display the c ontents of the data file. 
We will now make a phylogenetic  tree from the distance data.  
Ex 9.3.1:   Switch back to main MEGA appl ication window. From the expanded 
menu in the Phylogeny  menu, select the Construct Phylogeny|Neighbor-Joining  
command.  Ex 9.3.2:   A confirmation Analysis Preferences  window will appear, indicating 
that MEGA is ready to conduct th e requested analysis. Click on the button 
labeled "Compute." A progre ss meter will appear briefly. 
Ex 9.3.3:   The Tree Explorer  will display a neighbor-joining tree on the screen 
when the analysis completes.  To exit the Tree Explorer , select the File menu 
item from the Tree Explorer  menu and click the Exit Tree Explorer option from 
the expanded menu. The Tree Explorer  will ask you if you would like to save the 
tree data. If you save the tree, you can use Tree Explorer  to view and 
manipulate it in the future.  
With this, let us end this session of MEGA.   
Ex 9.4.1:   Go to the File 
menu and click on the Close Data command. The 
program will inquire if you would like the active data to be closed. Select "Yes." 
Ex 9.4.2:   To exit MEGA, press Alt + X, or select the Exit command from the 
expanded File menu. 
 
  
35 4 Part II: Assembling Data for Analysis 
4.1 Text File Editor and Format Converter 
MEGA  includes a Text File Editor , which is useful for creating and editing ASCII 
text files. It is in voked automatically by MEGA  if the input data file processing 
modules detect errors in the data file format.  In this case, you should make 
appropriate changes and save the data file. 
The text editor is straightforward if you are familiar with programs like Notepad. 
Click on the section you wish to change, type in  the new text, or select text to cut, 
copy or paste. Only the display font can be used in a document. You can have as 
many different text editor windows open at one time and you may close them 
independently. However, if you have a file open in the Text Editor , you should 
save it and close the Text Editor  window before trying to use that data file for 
analysis in MEGA . Otherwise, MEGA  may not have the most  up-to-date version 
of the data. The Text File Editor and Format converter  is a sophisticated tool with numerous 
special capabilities that include: 
• Large files  –The ability to operate on files of virtually unlimited size and 
line lengths. 
• General purpose –Used to view/edit any ASCII text file. 
• Undo/ReDo  –The availability of an un limited depth of undo/redo options 
• Search/Replace  –Searches for and does block replacements for 
arbitrary strings. 
• Clipboard  – Supports familiar clipboard cut, copy , and paste  operations. 
• Normal and Column blocks  – Supports regular contiguous line blocks 
and columnar blocks.  This is qui te useful while manually aligning 
sequences in the Text Editor .  
• Drag/Drop  – Moves text with the familiar cut and paste operations or you 
can select the text and t hen move it with the mouse. 
• Screenshots  –Creates screen snapshots for teaching and 
documentation purposes directly from the edit window. 
• Printing  –Prints the contents of the edit file. 
 
The Text Editor  contains a menu bar, a toolbar, and a status bar. 
The Menu bar
 
Menu  Description  
File menu The File Menu contains the functions that are 
most commonly used to open, save, rename, Molecular Evolutionary Genetics Analysis 
36 print, and close files.  (Although there is no 
separate "rename" function available, you can 
rename a file by choosing the Save As… menu 
item and giving the file a different name before 
you save it.) 
Edit menu The Edit Menu contains  functions that are 
commonly used to manipula te blocks of text.  
Many of the edit menu items interact with the 
Windows Clipboard, which is a hidden window  
that allows various selections to be copied and 
pasted across documents and applications. 
Search  
menu The Search Menu has several functions that 
allow you to perform searches and replacements of text strings.  You can also 
jump directly to a specific line number in the 
file. 
Display  
menu  The Display Menu contains functions that affect the visual display of files in the edit windows. 
Utilities  
menu  The Utilities Menu contains several functions 
that make this editor especially useful for working with files containing molecular sequence data (note that the MEGA  editor 
does not try to understand the contained data, it simply operates on the text, assuming that 
the user knows what (s)he is doing. 
Toolbar
 
The Toolbar contains shortcuts to some frequently used menu commands. 
Status Bar  
The Status bar is positioned at the bo ttom of the editor window. It shows the 
position of the cursor (line number and posit ion in the line), whether the file has 
been edited, and the status of some  keyboard keys (CAPS, NUM, and SCROLL 
lock). 
 
Hotkeys and Shortcut keys 
Many menu items have a hotkey  and/or a shortcut  key.  These are special key 
combinations that are helpful for peopl e who are more comfortable using a 
keyboard than the mouse.  Hotkeys  are identified by an underscore character in 
the name of the m enu item, e.g., "F ile", "N ew".  These allow you to hold down the 
Alt-key, which is usually found next to t he space bar on the ke yboard, then hit the 
underlined letter to produce the same action as if you clicked that name with the 
mouse.  We show this using the notation <Alt>+key – e.g., the hotkey for the file 
menu item is shown as <Alt>+F.  Be sure that you depress both keys together, 
holding the <Alt> key down a little bit longer  than the letter key.  (Some people try 
hitting both keys simultaneously, as if they’re hitting two keys on a piano Part II: Assembling Data for Analysis 
37 keyboard.  Quite often, this approach  does not produce the desired results.) 
For instance, you could create a new f ile by clicking the mouse on the "File" 
menu item, then clicking on t he "New" item beneath it.  Using hotkeys, you could 
type <Alt>+F followed by <Alt>+N.  Or, mo re simply, while you’re holding down 
the <Alt> key, hit the ‘F’ key followed by  the ‘N’ key, then release the <Alt> key. 
You might notice that several menu it ems, e.g., the New Item on the File 
menu, show something to the right that looks like ‘Ctrl+N’.  This is called a 
Shortcut  key sequence.  Whereas execut ing a command with hotkeys often 
requires several keystrokes, shortcut keys can do the same thing with just one 
keystroke.   Shortcut keys work the sa me as hotkeys, using the <Ctrl> key 
instead of the <Alt> key.   To create a new file, for example, you can hold down 
the <Ctrl> key and hit the ‘N’ key, which is shown as <Ctrl>+N here.  (In the 
menus, this appears simply as ‘Ctrl+N’.)   
Not all menu items have associated s hortcut keys because there are only 
26 shortcut keys, one for each letter of the alphabet.  Hotkeys, in contrast, are 
localized to each menu and submenu.  For hotkeys to work, the menu item must 
be visible whereas shortcut keys work at any time.   For instance, if you are typing 
data into a text file and want to creat e a note in a new window, you may simply 
hit the shortcut key sequence, <Ctrl>+N  to generate a new wi ndow.  After you 
type the note, you can hit <Ctrl>+S to save it, give it a file name, hit the enter key 
[this part doesn’t make sense]; then you can hit the <Alt>+F+C hotkey sequence 
to close the file (there is no shortcut key for closing a file). 
  
4.2 Trace Data File Viewer/Editor 
Using this function, you can view and edit trace data produced by an automated 
DNA sequencer in ABI and Staden file fo rmats.  The sequences displayed can 
be added directly into the Alignment Explor er or sent to the Web Browser for 
conducting BLAST searches. 
A brief description of various functions  available in the Trace Data file 
Viewer/Editor is as follows: 
Data menu  
 Open File in New Window : Launches a new instance to view/edit another 
file. 
 Open File : Allows you to select another file to view/edit in the current window. 
 Save File : Save the current data to  a file in Staden format. 
 Print : Prints the current trace data,  excluding all masked regions. 
Add to Alignment Explorer : DNA sequence data, excluding all masked 
regions, is sent to the Alignment Explorer  and appears as a new sequence at 
the end of the current alignment. 
 Exit : Closes the current window. 
Edit menu  
 Undo : Use this command to undo one or more previous actions. Molecular Evolutionary Genetics Analysis 
38 Copy :  This menu provides options to (1) copy DNA sequences from FASTA 
or plain text formats to the clipboard  and (2) copy the exact portion you are 
viewing of the currently displayed trac e image to the clipboard in the Windows 
Enhanced Meta File format.  For FASTA format copying, both the sequence 
name and the DNA data will be copied, excluding the masked regions.  To copy only the selected portion of t he sequence, use the plain text copy 
command (If nothing is selected, then t he plain text command will copy the 
entire sequence, except for the masked regions). 
 Mask Upstream : Mask or unmask region to the left (upstream) of the cursor. 
 Mask Downstream : Mask or unmask region to t he right (downstream) of the 
cursor.  Reverse Complement : Reverse complements the entire sequence. 
Search menu  
 Find : Finds a specified query sequence. 
Find Next : Finds the next occurrence of t he query sequence. To specify the 
query sequence, first use the Find  menu command. 
 Find Previous : Finds the previous occurrence of a query sequence. To 
specify the query sequence, first use the Find  command. 
 Next N : Go to the next indete rminate (N) nucleotide. 
Search in File : This command searches another file, which you specify, for 
the selected sequence in the current windo w.  It can be used when you are 
assembling sequence subclones to build a contig. 
Do BLAST Search : Launch web browser to BLAS T the currently selected 
sequence.  If nothing is selected, t he entire sequence, excluding the masked 
regions, will be used. 
 
4.3 Web Browser & Data Miner 
MEGA  contains a fully functional Web Browser to assist users in sequence data 
retrieval and web exploration.  The most im portant feature that differentiates this 
web browser from other browsers (e.g., Netscape or Internet Explorer) is the 
 button.  Pressing this button causes the MEGA  web explorer to 
extract sequence data from the currently displayed web page and send it to the 
Alignment Explorer ’s alignment grid, where it will be inserted as new sequences. 
At present, the MEGA  web browser can interpret data displayed in FASTA format 
or in the default format at the NCBI webs ite.  (You can ask the NCBI website to 
display the data in the FASTA format by using the Display  option on the web 
page shown.)  (We plan to enhance this f unctionality further in version 3.1.) 
 
Furthermore, the MEGA  web browser provides a genomics database, exploration 
oriented interface for web search ing.  (In fact this is almost the same functionality 
as in the most recent versions  of the Internet Explorer.) 
 Part II: Assembling Data for Analysis 
39  
  This causes the web browser window to navigate back to 
the web location found before the current site in the 
explorer location history. 
 This causes the web browser window to navigate forward to the web location found after the current site in the 
explorer location history. 
 This causes the web browser to terminate loading a web 
location.  
 This causes the web browser to reload the current web location. 
 This causes the web browser to extract sequence data from the current w eb page and send it to Alignment 
Builder’s alignment grid as new sequence rows. If the web 
explorer is unable to find properly formatted sequence 
data in the current web page a warning box will appear. 
Address  Field The web location, or address field, is located in the second toolbar. This field contains the URL of the current web 
location as well as a pull down list of previously visited 
URLs. If a new URL is enter ed into the box and the Enter 
key is pressed, the web explorer will attempt to navigate to 
the entered URL. 
Links This toolbar provides shortc uts to a selection of websites. 
There are number of menus in the web browser, including Data , Edit, View , 
Links , Go, and Help .  These menus provide access to routine functionalities, 
which are self-explanatory in use. 
  
4.4 Some Text Editor Utilities 
4.4.1 Open Saved Alignment Session 
Alignment | Open Saved Alignment Session… 
Use this command to display a previously sa ved Alignment Explorer session (saved in a 
filename with . MAS extension). 
 
4.4.2 Copy Screenshot to Clipboard 
Utilities | Copy Screenshot to Clipboard  
This item presents three other options fo r selecting the format of an image that is 
being copied to the clipboard.  Once it is  copied, it can be pasted in any other 
graphic or word processing program. 
Bitmap Format : This is the common Windows Bitmap (BMP) Format. 
Windows Metafile Format : This selects the Window s Metafile Format (WMF) Molecular Evolutionary Genetics Analysis 
40 Enhanced Metafile Format : This selects the Windows Enhanced Metafile 
Format. 
 
4.4.3 Format Selected Sequence 
Utilities | Convert to Mega Format 
This submenu presents four other menu items that offer some common ways of 
reformatting text. 
Merge Multiple Lines : This is used to merge several separate lines into one 
long (very wide) line 
Remove Spaces/Digits : This is used to remove spaces and digits from a 
genetic sequence. Insert Spaces Every 3
: This is used to break the selected text into three-
character chunks (e.g., codons).  Note that it does not remove any already 
existing spaces.  
 Insert Spaces Every 1 0: This is used to break the selected text into ten-
character chunks. 
4.4.4 Reverse Complement 
Utilities | Reverse Complement 
This item reverses the order of char acters in the selected block and then 
replaces each character by its comple ment.  Only A, T, U, C, and G are 
complemented; the rest of the characters are left as they are.  Please use it 
carefully as MEGA  does not validate whether the c haracters in the selected block 
are nucleotides. 
 
4.4.5 Convert to Mega Format (in Text Editor) 
Utilities | Convert to Mega Format  
This item converts the sequence data in t he current edit window, or in a selected 
file, into a MEGA  format file.  It brings up a dialog box, which allows you to 
choose the file and/or the format for this purpose.  MEGA  converts the data file 
and displays the converted data in the editor.   
Files written in a number of popular data formats can be converted into MEGA 
format.  MEGA  supports the conversion of  CLUSTAL, NEXUS (PAUP, 
MacClade), PHYLIP, GCG, FASTA, PIR, NBRF, MSF, IG, and XML formats.  
Details about how MEGA reads and converts  these file formats are given in the 
section Importing Data from Other Formats. 
 
4.5 Building Sequence Alignments 
4.5.1 Alignment Explorer 
The Alignment Explorer  provides options to (1) view and manually edit 
alignments and (2) generate alignment s using a built-in CLUSTALW Part II: Assembling Data for Analysis 
41 implementation (for the complete sequenc e or data in any rectangular region).  
The Alignment Explorer  also provides tools for exploring web-based databases 
(e.g., NCBI Query and BLAST searches ) and retrieving desired sequence data 
directly into the current alignment. 
The Alignment Explorer  has the following menus in its main menu: Data , Edit, 
Search, Alignment, Web, Sequencer, Display, and Help.   In addition, there are 
Toolbars that provide quick access to many Alignment Explorer  functions. The 
main Alignment Explorer  window contains up to  two alignment grids. 
For amino acid input sequence data, the Alignment Explorer  provides only 
one view.  However, it o ffers two views of DNA sequence data:  the DNA 
Sequences grid and the Translated Prot ein Sequences grid.  These two views 
are present in alignment grids in the two tabs with each grid displaying the 
sequence data for the current alignment. Ea ch row represents a single sequence 
and each column represents a site.  A "*" character is used to indicate site 
columns, exhibiting consensus across all sequences. An entire sequence may be 
selected by clicking on the gray sequence label cell found to the left of the 
sequence data. An entire site may be sele cted by clicking on the gray cell found 
above the site column. The alignment grid has the ability to assign a unique color to each unique nucleotide or amino acid and it can display a background color for each cell in the grid. This behav ior can be controlled from the Display menu item 
found in the main menu. Pl ease note that when the Clust alW alignment algorithm 
is initiated, it only will align the sites cu rrently selected in th e alignment grids.  
Multiple sites may be selected by c licking and then dragging the mouse within 
the grid.  Note that all of the manual or automatic alignment procedures carried 
out in the Protein Sequences grid will be imposed on the corresponding DNA 
sequences as soon as you flip to the DNA sequence grid.  Even more 
importantly, the Alignment Explorer  provides unlimited UNDO capabilities. 
 
4.5.2 Creating Multiple Sequence Alignments 
In this example, we will create an ali gnment from protein sequence data that will 
be imported into the alignment ed itor using different methods. 
 
Ex 1.0.1: Start MEGA by double-clicking on the MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. 
Ex 1.0.2: Launch the Alignment Expl orer by selecting the Alignment|Alignment 
Explorer/CLUSTAL  menu command. 
In order to align sequenc es contained in a Sequence Data File, do the following: 
Ex 1.1.1: Add unaligned sequences from the hs p20.fas example file into the 
Alignment Explorer by clicking selecting the Data|Open|Retrieve  Sequences 
from File menu command. Ex 1.1.2:  Select the Edit|Select All  menu command to select every site for all 
sequences in the alignment. Ex 1.1.3:  Select the Alignment|Align by ClustalW  menu command to align the 
selected sequences data usi ng the ClustalW algorithm. Molecular Evolutionary Genetics Analysis 
42 Ex 1.1.4:  Save the current alignment  session by selecting the Data|Save 
Session menu item. This will allow the current  alignment session to be restored 
for future editing. 
Ex 1.1.5:  Exit the Alignment Explorer by selecting the Data|Exit Alignment 
Explorer menu item. A mess age will appear asking if you would like to save the 
data to a MEGA file. Choose "YES," and then a "Save As" dialog box will 
appear. Enter hsp20_aligned.meg as the file name, and click the "Save" button. 
An input box will appear asking for a ti tle for the data. Enter "HSP 20 Aligned by 
MEGA" as the title, and click the "OK"  button. Another di alog box will appear 
asking you if the sequence data is protein coding. In this case, click "Yes." A 
final dialog box will appear asking you if you would like to open the data file in 
MEGA. Click "Yes." 
 
Now, we will examine how to send seque nce data from the Internet (Web 
Explorer) to the Alignment Explorer. 
 
Ex 1.2.1:  If the Alignment Explorer already contains sequence data, select the 
Data| Create new menu command to create a new alignment from Alignment 
Explorer window. Choose "YES" on the di alog box that appears to indicate that 
you are creating a DNA sequence.  Ex 1.2.2:  Activate the Web Expl orer tab by selecting Web|Query Gene Banks  
from the menu. Ex 1.2.3:  When the NCBI Entrez  site is loaded, select either the nucleotide or 
protein database, enter a search term in to the search box, and press the "GO" 
button. Ex 1.2.4:  When the search results are displayed,  select the specific search item 
and choose "Sequence" from the menu bar. Press the "Add to Alignment" button 
located to the left of the address box. This will display the Web Fetch dialog 
window. Ex 1.2.5:  Click the box to the left of each accession number whose sequences’ 
information you would like to fetch from  the web. When you are done, you can 
select accessions by pressing the "Fetch" button. Ex 1.2.6:  When the status column indicate s that all sequences are fetched, 
press the "Send to Alignment" button to send the fetched sequence data to the 
Alignment Explorer. Ex 1.2.7:  Align the fetched data using the steps detailed in Ex 1.1.2 – Ex 1.1.5.  
You may also open a trace file in the Trace Data Viewer/Editor  and send it 
directly to the Alignment Explorer. 
 
You may also open a trace file in the Trace Data Viewer/Editor  and send it 
directly to the Alignment Explorer. 
 
4.5.3 Aligning coding seque nces via protein sequences 
MEGA provides a convenient method for aligning coding sequences based on 
the alignment of protein sequences. In order to accomplish this you use the Part II: Assembling Data for Analysis 
43 Alignment Explorer to load a data file containing protein-coding sequences. If you 
click on the Translated Protein Sequences tab you will see t hat the protein-
coding sequences are automatically trans lated into their respective protein 
sequence. With this tab active select the Alignment|Align by  ClustalW menu item 
or click on the "W" tool bar icon to begin the alignment of t he translated protein 
sequences. Once the alignment  of the translated prot ein sequences completes, 
click on the DNA Sequences tab and you’ll find that Alignment Explorer 
automatically aligned the pr otein-coding sequences according to the aligned 
translated protein sequences. Any manual  adjustments made to the translated 
protein sequence alignment will also be re flected in the protein-coding sequence 
tab.   
 
4.5.4 CLUSTALW 
AAbboouutt  CCLLUUSSTTAALLWW  
ClustalW is a widely used system for aligning any number of homologous 
nucleotide or protein sequences.  For mu lti-sequence alignments, ClustalW uses 
progressive alignment methods. In these,  the most similar sequences, that is, 
those with the best alignment score are a ligned first. Then progressively more 
distant groups of sequences are aligned un til a global alignment is obtained.   
This heuristic approach is necessary because finding the global optimal solution 
is prohibitive in both memory and time requirements.  ClustalW performs very 
well in practice.  The algorithm starts  by computing a rough distance matrix 
between each pair of sequences based on pair-wise sequence alignment scores. 
These scores are computed using the pai r-wise alignment par ameters for DNA 
and protein sequences.  Next, the algor ithm uses the neighbor-joining method 
with midpoint rooting to cr eate a guide tree, which is used to generate a global 
alignment.  The guide tree serves as a r ough template for clades that tend to 
share insertion and deletion features. This  generally provides a close-to-optimal 
result, especially when the data set c ontains sequences with varied degrees of 
divergence, so the guide tree is less sensitive to noise.   
 See: Higgins D., Thompson J., Gibson T. Thompson J. D., Higgins D. G., Gibson T. J.  
CLUSTAL W: improving t he sensitivity of progressive multiple sequence 
alignment through sequenc e weighting, position- specific gap penalties and 
weight matrix choice. Nucleic Acids Res. 22:4673-4680. (1994)  
CCLLUUSSTTAALLWW  OOppttiioonnss  ((DDNNAA))
  
This dialog box displays a single tab c ontaining a set of organized parameters 
that are used by ClustalW to align the DNA sequences. If you are aligning 
protein-coding sequences, pl ease note that CLUSTALW will not  respect the 
codon positions and may insert alignment gaps within codons.  For aligning 
cDNA or sequence data containing codons , we recommend that you align the Molecular Evolutionary Genetics Analysis 
44 translated protein sequences (see A ligning coding sequences via protein 
sequences). 
In this dialog box, you will see the following options: 
Parameters for Pair-wise Sequence Alignment  
Gap Opening Penalty : The penalty for opening a gap in the alignment. 
Increasing this value makes the gaps less frequent. 
Gap Extension Penalty : The penalty for extending a gap by one residue. 
Increasing this value will make the gaps  shorter. Terminal gaps are not 
penalized. 
Parameters for Multiple Sequence Alignment  
Gap Opening Penalty : The penalty for opening a gap in the alignment. 
Increasing this value makes the gaps less frequent. Gap Extension Penalty : The penalty for extending a gap by one residue. 
Increasing this value will make the gaps  shorter. Terminal gaps are not 
penalized. 
Common Parameters
  
DNA Weight Matrix : The scores assigned to matches and mismatches 
(including IUB ambiguity codes). 
Transition Weight : Gives transitions a weight bet ween 0 and 1. A weight of zero 
means that the transitions are scored as mismatches, while a weight of 1 gives 
the transitions the match score. For dist antly-related DNA sequences, the weight 
should be near zero; for closely-related se quences, it can be useful to assign a 
higher score. Use Negative Matrix : Enabled negative weight matrix values will be used if they 
are found; otherwise the ma trix will be automatically adjusted to all positive 
values. 
Delay Divergent Cutoff (%) :  Delays the alignment of the most distantly-related 
sequences until after the most closely-re lated sequences have been aligned. The 
setting shows the percent identity leve l required to delay the addition of a 
sequence. Sequences that is less identic al than this level will be aligned later. 
Keep Predefined Gaps : When checked, alignment posit ions in which ANY of the 
sequences have a gap will be ignored.  
 NOTE: All Definitions are deriv ed from the CLUSTALW manual. 
 
CCLLUUSSTTAALLWW  OOppttiioonnss  ((PPrrootteeiinn))
  
This dialog box displays a single tab c ontaining a set of organized parameters 
that are used by ClustalW to align DNA  sequences. If you are aligning protein-
coding sequences, please note that CLUSTALW will not  respect the codon 
positions and may insert alignment gaps within codons.  For aligning cDNA or 
sequence data containing codons, we reco mmend that you align the translated 
protein sequences (see Aligning coding sequences via protein sequences). 
In this dialog box, you will see the following options: Part II: Assembling Data for Analysis 
45 Parameters for Pair-wise Sequence Alignment  
Gap Opening Penalty : The penalty for opening a gap in the alignment. 
Increasing this value makes the gaps less frequent. 
Gap Extension Penalty : The penalty for extending a gap by one residue. 
Increasing this value will make the gaps  shorter. Terminal gaps are not 
penalized. 
Parameters for Multiple Sequence Alignment  
Gap Opening Penalty : The penalty for opening a gap in the alignment. 
Increasing this value makes the gaps less frequent. 
Gap Extension Penalty : The penalty for extending a gap by one residue. 
Increasing this value will make the gaps  shorter. Terminal gaps are not 
penalized. 
Common Parameters  
DNA Weight Matrix : The scores assigned to matches and mismatches 
(including IUB ambiguity codes). 
Residue-specific Penalties : Amino acid specific ga p penalties that reduce or 
increase the gap opening pena lties at each position or sequence in the 
alignment.  For example, posit ions that are rich in glycine are more likely to have 
an adjacent gap than positions that are rich in valine. See the documentation for 
details.  
Hydrophilic Penalties :  Used to increase the chances of a gap within a run (5 or 
more residues) of hydrophilic amino acids;  these are likely to be loop or random 
coil regions in which gaps are more common. Gap Separation Distance : Tries to decrease the chances of gaps being too 
close to each other.  Gaps  that are less than this distance apart are penalized 
more than other gaps.  This does not pr event close gaps; it makes them less 
frequent, promoting a block-lik e appearance of the alignment. 
Use Negative Matrix :  When enabled negative weight matrix values will be used 
if they are found; otherwise t he matrix will be automatica lly adjusted to all positive 
values. 
Delay Divergent Cutoff (%) :  Delays the alignment of the most distantly-related 
sequences until after the alignment of t he most closely-related sequences. The 
setting shows the percent identity leve l required to delay the addition of a 
sequence; sequences that are less identical than this level will be aligned later. 
Keep Predefined Gaps : When checked, any alignment positions in which ANY 
of the sequences have a gap will be ignored.   NOTE: All definitions are deriv ed from CLUSTALW manual. 
  
4.5.5 BLAST 
WWeebb  BBrroowwsseerr  &&  DDaattaa  MMiinneerr
  Molecular Evolutionary Genetics Analysis 
46 MEGA  contains a fully functional Web Browser to assist users in sequence data 
retrieval and web exploration.  The most im portant feature that differentiates this 
web browser from other browsers (e.g., Netscape or Internet Explorer) is the 
 button.  Pressing this button causes the MEGA  web explorer to 
extract sequence data from the currently displayed web page and send it to the 
Alignment Explorer ’s alignment grid, where it will be inserted as new sequences. 
At present, the MEGA  web browser can interpret data displayed in FASTA format 
or in the default format at the NCBI webs ite.  (You can ask the NCBI website to 
display the data in the FASTA format by using the Display  option on the web 
page shown.)  (We plan to enhance this f unctionality further in version 3.1.) 
Furthermore, the MEGA  web browser provides a genomics database, exploration 
oriented interface for web search ing.  (In fact this is almost the same functionality 
as in the most recent versions  of the Internet Explorer.) 
 
  This causes the web browser window to navigate back to the web location found before the current site in the 
explorer location history. 
 This causes the web browser window to navigate forward to the web location found after the current site in the 
explorer location history. 
 This causes the web browser to terminate loading a web 
location. 
 
 This causes the web browser to reload the current web location. 
 This causes the web browser to extract sequence data from the current w eb page and send it to Alignment 
Builder’s alignment grid as new sequence rows. If the web 
explorer is unable to find properly formatted sequence 
data in the current web page a warning box will appear. 
Address  Field The web location, or address fi eld, is located in the second 
toolbar. This field contains the URL of the current web 
location as well as a pull down list of previously visited 
URLs. If a new URL is enter ed into the box and the Enter 
key is pressed, the web explorer will attempt to navigate to 
the entered URL. 
Links This toolbar provides shortc uts to a selection of websites. 
There are number of menus in the web browser, including Data , Edit, View , 
Links , Go, and Help .  These menus provide access to routine functionalities, 
which are self-explanatory in use.  
DDoo  BBLLAASSTT  SSeeaarrcchh
  
Alignment | Do BLAST Search 
Use this to launch the BLAST search in the MEGA  Web Browser.  The web-browser is 
displayed with the BLAST facility at the NCBI website.  Part II: Assembling Data for Analysis 
47  
4.5.6 Menu Items in the Alignment Explorer 
TToooollbbaarrss  iinn  AAlliiggnnmmeenntt  EExxpplloorreerr  
 
Basic Functions 
 This prepares Alignment Builder  for a new alignment. Any 
sequence data currently loaded into Alignment Builder is 
discarded. 
 This activates the Open File dialog window. It is used to send 
sequence data from a properly  formatted file into Alignment 
Builder . 
  This activates the Save Alignment Session dialog window. It may 
be used to save the cu rrent state of the Alignment Builder into a file 
so that it may be restored in the future. 
 This causes nucleotide sequences currently loaded into Alignment 
Builder to be translated into their respective amino acid sequences. 
Web/Data Explorer Functions 
 This displays the NCBI BLAST web site in the Web Explorer tab 
window. If a sequence in the sequence grid is selected prior to 
clicking this button, the Web Expl orer will auto-fill the BLAST query 
window with the selected sequence data. 
 This displays the default database (GenBank) in the Web Explorer 
tab window. 
 This activates the Open Trace File dialog window, which may be 
used to open and view a sequencer file. The sequence data from the sequencer file then can be sent into Alignment Explorer . 
Alignment Functions 
 This displays the ClustalW parameters  dialog window, which is 
used to configure ClustalW and in itiate the alignment of the 
selected sequence data. If you do not  select sequence data prior to 
clicking this button, a message box will appear asking if you would 
like to select all of the currently loaded sequences. 
 This marks or unmarks the current ly selected single site in the 
alignment grid. Each sequence in the alignment may have only one 
site marked at a time. Modifica tions can be made to the alignment 
by marking two or more sites and then aligning them using the 
Align Marked Sites function. 
 This button aligns marked sites. Two or more sites must be marked 
in order for this function to have an effect. 
Search Functions Molecular Evolutionary Genetics Analysis 
48 
 This activates the Find Motif search box. When this box appears, it 
asks you to enter a motif sequence (a small subsequence of a 
larger sequence) as the search term. After the search term is 
entered, the Alignment Builder finds each occurrence of the search 
term and indicates it with yellow highl ighting. For example, if you 
were to enter the motif "AGA" as the search term, then each 
occurrence of "AGA" across all sequences in the sequence grid 
would be highlighted in yellow. 
 This searches towards the beginning of the current sequence for 
the first occurrence of the motif se arch term. If no motif search has 
been performed prior to clicking this button, the Find Motif search 
box will appear. 
 This searches towards the end of the current sequence for the first 
occurrence of the motif search term. If no moti f search has been 
performed prior to cli cking this button, the Find Motif search box will 
appear. 
 This locates the marked site in t he current sequence. If no site has 
been marked, a warning box will appear. 
Editing Functions 
 This undoes the last Alignment Builder action. 
 This copies the current selection to  the clipboard. It may be used to 
copy a single base, a block of bases, or entire sequences to the 
clipboard. 
 This removes the current selection from the Alignment Builder and 
sends it to the clipboard. This function can affect a single base, a 
block of bases, or entire sequences. 
 This pastes the contents of  the clipboard into the Alignment 
Builder. If the clipboard contains a block of bases, it will be pasted 
into the builder starting  at the point of the cu rrent selection. If the 
clipboard contains complete sequences they will be added to the 
current alignment. For example, if  the contents of a FASTA file 
were copied to the clipboard fr om a web browser, it would be 
pasted into Alignment Builder as a new sequence in the alignment. 
 This deletes a block of selected bases from the alignment grid. 
 This deletes gap-only sites (sit es containing a gap across all 
sequences in the alignment grid) fr om a selected block of bases. 
Sequence Data Insertion Functions 
 This creates a new, empty sequence row in the alignment grid. A 
label and sequence data must be provided for this new row. 
 This activates an Open File dialog box that allows for the selection 
of a sequence data file. Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Builder as 
new sequence rows in the alignment grid. Part II: Assembling Data for Analysis 
49 Site Number display on the status bar 
Site #  The Site # field indicates the site represented by the current 
selection.  If the w/o Gaps  radio button is selected, then the 
Alignment Builder will disregard the shifting affect of gaps when 
determining gap sites. If a block of sites are selected, then this field 
will contain the site # for the firs t site in the block. If an entire 
sequence is selected this field will c ontain the site # for the last site 
in the sequence. 
 
AAlliiggnnmmeenntt  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to commands for editing the sequence data in the 
alignment grid.  The commands are: 
Align by ClustalW : This option is used to ali gn the DNA or protein sequence 
included in the current sele ction on the alignment grid .  You will be prompted for 
the alignment parameters (DNA  or Protein) to be used in  ClustalW; to accept the 
parameters, press "OK". This init iates the ClustalW alignment system. Alignment 
Builder then aligns the current selection in the alignment grid using the accepted 
parameters. 
Mark/Unmark Site : This marks or unmarks a single site in the alignment grid. 
Each sequence in the alignment may only have one site marked at a time. 
Modifications can be made to the alignm ent by marking two or more sites and 
then aligning them using the Align Marked Sites function. 
Align Marked Sites : This aligns marked sites. Two or more sites in the 
alignment must be marked for this function to have an effect. 
Unmark All Sites : This item unmark all currently marked sites across all 
sequences in the alignment grid. Delete Gap-Only Sites : This item deletes gap-only sites (site columns 
containing gaps across all sequences ) from the alignment grid.   
Auto-Fill Gaps : If this item is checked, then the Alignment Builder will ensure 
that all sequences in the alignment grid  are the same length by padding shorter 
sequences with gaps at the end. 
 
DDiissppllaayy  MMeennuu  ((iinn  AAlliiggnnmmeenntt  E
Exxpplloorreerr))  
This menu provides access to commands th at control the display of toolbars in 
the alignment grid.   The commands in this menu are: 
Toolbars : This contains a submenu of the toolbars found in Alignment Explorer . 
If an item is checked, then its toolbar will be visible within the Alignment Explorer 
window. 
Use Colors : If checked, Alignment Explorer  displays each unique base using a 
unique color indicating the base type. Molecular Evolutionary Genetics Analysis 
50 Background Color : If checked, then Alignment Explorer colors the background 
of each base with a unique color t hat represents the base type. 
Font : The Font dialog window can be used to select the font used by Alignment 
Explorer for displaying the sequence data in the alignment grid. 
 
 
EEddiitt  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to commands for editing the sequence data in the 
alignment grid .  The commands in this menu are: 
Undo : This undoes the last Alignment Explorer action. 
Copy : This copies the current selection to the clipboard. It ma y be used to copy a 
single base, a block of bases, or entire sequences. 
Cut: This removes the current selection from the Alignment Explorer and sends it 
to the clipboard. This function can affect a single base, a block of bases, or entire 
sequences. Paste : This pastes the contents of the clipboard into the Alignment Explorer. If 
the clipboard contains a block of bas es, they will be pasted into the builder, 
starting at the point of the current selection. If the c lipboard contains complete 
sequences, they will be added to the current  alignment. For ex ample, if the 
contents of a FASTA file are copied from a web browser to t he clipboard, they 
will be pasted into the Alignment Explorer as a new sequence in the alignment. 
Delete : This deletes a block of select ed bases from the alignment grid. 
Delete Gaps : This deletes gaps from a selected block of bases. 
Insert Blank Sequence : This creates a new, empty sequence row in the 
alignment grid. A label and sequence data must be provided for this new row. 
Insert Sequence From File : This activates an Open File dialog box that allows 
for the selection of a sequence data file . Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Explorer as new sequence 
rows in the alignment grid. 
Select Site(s) : This selects the entire site column  for each site within the current 
selection in the alignment grid. Select Sequences : This selects the entire sequenc e for each site within the 
current selection in the alignment grid. Select all : This selects all of the si tes in the alignment grid. 
Allow Base Editing : If this item is checked, it changes the base values for all 
cells in the alignment grid. If  it is not checked, then all bases in the alignment grid 
are treated as read-only.   
TToooollbbaarrss  iinn  AAlli
iggnnmmeenntt  EExxpplloorreerr  
 
Basic Functions 
 This prepares Alignment Builder  for a new alignment. Any Part II: Assembling Data for Analysis 
51 sequence data currently loaded into Alignment Builder is 
discarded. 
 This activates the Open File dialog window. It is used to send 
sequence data from a properly  formatted file into Alignment 
Builder . 
  This activates the Save Alignment Session dialog window. It may 
be used to save the cu rrent state of the Alignment Builder into a file 
so that it may be restored in the future. 
 This causes nucleotide sequences currently loaded into Alignment 
Builder to be translated into their respective amino acid sequences. 
Web/Data Explorer Functions 
 This displays the NCBI BLAST web site in the Web Explorer tab 
window. If a sequence in the sequence grid is selected prior to 
clicking this button, the Web Expl orer will auto-fill the BLAST query 
window with the selected sequence data. 
 This displays the default database (GenBank) in the Web Explorer 
tab window. 
 This activates the Open Trace File dialog window, which may be 
used to open and view a sequencer file. The sequence data from the sequencer file then can be sent into Alignment Explorer . 
Alignment Functions 
 This displays the ClustalW parameters  dialog window, which is 
used to configure ClustalW and in itiate the alignment of the 
selected sequence data. If you do not  select sequence data prior to 
clicking this button, a message box will appear asking if you would 
like to select all of t he currently loaded sequences. 
 This marks or unmarks the current ly selected single site in the 
alignment grid. Each sequence in the alignment may have only one 
site marked at a time. Modifica tions can be made to the alignment 
by marking two or more sites and then aligning them using the 
Align Marked Sites function. 
 This button aligns marked sites. Two or more sites must be marked 
in order for this function to have an effect. 
Search Functions 
 This activates the Find Motif search box. When this box appears, it 
asks you to enter a motif sequence (a small subsequence of a larger sequence) as the search term. After the search term is 
entered, the Alignment Builder finds each occurrence of the search 
term and indicates it with yellow highl ighting. For example, if you 
were to enter the motif "AGA" as the search term, then each 
occurrence of "AGA" across all sequences in the sequence grid 
would be highlighted in yellow. 
 This searches towards the beginning of the current sequence for Molecular Evolutionary Genetics Analysis 
52 the first occurrence of the motif se arch term. If no motif search has 
been performed prior to clicking this button, the Find Motif search 
box will appear. 
 This searches towards the end of the current sequence for the first 
occurrence of the motif search term. If no moti f search has been 
performed prior to cli cking this button, the Find Motif search box will 
appear. 
 This locates the marked site in t he current sequence. If no site has 
been marked, a warning box will appear. 
Editing Functions 
 This undoes the last Alignment Builder action. 
 This copies the current selection to the clipboard. It may be used to 
copy a single base, a block of bases, or entire sequences to the 
clipboard. 
 This removes the current selection from the Alignment Builder and 
sends it to the clipboard. This function can affect a single base, a 
block of bases, or entire sequences. 
 This pastes the contents of  the clipboard into the Alignment 
Builder. If the clipboard contains a block of bases, it will be pasted 
into the builder starting  at the point of the cu rrent selection. If the 
clipboard contains complete sequences they will be added to the 
current alignment. For example, if  the contents of a FASTA file 
were copied to the clipboard fr om a web browser, it would be 
pasted into Alignment Builder as a new sequence in the alignment. 
 This deletes a block of selected bases from the alignment grid. 
 This deletes gap-only sites (sit es containing a gap across all 
sequences in the alignment grid) fr om a selected block of bases. 
Sequence Data Insertion Functions 
 This creates a new, empty sequence row in the alignment grid. A 
label and sequence data must be provided for this new row. 
 This activates an Open File dialog box that allows for the selection 
of a sequence data file. Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Builder as 
new sequence rows in the alignment grid. 
Site Number display on the status bar 
Site #  The Site # field indicates the site represented by the current 
selection.  If the w/o Gaps  radio button is selected, then the 
Alignment Builder will disregard the shifting affect of gaps when 
determining gap sites. If a block of sites are selected, then this field 
will contain the site # for the firs t site in the block. If an entire 
sequence is selected this field will c ontain the site # for the last site 
in the sequence. Part II: Assembling Data for Analysis 
53  
  
SSeeaarrcchh  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))
  
This menu allows searching for sequence motifs and marked sites.   The 
commands in this menu are: 
Find Motif : This activates the Find Motif search box. When this  box appears, it 
asks you to enter a motif sequence (a sm all subsequence of a larger sequence) 
as the search term. After you enter the search term, the Alignment Explorer  finds 
each occurrence of it and indicates it with yellow highlighting. Fo r example, if you 
enter the motif "AGA" as the search te rm, then each occurrence of "AGA" across 
all sequences in the sequence grid  would be highlighted in yellow. 
Find Next : This searches for the first occu rrence of the motif search term 
towards the end of the current sequence.  If no motif search has been performed 
prior to clicking this button, the Find Motif search box will appear. 
Find Previous : this search towards the beginni ng of the current sequence for the 
first occurrence of the motif search te rm. If no motif search  has been performed 
prior to clicking this button, the Find Motif search box will appear. 
Find Marked Site : This locates the marked site in the current sequence. If no 
site has been marked for this se quence, a warni ng box will appear. 
Highlight Motif : If this item is checked, then a ll occurrences of the text search 
term (motif) are highlighted in the alignment grid. 
 
 
SSeeqquueenncceerr  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
Edit Sequencer File : This item displays the Open File dialog box used to open a 
sequencer data file. Once opene d, the sequencer data file is displayed in the 
Trace Data File Viewer/Editor . This editor allows you to  view and edit trace data 
produced by the automated DNA sequencer.  It reads and edits data in ABI and 
Staden file formats and the sequences disp layed can be added directly into the 
Alignment Explorer or send to the W eb Browser for conducting BLAST searches. 
 
WWeebb  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to comm ands for querying GenBank and doing a 
BLAST search, as well as access to the MEGA web Browser.  The commands in 
this menu are: 
Query Gene Banks : This item starts the W eb Browser and accesses the NCBI 
home page (http://www.ncbi.nlm.nih.gov).  Do BLAST Search : This item starts the W eb Browser and accesses the NCBI 
BLAST query page. If you se lect a sequence in the a lignment grid prior to 
selecting this item, the web browse r will automatically copy the selected 
sequence data into the search field. Show Browser :  This item will show the Web Browser.  
55 5 Part III:  Input Data Types and File Format 
5.1.1 MEGA Format 
For MEGA  to read and interpret your data correctly , it should be formatted according to a 
set of rules.  All input data files are basic ASCII-text files, which may contain DNA 
sequence, protein sequence, evolutionary distance, or phylogenetic tree data.  Most 
word processing packages (e.g., Microsoft Word, WordPerfect, Notepad, and WordPad) 
allow you to edit and save ASCII text files, which are usually marked with a .TXT 
extension.  After creating the file, you should change this extension to .MEG, so that you 
can distinguish between your data files and the other text files.  Because the 
organizational details vary for different types of data, we discuss the data formats for 
molecular sequences, distances, and phylogenetic trees separately.  However, there are 
a number of features that are common to all MEGA  data files. 
 
5.1.2 General Conventions 
CCoommmmoonn  FFeeaattuurreess  
The first line must contain the keyword #MEGA  to indicate that the data file is in MEGA  
format. The data file may contain a succinct description of the data (called Title) included 
in the file on the second line.  The Title statement  is written according to a set of 
rules and is copied from MEGA  to every output file.  In the long run, an informative title 
will allow you to easily recognize your past work. 
The data file may also contain a more descriptive multi-line account of the data in the 
Description  statement, which is written after the Title  statement.  The 
Description statement also is written according to a set of rules.  Unlike the Title 
statement, the Description statement is not copied from MEGA  to every output file. 
In addition, the data file may also contain a Format  statement, which includes 
information on the type of data present in the file and some of its attributes.  The Format statement should be generally written after the Title  or the Description  
statement.  Writing a format statement requires knowledge of the keywords used to 
identify different types of data and data attributes.   
All taxa names must be written according to a set of rules. 
Comments can be written anywhere in the data file and can span multiple lines.  They must always be enclosed in square brackets ([and]) brackets and can be nested.   
WWrriittiinngg  CCoommmmeennttss  
Comments can be placed anywhere in the data f ile as long as they are contained within 
a pair of square brackets [like this].  Nested comments are allowed [[like] this]. 
  
KKeeyy  WWoorrddss  
MEGA  supports a number of keywords, in addition to MEGA and TITLE, for writing 
instructions in the format and command statements. These key words can be written in Molecular Evolutionary Genetics Analysis 
56 any combination of lower- and upper-case letters.  For writing instructions, follow the 
style given in the examples along with the keyword description for different types of data.    
RRuulleess  ffoorr  TTaaxxaa  NNaammeess  
Distance matrices as well as sequence data may come from species, populations, or individuals. These evolutionary entities are designated as OTUs (Operational Taxonomic Units) or taxa. Each taxon must have an identification tag, i.e., a taxon Iabel. In the input files prepared for use in MEGA , these labels should be written according to the following 
conventions: 
‘#’ Sign 
Every Iabel must be written on a new line, and a '#' sign must precede the label.  There 
are no restrictions on the length of the Iabels in the data file, but MEGA  will truncate all 
labels longer than 40 characters. These labels are not required to be unique, although 
identical labels may result in ambiguities and should be avoided.   Characters to use in labels 
Taxa labels must start with alphanumeric characters (0-9, a-z, and A-Z) or a special 
character: dash (-), plus (+) or period (.).  After the first character, taxa labels may 
contain the following additional special characters: underscore (_), asterisk (*), colon (:), 
round open and close brackets ( ), vertical line (|), back slash (\), and forward slash (/).   For multiple word labels, an underscore can be used to represent a blank space. All 
underscores are converted into blank spaces, and subsequent displays of the labels 
show this change. For example, E._coli becomes E. coli.   
RRuulleess  ffoorr  TTiittllee  SSttaatteemmeenntt  
A Title statement must be written on the line following the #mega .  It always begins with 
!Title  and ends with a semicolon.   
#mega 
!Title  This is an example title;  
A title statement may not occupy more t han one line of text. It must not contain a 
semicolon inside the statement, although it  must contain one at the end of the 
statement.  
RRuulleess  ffoorr  DDeessccrriippttiioonn  SSttaatteemmeenntt  
A Description  statement is written after the Title statement. It always begins with 
!Description  and ends with a semicolon.   
#mega 
!Title  This is an example title; 
!Description  This is detailed information the data file; 
A description statement may occupy multiple lines of text. It must not contain a 
semicolon inside the statement, although it must contain one at the end of the statement. 
RRuulleess  ffoorr  tthhee  FFoorrmmaatt  SSttaatteemmeenntt  
A format statement contains one or more command statements.  A command statement 
contains a command and a valid setting keyword (command=keyword format).  For 
example, the command statement DataType=Nucleotide  tells MEGA  that nucleotide Part III:  Input Data Types and File Format 
57 sequence data is contained in the file.  Based on the DataType setting, different types of 
keywords are valid.   
 Keywords for Sequence Data  
 Keywords for Distance Data   Keywords for Tree Data   
5.1.3 Sequence Input Data 
GGeenneerraall  CCoonnssiiddeerraattiioonnss  ((SSeeqquueennccee  DDaattaa))  
The sequence data must consist of two or more sequences of equal length. All 
sequences must be aligned and you may use the in-built alignment system for this purpose. Nucleotide and amino acid sequences should be written in IUPAC single-letter codes.  Sequences can be written in any combination of upper- and lower-case letters.  Special symbols for alignment gaps, missing data, and identical sites also can be 
included in the sequences. 
Special Symbols 
Blank spaces and tabs are frequently used to format data files, so they are simply ignored by MEGA . ASCII characters such as the period ( .), dash ( -), and question mark 
(?), are generally used as special symbols to represent identity to the first sequence, 
alignment gaps, and missing data, respectively.  
IIUUPPAACC  ssiinnggllee  lleetttteerr  ccooddeess  
Nucleotide or amino acid sequences should be written in IUPAC single-letter codes. The 
single-letter codes supported in MEGA  are as follows.  
      
Symbols
 Name  Remarks  
DNA/RNA   
A Adenine Purine G Guanine Purine 
C Cytosine Pyrimidine 
T Thymine Pyrimidine U Uracil Pyrimidine 
R Purine A or G 
Y Pyrimindine C or T/U M  A or C K  G or T S Strong C or G 
W Weak A or T 
H Not G A or C or T B Not A C or G or T 
V Not U/T A or C or G D Not C A or G or T N Ambiguous A or C or G 
or T 
   Molecular Evolutionary Genetics Analysis 
58 Protein   
A Alanine Ala 
C Cysteine Cys D Aspartic Acid Asp 
E Glutamic Acid Glu 
F Phenylalanine Phe 
G Glycine Gly 
H Histidine His I Isoleucine Ile K Lysine Lys 
L Leucine Leu 
M Methionine Met N Asparagine Asn P Proline Pro Q Glutamine Gln 
R Arginine Arg 
S Serine Ser 
T Threonine Thr V Valine Val W Tryptophan Trp Y Tyrosine Tyr 
* Termination * 
 
 
KKeeyywwoorrddss  ffoorr  FFoorrmmaatt  SSttaatteemmeenntt  ((SSeeqquueennccee  ddaattaa))  
 
Command  Setting  Remark  Example  
DataType DNA, RNA, 
nucleotide, 
protein Specifies the type 
of data in the file DataType =DNA 
NSeqs A count Number of 
sequences NSeqs =85 
NTaxa A count Synonymous with 
NSeqs  NTaxa =85 
NSites A count  Number of 
nucleotides or 
amino acids Nsites =4592 Part III:  Input Data Types and File Format 
59 Property Exon, Intron, 
Coding, 
Noncoding, 
and End. 
 Specifies whether a 
domain is protein 
coding.   Exon  and 
Coding  are 
synonymous, as 
are Intron  and 
Noncoding .  End 
specifies that the 
domain with the 
given name ends at 
this point. Property =cyt_b 
Indel single character Use dash (-) to 
identify insertion/deletions 
in sequence alignments  Indel  = - 
Identical single character Use period (.) to 
show identify with 
the first sequence. Identical  = . 
MatchChar single character Synonymous with 
the identical  
keyword. MatchChar  = . 
Missing single 
character Use a question 
mark (?) to indicate 
missing data. Missing  = ? 
CodeTable A name This instruction 
gives the name of the code table for the protein coding domains of the dataCodeTable  = 
Standard 
   
DDeeffiinniinngg  GGeenneess  aanndd  DDoommaaiinnss  
Writing Command Statements for Defining Genes and Domains  
The MEGA  format easily can designate genes and domains within the molecular 
sequence data.  In this format, attributes of different sites (and groups of sites, termed 
domains) are specified within the data "on the spot" rather than in an attributes block before or after the actual data, as is the case in some other data formats.  An example of 
a three-sequence dataset written in MEGA  format is shown below.  The sequences 
consist of three genes named FirstGene, SecondGene, and ThirdGene for two groups of 
organisms Setup/Select Genes/Domain  (Mammals and Birds).  (Note that the genes and 
domains can also be defined interactively through a dialog box.) 
 Molecular Evolutionary Genetics Analysis 
60 !Gene=FirstGene  Domain=Exon1  Property=Coding; 
#Human_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCTCAAT 
#Mouse_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCCCAAT 
#Chicken_{Aves}  ATGGTTTCTAGTCAGCTCACCATGATAGGTCTCAAT 
 
!Gene=SecondGene  Domain=Intron Property=Noncoding; 
#Human     ATTCCCAGGGAATTCCCGGGGGGTTTAAGGCCCCTTTAAAGAAAGAT #Mouse     GTAGCGCGCGTCGTCAGAGCTCCCAAGGGTAGCAGTCACAGAAAGAT 
#Chicken   GTAAAAAAAAAAGTCAGAGCTCCCCCCAATATATATCACAGAAAGAT 
 !Gene=ThirdGene  Domain=Exon2  Property=Coding; #Human      ATCTGCTCTCGAGTACTGATACAAATGACTTCTGCGTACAACTGA 
#Mouse      ATCTGATCTCGTGTGCTGGTACGAATGATTTCTGCGTTCAACTGA 
#Chicken    ATCTGCTCTCGAGTACTGCTACCAATGACTTCTGCGTACAACTGA 
 
 
Keywords for Command Statements (Genes/Domains)  
 
Command  Setting  Remark  Example  
Domain A name This instruction defines a 
domain with the given 
name Domain =first
_exon 
Gene A name This instruction defines a 
gene with the given name Gene =cytb 
Property Exon, Intron, 
Coding, 
Noncoding, 
and End. 
 This instruction specifies 
the protein-coding 
attribute for a domain. 
Keywords Exon  and 
Coding  are synonymous; 
similarly Intron  and 
Noncoding  are 
synonymous.  End 
specifies the domain in 
which the given name has 
ended. Property =
cytb 
CodonStart A number This instruction specifies 
the site where the next 1
st-codon position will be 
found in a protein-coding 
domain. CodonStar
t=2 
 
 
  
DDeeffiinniinngg  GGrroouuppss  Part III:  Input Data Types and File Format 
61 Writing Command Statements fo r Defining Groups of Taxa  
The MEGA  format allows you to assign different taxa to groups in a sequence as well as 
to distance data files.  In this case, the name of the group is written in a set of curly 
brackets following the taxa name.  The group name can be attached to the taxa name using an underscore or just can be appended.  It is important to note that there should 
be no spaces between the taxa name and group name.  (Note that the groups of taxa can also be defined interactively through a dialog box.)  In the following, we show an example in which human and mouse are designated as the members of the group 
Mammal and chicken belongs to group Aves. 
 
!Gene=FirstGene  Domain=Exon1  Property=Coding; 
#Human_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCTCAAT 
#Mouse_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCCCAAT 
#Chicken_{Aves}  ATGGTTTCTAGTCAGCTCACCATGATAGGTCTCAAT  
!Gene=SecondGene  Domain=Intron Property=Noncoding; 
#Human     ATTCCCAGGGAATTCCCGGGGGGTTTAAGGCCCCTTTAAAGAAAGAT #Mouse     GTAGCGCGCGTCGTCAGAGCTCCCAAGGGTAGCAGTCACAGAAAGAT 
#Chicken   GTAAAAAAAAAAGTCAGAGCTCCCCCCAATATATATCACAGAAAGAT 
 
!Gene=ThirdGene  Domain=Exon2  Property=Coding; 
#Human      ATCTGCTCTCGAGTACTGATACAAATGACTTCTGCGTACAACTGA #Mouse      ATCTGATCTCGTGTGCTGGTACGAATGATTTCTGCGTTCAACTGA 
#Chicken    ATCTGCTCTCGAGTACTGCTACCAATGACTTCTGCGTACAACTGA
 
 
Setup/Select Taxa & Groups  
Data | Setup/Select Taxa & Groups 
 
This invokes the Setup/Select Taxa & Groups dialog box for including or excluding taxa, defining groups of taxa, and editing names of taxa and groups. 
 
LLaabbeelllliinngg  IInnddiivviidduuaall  SSiitteess  
Site Label  
The individual sites in nucleotide or am ino acid data can be labeled to construct 
non-contiguous sets of sites.  The Set up Genes and Domains dialog can be used 
to assign or edit site labels, in addition to  specifying them in the input data files. 
This is shown in the following example of  three-sequences in which the sites in 
the Third Gene are labeled with a ‘+’ ma rk.  An underscore marks an absence of 
any labels. 
 
!Gene=FirstGene  Domain=Exon1  Property=Coding; 
#Human_{Mammal}  ATGGTTTCTAG TCAGGTCACCATGATAGGTCTCAAT 
#Mouse_{Mammal}  ATGGTTTCTAG TCAGGTCACCATGATAGGTCCCAAT 
#Chicken_{Aves}  ATGGTTTCTAGTCAGCTCACCATGATAGGTCTCAAT 
 Molecular Evolutionary Genetics Analysis 
62 !Gene=SecondGene  Domain=AnIntron Property=Noncoding; 
#Human     ATTCCCAGGGAATTC CCGGGGGGTTTAAGGCCCCTTTAAAGAAAGAT 
#Mouse     GTAGCGCGCGTCGTCAGAGCTCCCAAGGGTAGCAGTCACAGAAAGAT 
#Chicken   GTAAAAAAAAAAGTCAGAGCTCCCCCCAATATATATCACAGAAAGAT 
 !Gene=ThirdGene  Domain=Exon2  Property=Coding; #Human      ATCTGCTCTCGAGTAC TGATACAAATGACTTCTGCGTACAACTGA 
#Mouse      ATCTGATCTCGTGTGCTGGTACGAATGATTTCTGCGTTCAACTGA #Chicken    ATCTGCTCTCGAGTAC TGCTACCAATGACTTC TGCGTACAACTGA 
!Label      +++__-+++-a-+++-L-+++-k-+++123+++-_-+++---+++; 
 
Each site can be associated with only one label.  A label can be a letter or a number. 
For analyses that require codons, MEGA  includes only those codons in which all 
three positions are given the same label.  This site labeling system facilitates the 
analysis of specific sites, as often is required for comparing sequences of 
regulatory elements, intron-splice sites,  and antigen recognition sites in the 
genes of applications such as the Major Histocompatibility Complex. 
 
Labeled Sites
 
Sites in a sequence alignment can be ca tegorized and labeled with user-defined 
symbols. Each category is represented by a letter or a number. Each site can be 
assigned to only one category, although any  combination of categories can be 
selected for analysis. 
Labeled sites  work independently of and in addition to genes and domains, thus 
allowing complex subsets of  sites to be defined easily. 
 
5.1.4 Distance Input Data 
GGeenneerraall  CCoonnssiiddeerraattiioonnss  ((DDiissttaannccee  DDaattaa  FFoorrmmaattss))  
For a set of m sequences (or taxa), there are m(m-1)/2 pair-wise distances. These 
distances can be arranged either in the lower-l eft or in the upper-right triangular matrix. 
After writing the #mega,!Title,!Description , and !Format  commands (some of 
which are optional), you then need to write all the taxa names (see below).  Taxa names 
are followed by the distance matrix . An example of a matrix is: 
 
#one 
#two 
#three #four 
#five 
 1.0 2.0 3.0 4.0  3.0 2.5 4.6 
  1.3 3.6 
   4.2 Part III:  Input Data Types and File Format 
63  
In the above example, pair-wise distances ar e written in the upper triangular matrix 
(upper-right format).  Two alternate distance matrix formats are:  
 
Lower-left matrix  Upper-right matrix  
d12    d12 d13 d14 d15 
d13 d23    d23 d24 d25 
d14 d24 d34    d34 d35 
d15 d25 d35 d45    d45 
 
KKeeyywwoorrddss  ffoorr  FFoorrmmaatt  SSttaatteemmeenntt  ((SSeeqquueennccee  ddaattaa))  
 
Command  Setting  Remark  Example  
DataType DNA, RNA, 
nucleotide, 
protein Specifies the type of data in the file DataType =DNA 
NSeqs A count Number of sequences NSeqs =85 
NTaxa A count Synonymous with 
NSeqs  NTaxa =85 
NSites A count  Number of 
nucleotides or 
amino acids Nsites =4592 
Property Exon, Intron, 
Coding, 
Noncoding, and End. 
 Specifies whether a 
domain is protein 
coding.   Exon  and 
Coding  are 
synonymous, as 
are Intron  and 
Noncoding .  End 
specifies that the 
domain with the given name ends at 
this point. Property =cyt_b 
Indel single character Use dash (-) to 
identify insertion/deletions 
in sequence 
alignments  Indel  = - 
Identical single 
character Use period (.) to 
show identify with 
the first sequence. Identical  = . Molecular Evolutionary Genetics Analysis 
64 MatchChar single 
character Synonymous with 
the identical  
keyword. MatchChar  = . 
Missing single 
character Use a question 
mark (?) to indicate 
missing data. Missing  = ? 
CodeTable A name This instruction 
gives the name of 
the code table for 
the protein coding 
domains of the dataCodeTable  = Standard 
 
  
DDeeffiinniinngg  GGrroouuppss  
Writing Command Statements fo r Defining Groups of Taxa  
The MEGA  format allows you to assign different taxa to groups in a sequence as well as 
to distance data files.  In this case, the name of the group is written in a set of curly 
brackets following the taxa name.  The group name can be attached to the taxa name using an underscore or just can be appended.  It is important to note that there should be no spaces between the taxa name and group name.  (Note that the groups of taxa 
can also be defined interactively through a dialog box.)  In the following, we show an 
example in which human and mouse are designated as the members of the group 
Mammal and chicken belongs to group Aves.  
!Gene=FirstGene  Domain=Exon1  Property=Coding; 
#Human_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCTCAAT 
#Mouse_{Mammal}  ATGGTTTCTAGTCAGGTCACCATGATAGGTCCCAAT #Chicken_{Aves}  ATGGTTTCTAGTCAGCTCACCATGATAGGTCTCAAT 
 
!Gene=SecondGene  Domain=Intron Property=Noncoding; 
#Human     ATTCCCAGGGAATTCCCGGGGGGTTTAAGGCCCCTTTAAAGAAAGAT 
#Mouse     GTAGCGCGCGTCGTCAGAGCTCCCAAGGGTAGCAGTCACAGAAAGAT 
#Chicken   GTAAAAAAAAAAGTCAGAGCTCCCCCCAATATATATCACAGAAAGAT 
 
!Gene=ThirdGene  Domain=Exon2  Property=Coding; 
#Human      ATCTGCTCTCGAGTACTGATACAAATGACTTCTGCGTACAACTGA 
#Mouse      ATCTGATCTCGTGTGCTGGTACGAATGATTTCTGCGTTCAACTGA #Chicken    ATCTGCTCTCGAGTACTGCTACCAATGACTTCTGCGTACAACTGA 
Setup/Select Taxa & Groups  
Data | Setup/Select Taxa & Groups 
This invokes the Setup/Select Taxa & Groups dialog box for including or 
excluding taxa, defining groups of taxa , and editing names of taxa and groups.  
 Part III:  Input Data Types and File Format 
65 5.1.5 Tree Input Data 
DDiissppllaayy  NNeewwiicckk  TTrreeeess  ffrroomm  FFiillee  
Phylogeny | Display Newick Trees from File… 
Use this to retrieve and display one or more trees written in Newick format.  Multiple 
trees can be displayed, and their consensus built, in the Tree Explorer.  MEGA  supports 
the display of Newick format trees containing branch lengths as well as bootstrap or 
other counts (note that the Newick formats do not contain the total number of bootstrap 
replications conducted).  
5.2 Importing Data from other Formats 
5.2.1 Importing Data from Other Formats 
MEGA  supports conversions from several different file formats into MEGA  formats.  
Each format is indicated by the file extension used.  Supported formats include: 
 
Extension  File type  
. an CLUSTAL 
. nexus PAUP, MacClade 
. phylip PHYLIP Interleaved 
. phylip2 PHYLIP 
Noninterleaved 
. gcg GCG format 
. fasta FASTA format 
. pir PIR format 
. nbrf NBRF format 
. msf MSF format 
. ig IG format 
. xml Internet (NCBI) XML 
format 
 
The following sections briefly describe each of these formats and how MEGA  handles 
their conversion.  
COMMON FILE CONVERSION ATTRIBUTES 
 
The default input formats are determined by a file’s extension (e.g., a file with the 
extension of ".ig" is initially assumed to be in  "IG" input format).   However, you have the 
option to specify any format for any file; the file extension is simply used as an initial 
guide.  Note that the specification of an incorrect file format most often results in an erroneous conversion or other unexpected error. 
 
Input file types can include any of the following characters in their sequence data: 
• The letters: a-z,A-Z for DNA and protein sequences 
• Peroid (.)  Molecular Evolutionary Genetics Analysis 
66 • Hyphen  (-)  
• The space character 
• Question mark (?). 
 
Depending on their context, all other characters encountered in input files are either 
ignored or are interpreted as specific non-sequence data, such as comments, headers, 
etc. 
 
The first line of all converted files is always: #Mega  
The second line of all converted file is always: !Title: <filename>  
where <filename>  is the name of the input file. 
The third line of all converted files is blank. 
 
Many formats can specify the length of the sequences contained within them.  The MEG A conversion utility ignores these data and does not check to see if the sequences 
are as long as they are purported to be.  
 
5.2.2 Convert To MEGA Format (Main File Menu) 
File | Convert to MEGA Format  
This item allows you to choose the file and/or the format that you would like to use to 
convert a given sequence data file into a MEGA  format.  It converts the data file and 
displays the converted data in the editor.   
Files written in a number of popular data formats can be converted into MEGA  format.  
MEGA 4 supports conversion of CLUSTAL, NEXUS (PAUP, MacClade), PHYLIP, GCG, 
FASTA, PIR, NBRF, MSF, IG, and XML formats.  Details about how MEGA reads and converts these file formats are given in t he section Importing Data from Other Formats. 
 
Format Specific Notes  
Converting CLUSTAL Format 
 
Converting CLUSTAL Format  
The sequence alignment outputs from CLUSTAL software often are given the default 
extension . ALN.    CLUSTAL is an interleaved format. In a page-wide arrangement the 
sequence name is in the first column and a part of the sequence’s data is right justified. An example of the CLUSTAL format follows:  
CLUSTAL X (1.8) multiple sequence alignment  
 
Q9Y2J0_Has   ------------
MTDTVFSNSSNRWMYPSDRPLQSNDKEQLQAGWSVHPG Q06846_RP3A_BOVIN  ------------
MTDTVFSSSSSRWMCPSDRPLQSNDKEQLQTGWSVHPS 
JX0338_rabphilin-3A-mouse  ------------MTDTVVN----RWMYPGDGPLQSNDKEQLQAGWSVHPG Part III:  Input Data Types and File Format 
67  
Q9Y2J0_Has   GQPDRQRKQEELTDEEKEIINRVIARAEKMEEMEQER--
IGRLVDRLENM 
Q06846_RP3A_BOVIN  GQPDRQRKQEELTDEEKEIINRVIARAEKMEEMEQER-
-IGRLVDRLENM 
JX0338_rabphilin-3A-mouse AQTDRQRKQEELTDEEKEIINRVIARAEKMEAMEQER-
-IGRLVDRLETM 
 
The CLUSTAL file above would be converted by MEGA  into the following format: 
 
#mega 
Title: Bigrab2.aln 
 
#Q9Y2J0_Hsa 
------------MTDTVFSNSSNRWMYPSDRPLQSNDKEQLQAGWSVHPG 
GQPDRQRKQEELTDEEKEIINRVIARAEKMEEMEQER--IGRLVDRLENM RKNVAGDGVNRCILCGEQLGMLGSACVVCEDCKKNVCTKCGVET-NNRLH 
 
#Q06846_RP3A_BOVIN ------------MTDTVFSSSSSRWMCPSDRPLQSNDKEQLQTGWSVHPS 
GQPDRQRKQEELTDEEKEIINRVIARAEKMEEMEQER--IGRLVDRLENM 
RKNVAGDGVNRCILCGEQLGMLGSACVVCEDCKKNVCTKCGVETSNNRPH  
#JX0338_rabphilin-3A-mouse 
------------MTDTVVN----RWMYPGDGPLQSNDKEQLQAGWSVHPG AQTDRQRKQEELTDEEKEIINRVIARAEKMEAMEQER--IGRLVDRLETM 
RKNVAGDGVNRCILCGEQLGMLGSACVVCEDCKKNVCTKCGVETSNNRPH 
 
 
CCoonnvveerrttiinngg  FFAASSTTAA  ffoorrmmaatt  
The FASTA file format is very simple and is quite similar to the MEGA  file format.  This is 
an example of a sample input file: 
 
>G019uabh 400 bp  
ATACATCATAACACTACTTCCTACCCATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTG 
AATTAAAGACTTGTTTAAACACAAAAATTTAGAGTTTTACTCAACAAAAGTGATTGATTG 
ATTGATTGATTGATTGATGGTTTACAGTAGGACTTCATTCTAGTCATTATAGCTGCTGGC 
AGTATAACTGGCCAGCCTTTAATACATTGCTGCTTAGAGTCAAAGCATGTACTTAGAGTT 
GGTATGATTTATCTTTTTGGTCTTCTATAGCCTCCTTCCCCATCCCCATCAGTCTTAATC AGTCTTGTTACGTTATGACTAATCTTTGGGGATTGTGCAGAATGTTATTTTAGATAAGCA 
AAACGAGCAAAATGGGGAGTTACTTATATTTCTTTAAAGC 
>G028uaah 268 bp  CATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTGAATTAAAGACTTGTTTAAACACAAA 
ATTTAGACTTTTACTCAACAAAAGTGATTGATTGATTGATTGATTGATTGATGGTTTACA 
GTAGGACTTCATTCTAGTCATTATAGCTGCTGGCAGTATAACTGGCCAGCCTTTAATACA 
TTGCTGCTTAGAGTCAAAGCATGTACTTAGAGTTGGTATGATTTATCTTTTTGGTCTTCT 
ATAGCCTCCTTCCCCATCCCATCAGTCT 
 Molecular Evolutionary Genetics Analysis 
68 The MEGA  file converter looks for a line that begin with a greater-than sign (‘ >’), 
replaces it with a pound sign (‘ #’), takes the word following the pound sign as the 
sequence name, deletes the rest of the line, and takes the following lines (up to the next 
line beginning with a ‘>’) as the sequence data.  The MEGA file above would convert as follows: 
 
#mega 
Title: infile.fasta 
 #G019uabh 
ATACATCATAACACTACTTCCTACCCATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTG 
AATTAAAGACTTGTTTAAACACAAAAATTTAGAGTTTTACTCAACAAAAGTGATTGATTG ATTGATTGATTGATTGATGGTTTACAGTAGGACTTCATTCTAGTCATTATAGCTGCTGGC 
AGTATAACTGGCCAGCCTTTAATACATTGCTGCTTAGAGTCAAAGCATGTACTTAGAGTT 
GGTATGATTTATCTTTTTGGTCTTCTATAGCCTCCTTCCCCATCCCCATCAGTCTTAATC AGTCTTGTTACGTTATGACTAATCTTTGGGGATTGTGCAGAATGTTATTTTAGATAAGCA 
AAACGAGCAAAATGGGGAGTTACTTATATTTCTTTAAAGC 
#G028uaah CATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTGAATTAAAGACTTGTTTAAACACAAA ATTTAGACTTTTACTCAACAAAAGTGATTGATTGATTGATTGATTGATTGATGGTTTACA 
GTAGGACTTCATTCTAGTCATTATAGCTGCTGGCAGTATAACTGGCCAGCCTTTAATACA 
TTGCTGCTTAGAGTCAAAGCATGTACTTAGAGTTGGTATGATTTATCTTTTTGGTCTTCT ATAGCCTCCTTCCCCATCCCATCAGTCT 
 
 
CCoonnvveerrtt  GGCCGG  FFoorrmmaatt  
These files consist of one or more groups of non-blank lines separated by one or more 
blank lines; the non-blank lines look similar to this: 
 
Chloroflex 
    Chloroflex  Length: 428  Mon Sep 25 17:34:20 MDT 2000  Check: 0  .. 
   1 MSKEHVQTIA TDDVSKNGHT PPTNASTPPY PFVAIVGQAE LKLALLLCVV 
  51 NPTIGGVMVM GHRGTAKSTA VRALAAMLPP IKAVAGCPYS CAPDRTAGLC  101 DQCRALEQQS GKTKKPAVIN IPVPVVDLPL GATEDRVCGT LDIERALTQG 
 151 VQAFAPGLLA RANRGFLYID EVNLLEDHLV DVLLDVAASG VNVVEREGVS 
 201 VRHPARFVLV GSGNPEEGDL RPQLLDRFGL HARITTITDV SERVEIVKRR  251 REYDADPFAF VEKWAKETQK LQRKIKQAQR RLPEVILPDP VLYKIAELCV 
 301 KLEVDGHRGE LTLARA.ATA LAALEGRNEV TVQDVRRIAV LALRHRLRKD 
 351 PLETQD.... ...DAVRIER AVEEVLVP.. .......... ..........  401 .......... .......... ........ 
 
 The "Check" tag near the end of a line signifies the first line in a new sequence expression.  The name of the sequence is obtained from the preceding line; the following lines, up to the next blank line, are accepted as the sequence.  For each line in the sequence, the leading digits are stripped off, and the rest of the line is used.  The 
following shows a conversion of the above sequence.  
 Part III:  Input Data Types and File Format 
69 #mega 
Title: infile.gcg 
 
#Chloroflex 
MSKEHVQTIA TDDVSKNGHT PPTNASTPPY PFVAIVGQAE LKLALLLCVV 
NPTIGGVMVM GHRGTAKSTA VRALAAMLPP IKAVAGCPYS CAPDRTAGLC 
DQCRALEQQS GKTKKPAVIN IPVPVVDLPL GATEDRVCGT LDIERALTQG VQAFAPGLLA RANRGFLYID EVNLLEDHLV DVLLDVAASG VNVVEREGVS 
VRHPARFVLV GSGNPEEGDL RPQLLDRFGL HARITTITDV SERVEIVKRR 
REYDADPFAF VEKWAKETQK LQRKIKQAQR RLPEVILPDP VLYKIAELCV KLEVDGHRGE LTLARA.ATA LAALEGRNEV TVQDVRRIAV LALRHRLRKD PLETQD.... ...DAVRIER AVEEVLVP.. .......... .......... 
.......... .......... ........ 
 
 
CCoonnvveerrttiinngg  IIGG  FFoorrmmaatt  FFiilleess  
 
These files consist of one or more groups of non-blank lines separated by one or more blank lines. The following is an example of the non-blank lines:   
 ;G028uaah  240 bases   
 G028uaah 
 CATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTGAATTAAAGACTTGTT  TAAACACAAAATTTAGACTTTTACTCAACAAAAGTGATTGATTGATTGAT 
 
The first line in each group begins with a semicolon.  This line is ignored by MEGA .  The 
following line (e.g., G028uaah  above) is treated as the name of the sequence.  
Subsequent lines, until the next semicolon, are taken as the sequence.  MEGA  
recognizes the letters a-z and A-Z for DNA and protein sequences and only a few special characters, such as period [.], hyphen [-], space, and question mark [?].  
Depending on their context, all other characters in the input files are either ignored or are 
interpreted as specific non-sequence data, such as comments, headers, etc. 
 The example converts to MEGA  file format as follows: 
 
 #mega 
 !Title: filename 
 #G019uabh  ATACATCATAACACTACTTCCTACCCATAAGCTCCTTTTAACTTGTTAAA 
 GTCTTGCTTGAATTAAAGACTTGTTTAAACACAAAAATTTAGAGTTTTAC 
 
 
CCoonnvveerrttiinngg  MMSSFF  FFoorrmmaatt  
The MSF format is an interleaved format that is designed to simplify the comparison of 
sequences with similar lengths. 
 
G006uaah  MSF: 240  Type: N  Wed Sep 20 12:57:06 MDT 2000  
Check: 0 .. Molecular Evolutionary Genetics Analysis 
70  
 Name: G019uabh         Len:   400  Check:    0  Weight:  1.00 
 Name: G028uaah         Len:   268  Check:    0  Weight:  
1.00 
 Name: G022uabh         Len:   257  Check:    0  Weight:  1.00 
 Name: G023uabh         Len:   347  Check:    0  Weight:  
1.00  Name: G006uaah         Len:   240  Check:    0  Weight:  
1.00 
//  
       G019uabh ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA 
ACTTGTTAAA        G028uaah CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA 
AAGACTTGTT 
       G022uabh TATTTTAGAG ACCCAAGTTT TTGACCTTTT CCATGTTTAC ATCAATCCTG 
       G023uabh AATAAATACC AAAAAAATAG TATATCTACA TAGAATTTCA 
CATAAAATAA        G006uaah ACATAAAATA AACTGTTTTC TATGTGAAAA TTAACCTANN 
ATATGCTTTG 
       G019uabh GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT AGAGTTTTAC        G028uaah TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG 
ATTGATTGAT 
       G022uabh TAGGTGATTG GGCAGCCATT TAAGTATTAT TATAGACATT TTCACTATCC 
       G023uabh ACTGTTTTCT ATGTGAAAAT TAACCTAAAA ATATGCTTTG 
CTTATGTTTA        G006uaah CTTATGTTTA AGATGTCATG CTTTTTATCA GTTGAGGAGT 
TCAGCTTAAT 
       G019uabh TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG TTTACAGTAG 
       G028uaah TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA 
TTATAGCTGC        G022uabh CATTAAAACC CTTTATGCCC ATACATCATA ACACTACTTC 
CTACCCATAA 
       G023uabh AGATGTCATG CTTTTTATCA GTTGAGGAGT TCAGCTTAAT AATCCTCTAC 
       G006uaah AATCCTCTAA GATCTTAAAC AAATAGGAAA AAAACTAAAA 
GTAGAAAATG        G019uabh GACTTCATTC TAGTCATTAT AGCTGCTGGC AGTATAACTG 
GCCAGCCTTT 
       G028uaah TGGCAGTATA ACTGGCCAGC CTTTAATACA TTGCTGCTTA GAGTCAAAGC        G022uabh GCTCCTTTTA ACTTGTTAAA GTCTTGCTTG AATTAAAGAC 
TTGTTTAAAC 
       G023uabh GATCTTAAAC AAATAGGAAA AAAACTAAAA GTAGAAAATG GAAATAAAAT 
       G006uaah GAAATAAAAT GTCAAAGCAT TTCTACCACT CAGAATTGAT Part III:  Input Data Types and File Format 
71 CTTATAACAT 
       G019uabh AATACATTGC TGCTTAGAGT CAAAGCATGT ACTTAGAGTT 
GGTATGATTT 
       G028uaah ATGTACTTAG AGTTGGTATG ATTTATCTTT TTGGTCTTCT 
ATAGCCTCCT 
       G022uabh ACAAAATTTA GACTTTTACT CAACAAAAGT GATTGATTGA 
TTGATTGATT        G023uabh GTCAAAGCAT TTCTACCACT CAGAATTGAT CTTATAACAT 
GAAATGCTTT 
       G006uaah GAAATGCTTT TTAAAAGAAA ATATTAAAGT TAAACTCCCC        G019uabh ATCTTTTTGG TCTTCTATAG CCTCCTTCCC CATCCCCATC AGTCTTAATC 
       G028uaah TCCCCATCCC ATCAGTCT 
       G022uabh GATTGAT        G023uabh TTAAAAGAAA ATATTAAAGT TAAACTCCCC TATTTTGCTC 
GTTTTTGCTT 
       G019uabh AGTCTTGTTA CGTTATGACT AATCTTTGGG GATTGTGCAG AATGTTATTT 
       G023uabh ATCTAAAATA CATTCTGCAC AATCCCCAAA GATTGATCAT 
ACGTTAC        G019uabh TAGATAAGCA AAACGAGCAA AATGGGGAGT TACTTATATT 
TCTTTAAAGC 
 
The MEGA  format converter "unravels" the in terleaved data by extracting each line 
beginning with the first name, then those beginning with the second name, and so on, 
ultimately producing a corresponding file that looks like this: 
 
#mega 
Title: thisfile.msf 
 
#G019uabh ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA ACTTGTTAAA 
GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT AGAGTTTTAC 
TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG TTTACAGTAG GACTTCATTC TAGTCATTAT AGCTGCTGGC AGTATAACTG GCCAGCCTTT AATACATTGC TGCTTAGAGT CAAAGCATGT ACTTAGAGTT GGTATGATTT 
ATCTTTTTGG TCTTCTATAG CCTCCTTCCC CATCCCCATC AGTCTTAATC 
AGTCTTGTTA CGTTATGACT AATCTTTGGG GATTGTGCAG AATGTTATTT TAGATAAGCA AAACGAGCAA AATGGGGAGT TACTTATATT TCTTTAAAGC 
 
#G028uaah CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA AAGACTTGTT 
TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG ATTGATTGAT 
TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA TTATAGCTGC TGGCAGTATA ACTGGCCAGC CTTTAATACA TTGCTGCTTA GAGTCAAAGC 
ATGTACTTAG AGTTGGTATG ATTTATCTTT TTGGTCTTCT ATAGCCTCCT 
TCCCCATCCC ATCAGTCT  
#G022uabh 
TATTTTAGAG ACCCAAGTTT TTGACCTTTT CCATGTTTAC ATCAATCCTG TAGGTGATTG GGCAGCCATT TAAGTATTAT TATAGACATT TTCACTATCC Molecular Evolutionary Genetics Analysis 
72 CATTAAAACC CTTTATGCCC ATACATCATA ACACTACTTC CTACCCATAA 
GCTCCTTTTA ACTTGTTAAA GTCTTGCTTG AATTAAAGAC TTGTTTAAAC 
ACAAAATTTA GACTTTTACT CAACAAAAGT GATTGATTGA TTGATTGATT 
GATTGAT 
 
#G023uabh 
AATAAATACC AAAAAAATAG TATATCTACA TAGAATTTCA CATAAAATAA ACTGTTTTCT ATGTGAAAAT TAACCTAAAA ATATGCTTTG CTTATGTTTA 
AGATGTCATG CTTTTTATCA GTTGAGGAGT TCAGCTTAAT AATCCTCTAC 
GATCTTAAAC AAATAGGAAA AAAACTAAAA GTAGAAAATG GAAATAAAAT GTCAAAGCAT TTCTACCACT CAGAATTGAT CTTATAACAT GAAATGCTTT TTAAAAGAAA ATATTAAAGT TAAACTCCCC TATTTTGCTC GTTTTTGCTT 
ATCTAAAATA CATTCTGCAC AATCCCCAAA GATTGATCAT ACGTTAC 
 #G006uaah 
ACATAAAATA AACTGTTTTC TATGTGAAAA TTAACCTANN ATATGCTTTG 
CTTATGTTTA AGATGTCATG CTTTTTATCA GTTGAGGAGT TCAGCTTAAT AATCCTCTAA GATCTTAAAC AAATAGGAAA AAAACTAAAA GTAGAAAATG 
GAAATAAAAT GTCAAAGCAT TTCTACCACT CAGAATTGAT CTTATAACAT 
GAAATGCTTT TTAAAAGAAA ATATTAAAGT TAAACTCCCC 
 
 
CCoonnvveerrttiinngg  NNBBRRFF  FFoorrmmaatt  
 
NBRF files consist of one or more groups of non-blank lines separated by one or more blank lines; the non-blank lines look similar to this:  
 >P1;Chloroflex 
 Chloroflex  428 bases 
  MSKEHVQTIA TDDVSKNGHT PPTNASTPPY PFVAIVGQAE LKLALLLCVV   NPTIGGVMVM GHRGTAKSTA VRALAAMLPP IKAVAGCPYS CAPDRTAGLC 
  DQCRALEQQS GKTKKPAVIN IPVPVVDLPL GATEDRVCGT LDIERALTQG 
  VQAFAPGLLA RANRGFLYID EVNLLEDHLV DVLLDVAASG VNVVEREGVS   VRHPARFVLV GSGNPEEGDL RPQLLDRFGL HARITTITDV SERVEIVKRR 
  REYDADPFAF VEKWAKETQK LQRKIKQAQR RLPEVILPDP VLYKIAELCV 
  KLEVDGHRGE LTLARA-ATA LAALEGRNEV TVQDVRRIAV LALRHRLRKD   PLETQD---- ---DAVRIER AVEEVLVP-- ---------- ---------- 
  ---------- ---------- --------* 
 
Each group begins with a line starting with a greater-than symbol (‘ >’).  This line is 
ignored.  The first word in the following line (e.g., Chloroflex  above) is treated as the 
name of the sequence; the rest of that line is ignored Subsequent lines are taken as the 
sequence.  This example would be converted to the MEGA  file format as follows: 
 
  #mega 
  !Title: filename 
 
  #Chloroflex 
  MSKEHVQTIA TDDVSKNGHT PPTNASTPPY PFVAIVGQAE LKLALLLCVV   NPTIGGVMVM GHRGTAKSTA VRALAAMLPP IKAVAGCPYS CAPDRTAGLC Part III:  Input Data Types and File Format 
73   DQCRALEQQS GKTKKPAVIN IPVPVVDLPL GATEDRVCGT LDIERALTQG 
  VQAFAPGLLA RANRGFLYID EVNLLEDHLV DVLLDVAASG VNVVEREGVS 
  VRHPARFVLV GSGNPEEGDL RPQLLDRFGL HARITTITDV SERVEIVKRR 
  REYDADPFAF VEKWAKETQK LQRKIKQAQR RLPEVILPDP VLYKIAELCV 
  KLEVDGHRGE LTLARA-ATA LAALEGRNEV TVQDVRRIAV LALRHRLRKD 
  PLETQD---- ---DAVRIER AVEEVLVP-- ---------- ---------- 
  ---------- -- -------- -------- 
 
CCoonnvveerrttiinngg  NNeexxuuss  FFoorrmmaatt  
The NEXUS file format has a header with lines identifying the name of each of the 
sequences in the file, followed by lines that begin with the sequence name and some 
data.  An example of part of an input file is: 
 
#NEXUS 
BEGIN DATA;  DIMENSIONS NTAX=17 NCHAR=428; 
 FORMAT DATATYPE=PROTEIN INTERLEAVE MISSING=-; 
[Name: Chloroflex       Len:   428  Check:    0] [Name: Rcapsulatu       Len:   428  Check:    0] 
MATRIX 
          Chloroflex MSKEHVQTIATDDVSKNGHT PPTNASTPPYPFVAIVGQAE           Rcapsulatu ---------MTTAVARLQPS ASGAKTRPVFPFSAIVGQED 
 
          Chloroflex DQCRALEQQSGKTKKPAVIN IPVPVVDLPLGATEDRVCGT           Rcapsulatu DWATVLS-----TN---VIR KPTPVVDLPLGVSEDRVVGA 
 
The MEGA  conversion function looks for all the lines starting with the " [Name: " flag and 
takes the following word as a sequence name.  The conversion function then scans 
through the data looking for all lines starting with each of the identified names and places them on the output.  This appears as follows:  
#mega 
Title: infile.nexus 
#Chloroflex MSKEHVQTIATDDVSKNGHT PPTNASTPPYPFVAIVGQAE 
DQCRALEQQSGKTKKPAVIN IPVPVVDLPLGATEDRVCGT 
 
#Rcapsulatu 
---------MTTAVARLQPS ASGAKTRPVFPFSAIVGQED 
DWATVLS-----TN---VIR KPTPVVDLPLGVSEDRVVGA  
 
CCoonnvveerrttiinngg  PPHHYYLLIIPP  ((iinntteerrlleeaavveedd))  FFoorrmmaatt  
The PHYLIP format is interleaved, similar to the MSF format.  It consists of a line of 
numeric data, which is ignored by MEGA , followed by a group of one or more lines of 
text.  The text begins with a sequence name in the first column and is followed by the 
initial part of each sequence; the group is terminated by a blank line.  The number of 
lines in subsequent groups of data is similar to the first group.  Each line is a Molecular Evolutionary Genetics Analysis 
74 continuation of the identified sequence and begins in the same position as in the first 
group.  The following might be observed at the beginning of a PHYLIP data file:  
2 2000 I 
G019uabh     ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA ACTTGTTAAA 
G028uaah     CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA 
AAGACTTGTT               GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT 
AGAGTTTTAC 
             TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG ATTGATTGAT 
 
             TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG 
TTTACAGTAG 
             TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA 
TTATAGCTGC 
 
MEGA  would convert this data as follows: 
 
#mega 
Title: cap-data.phylip  
#G019uabh 
ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA ACTTGTTAAA GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT AGAGTTTTAC 
TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG TTTACAGTAG 
#G028uaah 
CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA AAGACTTGTT 
TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG ATTGATTGAT 
TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA TTATAGCTGC 
 
 
CCoonnvveerrttiinngg  PPHHYYLLIIPP  ((NNoonn--iinntteerrlleeaavveedd))  FFoorrmmaatt  
Converting PHYLIP non-interleaved format 
While otherwise similar to the PHYLIP interl eaved format, this format is not interleaved. 
For example: 
 
0 0 I 
G019uabh     ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA 
ACTTGTTAAA              GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT 
AGAGTTTTAC 
             TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG TTTACAGTAG 
             GACTTCATTC TAGTCATTAT AGCTGCTGGC AGTATAACTG 
GCCAGCCTTT              AATACATTGC TGCTTAGAGT CAAAGCATGT ACTTAGAGTT Part III:  Input Data Types and File Format 
75  
G028uaah     CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA 
AAGACTTGTT 
             TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG 
ATTGATTGAT 
             TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA 
TTATAGCTGC              TGGCAGTATA ACTGGCCAGC CTTTAATACA TTGCTGCTTA 
GAGTCAAAGC 
             ATGTACTTAG AGTTGGTATG ATTTATCTTT TTGGTCTTCT 
 
This file would be converted to MEGA  format as follows: 
 
#mega 
Title: infile.phylip2  
#G019uabh 
ATACATCATA ACACTACTTC CTACCCATAA GCTCCTTTTA ACTTGTTAAA GTCTTGCTTG AATTAAAGAC TTGTTTAAAC ACAAAAATTT AGAGTTTTAC 
TCAACAAAAG TGATTGATTG ATTGATTGAT TGATTGATGG TTTACAGTAG 
GACTTCATTC TAGTCATTAT AGCTGCTGGC AGTATAACTG GCCAGCCTTT AATACATTGC TGCTTAGAGT CAAAGCATGT ACTTAGAGTT 
 
#G028uaah CATAAGCTCC TTTTAACTTG TTAAAGTCTT GCTTGAATTA AAGACTTGTT 
TAAACACAAA ATTTAGACTT TTACTCAACA AAAGTGATTG ATTGATTGAT 
TGATTGATTG ATGGTTTACA GTAGGACTTC ATTCTAGTCA TTATAGCTGC TGGCAGTATA ACTGGCCAGC CTTTAATACA TTGCTGCTTA GAGTCAAAGC ATGTACTTAG AGTTGGTATG ATTTATCTTT TTGGTCTTCT 
 
CCoonnvveerrttiinngg  PPIIRR  FFoorrmmaatt  
These files consist of groups of non-blank lines that look similar to this: 
 
ENTRY           G006uaah  
TITLE           G019uabh 400 bp 240 bases   SEQUENCE         
                5        10        15        20        25        
30 
      1 A C A T A A A A T A A A C T G T T T T C T A T G T G A A A A 
     31 T T A A C C T A N N A T A T G C T T T G C T T A T G T T T 
A      61 A G A T G T C A T G C T T T T T A T C A G T T G A G G A G 
T 
     91 T C A G C T T A A T A A T C C T C T A A G A T C T T A A A C 
    121 A A A T A G G A A A A A A A C T A A A A G T A G A A A A T 
G     151 G A A A T A A A A T G T C A A A G C A T T T C T A C C A C 
T Molecular Evolutionary Genetics Analysis 
76     181 C A G A A T T G A T C T T A T A A C A T G A A A T G C T T 
T 
    211 T T A A A A G A A A A T A T T A A A G T T A A A C T C C C 
C 
 
The MEGA  format converter looks for the "ENTRY" tag and treats the following string  as 
the sequence name, e.g., G006uaah above.  The remaining lines have their digits and 
spaces removed; any non-sequence characters also are deleted.  MEGA  would convert 
the above sequence as follows: 
 
#mega 
Title: filename.pir  
#G006uaah 
ACATAAAATAAACTGTTTTCTATGTGAAAA TTAACCTANNATATGCTTTGCTTATGTTTA 
AGATGTCATGCTTTTTATCAGTTGAGGAGT 
TCAGCTTAATAATCCTCTAAGATCTTAAAC AAATAGGAAAAAAACTAAAAGTAGAAAATG 
GAAATAAAATGTCAAAGCATTTCTACCACT 
CAGAATTGATCTTATAACATGAAATGCTTT TTAAAAGAAAATATTAAAGTTAAACTCCCC 
 
 
CCoonnvveerrttiinngg  XXMMLL  ffoorrmmaatt  
These files consist of a group of XML tags and attribute values.  A DOCTYPE header 
may or may not be present. The MEGA  input converter for XML file formats does not 
implement a full parser; it only looks for a few specific tags that might be present.  For 
example, an XML file might contain the following data: 
 
<Bioseq-set> 
  <Bioseq> 
    <name>G019uabh</name> 
    <length>240</length>     <mol>DNA</mol> 
    <cksum>302C447C</cksum> 
    <seq-data>ATACATCATAACACTACTTCCTACCCATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTG
AATT 
AAAGACTTGTTTAAACACAAAAATTTAGAGTTTTACTCAACAAAAGTGATTGATTGATTGATTGA
TTGATTGATGGTT TACAGTAGGACTTCATTCTAGTCATTATAGCTGCTGGCAGTATAACTGGCCAGCCTTTAATACAT
TGCTGCTTAGAGT 
CAAAGCATGTACTTAGAGTT</seq-data>   </Bioseq> 
</Bioseq-set> 
 
The MEGA format converter looks for the following two tags: 
 Part III:  Input Data Types and File Format 
77 <name>G019uabh</name> 
<seq-data>ATACATCATAACACTAC. . .</seq-data> 
 
If it finds these tags, it uses the text between the <name>. . .</name>  tags as the 
sequence name, and the text between the <seq-data>. . .</seq-data>  tags as 
the sequence data corresponding to that name. The conversion of the above XML block 
into MEGA  format would look like this: 
 
#Mega 
Title: filename.xml 
 
#G019uabh ATACATCATAACACTACTTCCTACCCATAAGCTCCTTTTAACTTGTTAAAGTCTTGCTTGAATT 
AAAGACTTGTTTAAACACAAAAATTTAGAGTTTTACTCAACAAAAGTGATTGATTGATTGATTGA
TTGATTGATGGTT TACAGTAGGACTTCATTCTAGTCATTATAGCTGCTGGCAGTATAACTGGCCAGCCTTTAATACAT
TGCTGCTTAGAGT 
 
5.3 Genetic Code Tables 
5.3.1 Built-in Genetic Codes 
MEGA  contains four commonly used genetic code tables: (1) Standard, (2) Vertebrate 
mitochondrial, (3) Drosophila mitochondrial, and (4) Yeast mitochondrial.  They can be 
used as templates to create additional genetic code tables using the Genetic Code Selector.  Genetic codes for these four built-in tables in one letter code are given below. 
 
                                         Code Table
                         Code Table  
Codon  1  2  3  4  Codon  1  2  3  4  
UUU F F F F AUU I I I I UUC F F F F AUC I I I I 
UUA L L L L AUA I M M I 
UUG L L L L AUG M M M M 
UCU S S S S ACU T T T T UCC S S S S ACC T T T T 
UCA S S S S ACA T T T T 
UCG S S S S ACG T T T T 
UAU Y Y Y Y AAU N N N N UAC Y Y Y Y AAC N N N N 
UAA * * * * AAA K K K K 
UAG * * * * AAG K K K K 
UGU C C C C AGU S S S S UGC C C C C AGC S S S S 
UGA * W W W AGA R * S R 
UGG W W W W AGG R * S R 
CUU L L L T GUU V V V V 
CUC L L L T GUC V V V V Molecular Evolutionary Genetics Analysis 
78 CUA L L L T GUA V V V V 
CUG L L L T GUG V V V V 
CCU P P P P GCU A A A A 
CCC P P P P GCC A A A A 
CCA P P P P GCA A A A A 
CCG P P P P GCG A A A A 
CAU H H H H GAU D D D D CAC H H H H GAC D D D D 
CAA Q Q Q Q GAA E E E E 
CAG Q Q Q Q GAG E E E E 
CGU R R R R GGU G G G G CGC R R R R GGC G G G G 
CGA R R R R GGA G G G G 
CGG R R R R GGG G G G G 
 
 
5.3.2 Adding/Modifying Genetic Code Tables 
You may add new genetic code tables and/or edit existing code tables in the Genetic 
Code Selector.  All changes made will be remembered by MEGA  for all future analyses. 
 
5.3.3 Computing Statistical Attributes (Genetic Code) 
There is a significant amount of redundancy in the genetic code because most amino 
acids are encoded by multiple codons.  Therefore, it is interesting to know the degeneracy of each codon position in all codons.  In MEGA  this information can be 
computed for any code table in the Genetic Code Selector. In addition to the degeneracy 
of the codon positions, MEGA  writes the number of synonymous sites and the number of 
non-synonymous sites for each codon using the Nei and Gojobori (1986) method.  An example of the results obtained for the standard genetic code is given below:  
Code Table: Standard 
Method:     Nei-Gojobori (1986) 
methodology 
S = No. of synonymous  
sites   
N = No. of non-synonymous 
sites  
Codon
 No. of Sites 
for codon  Redundancy  
 S  N  Pos
1stPos
2ndPos
3rd 
UUU (F) 0.333 2.667 0 0 2 
UUC (F) 0.333 2.667 0 0 2 UUA (L) 0.667 2.333 2 0 2 
UUG (L) 0.667 2.333 2 0 2 
UCU (S) 1 2 0 0 4 UCC (S) 1 2 0 0 4 Part III:  Input Data Types and File Format 
79 UCA (S) 1 2 0 0 4 
UCG (S) 1 2 0 0 4 UAU (Y) 1 2 0 0 2 UAC (Y) 1 2 0 0 2 UAA (*) 0 3 0 0 0 UAG (*) 0 3 0 0 0 UGU (C) 0.5 2.5 0 0 2 UGC (C) 0.5 2.5 0 0 2 UGA (*) 0 3 0 0 0 
UGG 
(W) 0 3 0 0 0 
CUU (L) 1 2 0 0 4 
CUC (L) 1 2 0 0 4 CUA (L) 1.333 1.667 2 0 4 
 
 
5.3.4 Setup/Select Taxa & Groups Dialog 
 
This dialog box has two sub-windows ( Taxa/Groups  and Ungrouped Taxa ), a panel bar 
between them containing a few buttons, and a command panel, with the lower part 
containing the Add, Delete , Close , and Help buttons. 
 
Taxa/Groups sub-window on the left:  It shows all the currently defined taxa and group 
names hierarchically.  If a taxon has been assigned to a group, it will appear connected 
to that group.  Groups may be displayed in a collapsed format (indicated by a + mark before their name). You can click '+' to expand the group to a listing of the taxa contained in it, and click ‘–‘ to collapse the group to only view the group name. Groups that do not contain any members do not have this box. Next is a checkbox indicating 
whether a given group or taxon will be included in an analysis. Following that is an icon indicating a taxon (single box) or a group (lay er of boxes).  Grayed out check boxes are 
used to indicate that some of the taxa in a group are selected and others are unselected.  
You can rearrange the order of taxa and groups using drag-and-drop. However, note that this order is not automatically used in the Data Explorer . To enforce this order, use 
the Sort command in the Data Explorer . 
 Ungrouped Taxa Sub-window  on the right:  This shows the names of all the taxa that do 
not belong to any of the groups to facilitate your ability to move taxa into groups.  If this sub-window does not appear on your screen, then hold and drag the lower right corner of the dialog box to expand its width to unhide it. 
 
Middle Command Panel:  This resides between the above-mentioned two sub-windows 
and contains a splitter on its right edge.  You can grab the splitter and move it to change the proportion of the space taken by the two sub-windows.  In this panel left and right arrow buttons are used to add or remove taxa from the groups.  Clicking the hand-with-
a-pencil icon with a highlighted taxon or group name will allow you to edit that name. 
 Lower Command Panel :  In the lower part of the Select/Edit Taxa/Groups  window are 
buttons that are used to add and/or delete groups.  The ‘+’ and ‘–‘ buttons are also Molecular Evolutionary Genetics Analysis 
80 present on the middle command panel. 
 
Buttons  Description  
Add Creates a new group. 
Delete Deletes the currently selected group. Any taxa that were assigned to the group will become freestanding. 
Ungroup Makes all the taxa in the selected group freestanding, but does not remove the group from the list. 
Close Closes the dialog box. 
Help Brings up help regarding the dialog box. 
 
How to perform functions:
 
 
Function  Description  
Creating a new 
group Click on the Add button. Click on the highlighted name of the 
group and type in a new name. 
Deleting a group Select the group and click the Delete  button.  Any taxa that 
were assigned to this group will become freestanding. 
Adding taxa to a 
group Drag-and-drop the taxon on the desired group or select one or 
more taxa in the Ungrouped Taxa  window and click on the left 
arrow button on the middle command panel.  
Removing a taxon 
from a group Click on the taxon and drag-and-drop it into a group (or outside 
all groups).  Or, select the taxon and click on the right arrow 
button on the middle command panel. 
Include/Exclude taxa or groups Click the checkbox next to the group or taxa name. 
 
5.3.5 Select Genetic Code Table Dialog 
This dialog selects the desired genetic code, and edits and displays the properties of the 
genetic codes.  At present only one genetic code can be selected in MEGA  at any given 
time; it is used for all coding regions in all sequences in the data set. 
 
To select a genetic code, click in the square box to its left. 
You can also highlight any genetic code by clicking on the text. 
You can then use the following buttons found along the top of the dialog box:  
Button
 Description  
Add Creates a new genetic code table.  A code table editor will be shown with 
the genetic code of the currently highlighted code table loaded. 
Delete Removes the highlighted genetic code from the list.  Note that the standard genetic code cannot be deleted. 
Edit Modifies the highlighted genetic code or its name.  The code table editor 
will be invoked for editing the genetic code. Part III:  Input Data Types and File Format 
81 View Displays the highlighted genetic code in a printable format. 
Statistics Displays the number of synonymous  and non-synonymous sites for the 
codons of the highlighted genetic code following the Nei-Gojobori (1986) 
method.  The degeneracy values for the first, second, and third codon 
positions are displayed following Li et al. (1985). 
 
5.4 Viewing and Exploring Input Data 
5.4.1 Sequence Data Explorer 
The Sequence Data Explorer  shows the aligned sequence  data.  You can scroll 
along the alignment using the scrollbar at the bo ttom right hand side of the 
explorer window.  The Sequence Data Explorer  provides a number of useful 
functionalities for exploring the statisti cal attributes of the data and also for 
selecting data subsets. 
 
This explorer consists of a number of regions as follows: 
Menu Bar  
Data menu 
Display menu 
Highlight menu 
Statistics menu  Help: This item brings up the help file for the Sequence Data Explorer . 
Tool Bar
 
The tool bar provides quick acce ss to the following menu items: 
• General Utilities 
• 
 : This brings up the Exporting Se quence Data dialog box, which 
contains options to control how MEGA  writes the output data. 
• Color: This brings up a color palette selection box with which you can 
choose the color to be displaye d in the highlighted sites.   
• 
: This brings up the dialog box for setting up and selecting domains 
and genes. 
• 
: This brings up the dialog box fo r setting up, editing, and selecting 
taxa and groups of taxa. 
• 
 : This toggle replaces the nucleoti de (amino acid) at a site with the 
identical symbol (e.g. a dot) if the site contains the same nucleotide 
(amino acid). 
• Highlighting Sites 
• C: If this button is pressed, then all constant sites will be highlighted.  
A count of the highlighted sites wi ll be displayed on the status bar. 
• V: If this button is pressed, then a ll variable sites will be highlighted.  Molecular Evolutionary Genetics Analysis 
82 A count of the highlighted sites wi ll be displayed on the status bar. 
• Pi: If this button is pressed, then all parsimony-informative sites will 
be highlighted.  A count of the hi ghlighted sites will be displayed on 
the status bar. 
• S: If this button is pressed, then all singleton sites will be highlighted.  
A count of the highlighted sites wi ll be displayed on the status bar. 
• 0: If this button is pressed, then sites will be highlighted only if they 
are zero-fold degenerate sites in all sequences displayed.  A count of 
highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 2: If this button is pressed, then sites will be highlighted only if they 
are two-fold degenerate sites in all sequences displayed.  A count of highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 4: If this button is pressed, then sites will be highlighted only if they 
are four-fold degenerate sites in all s equences displayed.  A count of 
highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 
 : This button provides the facility to translate 
codons in the sequence data into amino acid sequences and back.  All 
protein-coding regions will be automatic ally identified and translated for 
display.  When the translated seq uence is already displayed, then 
issuing this command displays t he original nucleotide sequences 
(including all coding and non-coding regions).  Depending on the data 
displayed (translated or nucleotid e), relevant menu options in the 
Sequence Data Explorer become enabled.  Note that the translated/un-
translated status in this data expl orer does not have any impact on the 
options for analysis available in MEGA  (e.g., Distances  or Phylogeny  
menus), as MEGA  provides all possible options  for your dataset at all 
times.  
The 2-Dimensional Data Grid  
Fixed Row :  This is the first row in the dat a grid.  It is used to display the 
nucleotides (or amino acids) in t he first sequence when you have chosen 
to show their identity using a spec ial character.  For protein coding 
regions, it also clearly marks the first, second, and the third codon 
positions.  
Fixed Column :  This is the first and the leftm ost column in the data grid.  It 
is always visible, even when you are scrolling through sites.  The column 
contains the sequence names and an associated check box.  You can check or uncheck this box to include or  exclude a sequence from analysis.  
Also in this column, you can dr ag-and-drop sequences to sort them. 
Rest of the Grid :  Cells to the right of and bel ow the first row contain the 
nucleotides or amino acids of the input data.  Note that all cells are drawn Part III:  Input Data Types and File Format 
83 in light color if they  contain data corresponding to unselected sequences 
or genes or domains. 
Status Bar  
This section displays the location of the focused site and the total 
sequence length.  It also shows the site  label, if any, and a count of the 
highlighted sites. 
 
DDaattaa  MMeennuu  
This allows you to explore the active data set, and establish various data attributes, and 
data subset options. 
 
Data Menu (in Sequence Data Explorer)  
This menu provides commands for wo rking with selected data in the Sequence 
Data Explorer  
The commands in this menu are: 
Write Data to File  Brings up the Exporting Sequence Data  dialog 
box. 
Translate/Untranslate  Translates protein-codi ng nucleotide sequences 
into protein sequences, and back to nucleotide 
sequences. 
Select Genetic Code 
Table  Brings up the Select Genetic Code  dialog box, in 
which you can select, edit or add a genetic code 
table. 
Setup/Select Genes and 
Domains  Brings up the Sequence Data Organizer , in which 
you can define and edit genes and domains.  
Setup/Select Taxa and Groups  Brings up the Select/Edit Taxa and Groups dialog, in which you can edit taxa and define 
groups of taxa.  
Quit Data Viewer  Takes the user back to the main interface. 
 
Translate/Un-translate (in Sequence Data Explorer)
 
Data | Translate/Un-translate 
This command is available only if t he data contain protei n-coding nucleotide 
sequences.  It automatically extracts a ll protein-coding domains for translation 
and displays the corresponding protein sequ ence.  If the translated sequence is 
already displayed, then issuing this command displays the original nucleotide 
sequences, including all c oding and non-coding regions.  Depending on the data 
displayed (translated or nucleotide), rele vant menu options in the Sequence Data 
Explorer are enabled.  However, transla ted and un-translated status does not 
have any impact on the analytical options available in MEGA  (e.g., Distances  or Molecular Evolutionary Genetics Analysis 
84 Phylogeny  menus), as MEGA  provides all possible options  for your dataset at all 
times.  
 
Select Genetic Code Table (in Sequence Data Explorer)  
Data | Select Genetic Code Table 
Select Genetic Code Table, can be in voked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Setup/Select Taxa & Groups (in Sequence Data Explorer)  
Data | Setup/Select Taxa & Groups  
Setup/Select Taxa & Groups, can be invo ked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Setup/Select Genes & Domains (in Sequence Data Explorer)  
Data | Setup/Select Genes & Domains 
Setup/Select Genes & Domains, can be in voked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Export Data (in Sequence Data Explorer)  
Data | Export Data 
The Exporting Sequence Data  dialog box first displays an edit box for entering a 
title for the sequence data bei ng exported.  The default nam e is the original name 
of the data set, if there wa s one.  Below the title is a space for entering a brief 
description of the data set being exported.   
Next is the option for det ermining the format of the data set being exported; 
MEGA  currently allows the us er to export the data in MEGA , PAUP 3.0 and 
PAUP 4.0 (Nexus, Interleaved in both case s), and PHYLIP 3.0 (Interleaved).  tA 
the end of each line, is "Wri ting site numbers." The three options available are to 
not write any number, to write one for each site, or to wr ite the site number of the 
last site. 
Other options in this dialog box include the number of sites per line, which codon 
position(s) is to be used and whether non-coding regions should be included, and 
whether the output is to be interleav ed.  For missing or ambiguous data and 
alignment gaps, there are four options: in clude all such data, exclude all such 
data, exclude or include sites with mi ssing or ambiguous data only, and exclude 
sites with alignment gaps only. 
Quit Data Viewer  
Data | Quit Data Viewer Part III:  Input Data Types and File Format 
85 This command closes the Sequence Data Explorer, and takes the user back to 
main interface. 
 
DDiissppllaayy  MMeennuu  
Data Menu (in Sequence Data Explorer)  
This menu provides commands for wo rking with selected data in the Sequence 
Data Explorer  
The commands in this menu are: 
Write Data to File  Brings up the Exporting Sequence Data  dialog 
box. 
Translate/Untranslate  Translates protein-coding nucleotide 
sequences into protein sequences, and back to 
nucleotide sequences. 
Select Genetic Code 
Table  Brings up the Select Genetic Code  dialog box, 
in which you can select, edit or add a genetic 
code table. 
Setup/Select Genes and 
Domains  Brings up the Sequence Data Organizer , in 
which you can define and edit genes and 
domains.  
Setup/Select Taxa and 
Groups  Brings up the Select/Edit Taxa and Groups dialog, in which you can edit taxa and define 
groups of taxa.  
Quit Data Viewer  Takes the user back to the main interface. 
 
Restore Input Order
 
Display | Restore Input Order 
Choosing this restores the or der in Sequence Data Explor er to that in the input 
text file. 
Show Only Selected Sequences  
Display | Show only Selected Sequences 
The check boxes in the left column of the display grid can be used to select or 
deselect sequences for analysis.  Subseq uent use of the "Show Only Selected 
Sequences" option in the Display menu of  Sequence Data Explorer hides all the 
deselected sequences and displa ys only the selected ones. 
 
Color Cells  
Display | Color cells 
This command colors individual cells in  the two-dimensional display grid Molecular Evolutionary Genetics Analysis 
86 according to the nucleotide or amino acid  it contains.  A list of default colors, 
based on the biochemical properties of the residues, is given below.  In a future 
version, these colors will be customizable by the user.  
 
For DNA sequences:  
Symbo
l Color  
A Yellow 
G Fuchsia 
C Olive 
T Green 
U Green 
 For amino acid sequences:
 
Symbo
l Color   Symbo
l Color  
A Yellow  M Yellow 
C Olive  N Green D Aqua  P Blue 
E Aqua  Q Green 
F Yellow  R Red 
G Fuchsi
a  S Green 
H Teal  T Green 
I Yellow  V Yellow 
K Red  W Green 
L Yellow  Y Lime 
  
Use Identical Symbol
 
Display | Use Identical Symbol 
Data that contain multiple aligned sequenc es may be easier to view if, when the 
nucleotide (amino acid) is the same as t hat in the corresponding site in the first 
sequence, the nucleotide (amino acid) is r eplaced by a dot.  Choosing this option 
again brings back the nucleotide (amino acid) single-letter codes. 
 
Show Sequence Names  
Display | Show Sequence Names 
This option displays the full sequenc e names in Sequence Data Explorer   
 
Show Group Names  
Display | Show Group Names 
This option displays the full group names  in Sequence Data Explorer if the Part III:  Input Data Types and File Format 
87 sequences have been grouped in Select/Edit Taxa Groups 
 
Change Font...  
Display | Change Font… 
This command brings up the Change Font  dialog box, which allows you to 
change the display font, including font type, style and size.  Options to strikeout 
or underline selected parts of the sequences are also available.  There is also an 
option for using different scripts, although the only option currently available is 
"Western".  Finally the "Sample" window displays the effects of your choices  
 
Sort Sequences  
Display | Sort Sequences 
The sequences in the data set can be sorted based on several options: 
sequence name, group name, gr oup and sequence names, or as per the order in 
the Select/Edit Taxa Groups dialog box.  
Sort Sequences by Group Name
 
Display | Sort Sequences | By Group Name 
Sequences that have been gr ouped in Select/Edit Taxa Groups can be sorted by 
the alphabetical order of group names or numerical or der of group ID numbers.  
If the group names contain both a name and a number, the numerical order will 
be nested within the alphabetical order. 
 
Sort Sequences by Group and Sequence Names  
Display | Sort Sequences | By Group and Sequence Names  
Sequences that have been gr ouped in Select/Edit Taxa Groups can be sorted by 
the alphabetical order of group names or the numerical order of group ID 
numbers.  If the group names contain both a nam e and a number, the numerical 
order is nested within t he alphabetical order.  The sequences can be further 
arranged by sorting the sequence names within the group names. 
 Sort Sequences As per Taxa/Group Organizer
 
Display | Sort Sequences | As per Taxa/Group Organizer 
The sequence/group order seen in Select/Edi t Taxa Groups is initially the same 
as the order in the input text file.  However, this order can be changed by 
dragging-and-dropping.  Choose this option if you wish to see the data in the 
same order in the Sequence Data Explorer as in Select/Edit Taxa Groups . 
 
Sort Sequences By Sequence Name  
Display | Sort Sequences | By Sequence Name Molecular Evolutionary Genetics Analysis 
88 The sequences are sorted by the alphabet ical order of sequence names or the 
numerical order of sequence ID numbers.  If the sequenc e names contain both a 
name and a number, then the sorting is done with the numerical order nested 
within the alphabetical order. 
 
HHiigghhlliigghhtt  MMeennuu  
Highlight Menu (in Sequence Data Explorer)  
This menu can be used to highlight certai n types of sites.  The options are 
constant sites, variable sites, parsimony-inf ormative sites, singl eton sites, 0-fold, 
2-fold and 4-fold degenerate sites.  
Highlight Conserved Sites
 
Highlight | Conserved Sites 
Use this command to high light constant sites  
 
Highlight Variable Sites  
Highlight | Variable Sites 
Use this command to highli ght variable sites sites. 
Highlight Singleton Sites  
Highlight | Singleton Sites Use this command to high light singleton sites. 
 
Highlight Parsimony Informative Sites
 
Highlight | Parsim-Info Sites 
Use this command to highlight pa rsimony-informative sites.  
 
Highlight 0-fold Degenerate Sites  
Highlight | 0-fold  Degenerate Sites 
Use this command to highlight  0-fold degenerate sites. 
 Highlight 2-fold Degenerate Sites
 
Highlight | 2-fold  Degenerate Sites 
Use this command to highlight 2-fold degenerate sites. The command is visible 
only if the data consists of nucleotide sequences. 
 
Highlight 4-fold Degenerate Sites  
Highlight | 4-fold  Degenerate Sites Part III:  Input Data Types and File Format 
89 Use this command to highlight 4-fold degenerate sites. The command is visible 
only if the data consists of nucleotide sequences. 
 
SSttaattiissttiiccss  MMeennuu  
Statistics Menu (in Sequence Data Explorer)  
Various summary statistics of the sequences can be computed and displayed 
using this menu.  The commands are: 
Nucleotide Composition. 
Nucleotide Pair Frequencies. 
Codon Usage. 
Amino Acid Composition. Use All Selected Sites. Use only Highlighted Sites.  Sites c an be selected according to various 
criteria (see Highlight Sites), and analysis can be performed only on the 
chosen subset of sites. 
 
Nucleotide Composition
 
Statistics | Nucleotide Composition 
This command is visible only if the dat a consist of nucleotide sequences.  MEGA  
computes the base frequencies for each sequenc e as well as an overall average.  
These will be displayed by domain in a Te xt Editor domain (if the domains have 
been defined in Setup/Select Genes & Domains). 
 
Nucleotide Pair Frequencies  
Statistics | Nucleotide Pair Frequencies 
This command is visible only if the data c onsists of nucleotide sequences.  There 
are two options available: one in whic h the nucleotide acid pairs are counted 
bidirectionally site-by-site for the tw o sequences (giving rise to 16 different 
nucleotide pairs), the other, in which t he pairs are counted unidirectionally (10 
nucleotide pairs).  MEGA  will compute the frequencies of these quantities for 
each sequence as well as an overall average.  They will be displayed in a Text 
Editor domain by domain (if domains have been defined in Setup/Select Genes & 
Domains).  
Codon Usage
 
Statistics | Codon Usage 
This command is visible only if the dat a contains protei n-coding nucleotide 
sequences.  MEGA 4  computes the percent c odon usage and the RCSU values 
for each codon for all sequences inclu ded in the dataset.  Results will be 
displayed in a Text Editor domain (if domains have been defined in Setup/Select 
Genes & Domains). Molecular Evolutionary Genetics Analysis 
90 Amino Acid Composition  
Statistics | Amino acid Composition  
This command is visible only if the data c onsists of amino acid sequences or if 
the translated protein coding nucleot ide sequences are displayed.  MEGA  will 
compute the amino acid frequencies for each sequence as well as an overall 
average, which will be displayed in a Te xt Editor domain (if domains have been 
defined in Setup/Select  Genes & Domains). 
 
Use All Selected Sites  
Statistics | Use All Selected Sites  
Analysis is conducted on all sites in the sequences, irrespective of whether any 
sites have been labeled or highlighted.  
Use only Highlighted Sites
 
Statistics | Use only Highlighted Sites 
Sites can be selected according to various  criteria (see Highlight Sites), and 
analyses will be performed only on the chosen s ubset of sites.  All statistical 
attributes will be based on these sites. 
 
5.4.2 Distance Data Explorer 
DDiissttaannccee  DDaattaa  EExxpplloorreerr  
The Distance Data Explorer shows the pair-wise distance data.  This explorer is 
flexible and it provides useful functi onalities for computing within group, among 
group, and overall averages, as well as fa cilities for selecting data subsets. 
 
This explorer consists of a number of regions as follows: 
Menu Bar  
File menu 
Display menu 
Average menu.  
Help: This item brings up the help file.  
Tool Bar  
The tool bar provides quick acce ss to a number of menu items. 
• General Utilities 
• 
 :  This icon brings up the Options dialog box to export the 
distance matrix as a text file  with options to control how MEGA  writes 
the output data. 
• 
: This button brings up the dial og box for setting up, editing, and 
selecting taxa and groups of taxa. 
• Distance Display Precision Part III:  Input Data Types and File Format 
91 • 
 : With each click of this button, t he precision of the distance display 
is decreased by one decimal place. 
• 
 : With each click of this button, t he precision of the distance display 
is decreased by one decimal place. 
• Column Sizer: This is a slider that can be used to increase or 
decrease the width of the columns that show the pair-wise distances. 
The 2-Dimensional Data Grid  
This grid displays the pair-wise distanc es between all the sequences in the data 
in the form of a lower or upper triangul ar matrix.  The names of the sequences 
and groups are the row-header s; the column headers are numbered from 1 to m, 
m being the number of sequences.  There is a column sizer button for the row-
headers, so you can increase or decrease the column size to accommodate the 
full name of the sequences and groups.  
• Fixed Row :  This is the first row in the data grid that displays the column 
number. 
• Fixed Column :  This is the first and the leftm ost column in the data grid and 
contains taxa names.  Even if you scr oll past the initial screen this column 
will always be visible.  To include a ta xon in the data set for analysis, check 
the associated box.  In this column, you also can drag-and-drop taxa names 
to sort them in the desired manner. 
• Rest of the Grid : The cells to the right of the first column and below the first 
row contain the nucleotides or amino acid s of the input data.  Note that all 
cells containing data corresponding to unselected sequences or 
genes/domains are drawn in a light color. 
Status bar  
The status bar shows the sequence pair corresponding to the position of the 
cursor when the cursor is on any distance value in the display.  
 
FFiillee  MMeennuu  ((iinn  DDiissttaannccee  DDaattaa  EExxpplloorreerr))  
The File menu consists of three commands: 
• Select & Edit Taxa/Groups :  This brings up a dialog box to categorize the 
taxa into groups. 
• Export/Print Distances :  This brings up a dialog box for writing pair-wise 
distances as a text file, with a choice of several formats. 
• Quit Viewer :  This closes the Distance Data Explorer . 
 
DDiissppllaayy  MMeennuu  ((iinn  DDiissttaannccee  DDaattaa  EExxpplloorreerr))  
The Display  menu consists of four main commands: 
• Show Only Selected Taxa :  This is a toggle, showi ng a matrix of all or only Molecular Evolutionary Genetics Analysis 
92 selected taxa.  
• Sort Taxa :  This provides a submenu for sort ing the order of taxa in one of 
three ways: by input order, by  taxon name or by group name. 
• Show Group Names :  This is a toggle for displaying or hiding the group 
name next to the name of each taxon, when available. 
• Change Font : This brings up the dialog box, which allows you to choose the 
type and size of the font used to  display the distance values. 
 
AAvveerraaggee  MMeennuu  ((iinn  DDiissttaannccee  DDaattaa  EExxpplloorreerr))  
This menu is used for the computation of average values using the selected taxa.  
The following averaging options are available: 
Overall :  This computes and disp lays the overall average. 
Within groups :  This is enabled only if at l east one group is defined.  For each 
group, an arithmetic average is computed for all valid pair-wise comparisons and 
results are displayed in the Distance Matrix Explorer .  All incalculable within-
group averages are shown with a red "n/c". Between groups :  This is enabled only if at least two groups of taxa are defined.  
For each between group aver ages, an arithmetic aver age is computed for all 
valid inter-group pair-wise comparisons and results are displayed in the Distance 
Matrix Explorer .  All incalculable within grou p averages are shown with a red 
"n/c". Net Between Groups :  This computes net average distances between groups of 
taxa and is enabled only if at least two groups of taxa with  at least two taxa each 
are defined.  The net average distanc e between two groups is given by 
d
A = dXY – (dX - dY)/2 
where, dXY is the average distance between groups X and Y, and dX and dY are 
the mean within-group distances.   All incalculab le within group averages are 
shown with a red "n/c". 
 
OOppttiioonnss  ddiiaalloogg  bbooxx  
At the top of the options di alog box is an option for the output format (Publication 
and MEGA ) with the type of information that  is output (distances) mentioned 
beneath.  Below this is the option for out putting the distance data as a lower left 
triangular matrix or an upper right triangular  matrix. On the right are options for 
specifying the number of decimal places for the pair-wise distances in the output, 
and the maximum number of dist ances per line in the matrix. 
In addition there are three buttons, one to pr int or save the output, one to quit the 
Options dialog box  without exporting the data ( Cancel ), and the third to bring up 
the help file (this file).  The Print/Save  button brings up the Distances Display 
Box, where the distances are displayed as specified, with various options to edit, 
print and save the output. 
 Part III:  Input Data Types and File Format 
93 5.5 Text File Editor and Format Converter 
MEGA  includes a Text File Editor , which is useful for creating and editing ASCII 
text files. It is in voked automatically by MEGA  if the input data file processing 
modules detect errors in the data file format.  In this case, you should make 
appropriate changes and save the data file. 
The text editor is straightforward if you are familiar with programs like Notepad. 
Click on the section you wish to change, type in  the new text, or select text to cut, 
copy or paste. Only the display font c an be used in a document. You can have as 
many different text editor windows open at one time and you may close them 
independently. However, if you have a file open in the Text Editor , you should 
save it and close the Text Editor  window before trying to use that data file for 
analysis in MEGA . Otherwise, MEGA  may not have the most  up-to-date version 
of the data. The Text File Editor and Format converter  is a sophisticated tool with numerous 
special capabilities that include: 
• Large files  –The ability to operate on files of virtually unlimited size and 
line lengths. 
• General purpose –Used to view/edit any ASCII text file. 
• Undo/ReDo  –The availability of an un limited depth of undo/redo options 
• Search/Replace  –Searches for and does block replacements for 
arbitrary strings. 
• Clipboard  – Supports familiar clipboard cut, copy , and paste  operations. 
• Normal and Column blocks  – Supports regular contiguous line blocks 
and columnar blocks.  This is qui te useful while manually aligning 
sequences in the Text Editor .  
• Drag/Drop  – Moves text with the familiar cut and paste operations or you 
can select the text and t hen move it with the mouse. 
• Screenshots  –Creates screen snapshots for teaching and 
documentation purposes directly from the edit window. 
• Printing  –Prints the contents of the edit file. 
 
The Text Editor  contains a menu bar, a t oolbar, and a status bar. 
The Menu bar
 
Menu  Description  
File menu The File Menu contains the functions that are most 
commonly used to open, save, rename, print, and close 
files.  (Although there is no separate "rename" function 
available, you can rename a file by choosing the Save 
As… menu item and giving the file a different name 
before you save it.) Molecular Evolutionary Genetics Analysis 
94 Edit menu The Edit Menu contains f unctions that are commonly 
used to manipulate blocks of text.  Many of the edit menu 
items interact with the Windows Clipboard, which is a 
hidden window  that allows various selections to be copied 
and pasted across documents and applications. 
Search  menu The Search Menu has several functions that allow you to 
perform searches and replacement s of text strings.  You 
can also jump directly to a specific line number in the file. 
Display  menu  The Display Menu contains functi ons that affect the visual 
display of files in the edit windows. 
Utilities  menu  The Utilities Menu contains se veral functions that make 
this editor especially useful for working with files containing molecular sequence data (note that the MEGA  
editor does not try to underst and the contained data, it 
simply operates on the text, assuming that the user 
knows what (s)he is doing. 
Toolbar
 
The Toolbar contains shortcuts to some frequently used menu commands. 
Status Bar  
The Status bar is positioned at the bo ttom of the editor window. It shows the 
position of the cursor (line number and posit ion in the line), whether the file has 
been edited, and the status of some  keyboard keys (CAPS, NUM, and SCROLL 
lock). 
 
Hotkeys and Shortcut keys 
Many menu items have a hotkey  and/or a shortcut  key.  These are special key 
combinations that are helpful for peopl e who are more comfortable using a 
keyboard than the mouse.  Hotkeys  are identified by an underscore character in 
the name of the m enu item, e.g., "F ile", "N ew".  These allow you to hold down the 
Alt-key, which is usually found next to t he space bar on the ke yboard, then hit the 
underlined letter to produce the same action as if you clicked that name with the 
mouse.  We show this using the notation <Alt>+key – e.g., the hotkey for the file 
menu item is shown as <Alt>+F.  Be sure that you depress both keys together, 
holding the <Alt> key down a little bit longer  than the letter key.  (Some people try 
hitting both keys simultaneously, as if they’re hitting two keys on a piano 
keyboard.  Quite often, this approach  does not produce the desired results.) 
For instance, you could create a new f ile by clicking the mouse on the "File" 
menu item, then clicking on t he "New" item beneath it.  Using hotkeys, you could 
type <Alt>+F followed by <Alt>+N.  Or, mo re simply, while you’re holding down 
the <Alt> key, hit the ‘F’ key followed by  the ‘N’ key, then release the <Alt> key. 
You might notice that several menu it ems, e.g., the New Item on the File 
menu, show something to the right that looks like ‘Ctrl+N’.  This is called a 
Shortcut  key sequence.  Whereas execut ing a command with hotkeys often 
requires several keystrokes, shortcut keys can do the same thing with just one Part III:  Input Data Types and File Format 
95 keystroke.   Shortcut keys work the sa me as hotkeys, using the <Ctrl> key 
instead of the <Alt> key.   To create a new file, for example, you can hold down 
the <Ctrl> key and hit the ‘N’ key, which is shown as <Ctrl>+N here.  (In the 
menus, this appears simply as ‘Ctrl+N’.)   
Not all menu items have associated s hortcut keys because there are only 
26 shortcut keys, one for each letter of the alphabet.  Hotkeys, in contrast, are 
localized to each menu and submenu.  For hotkeys to work, t he menu item must 
be visible whereas shortcut keys work at any time.   For instance, if you are typing 
data into a text file and want to creat e a note in a new window, you may simply 
hit the shortcut key sequence, <Ctrl>+N  to generate a new wi ndow.  After you 
type the note, you can hit <Ctrl>+S to save it, give it a file name, hit the enter key 
[this part doesn’t make sense]; then you can hit the <Alt>+F+C hotkey sequence 
to close the file (there is no shortcut key for closing a file). 
 
 
UUssiinngg  TTeexxtt  EEddiittoorr  
File Menu  
NNeeww  ((iinn  TTeexxtt  EEddiittoorr))  
File | New 
Use this command to create a new file in the Text Editor . 
 
OOppeenn  ((iinn  TTeexxtt  EEddiittoorr))  
File | Open 
Use this command to open an existing file in the Text Editor .  
 
RReeooppeenn  ((iinn  TTeexxtt  EEddiittoorr))  
File | Reopen 
Choose this command to reopen a recently  closed text file  from the most-
recently-used-files list. When you close a text file in the Text Editor , it is added to 
the Reopen list. 
 
SSeelleecctt  AAllll  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Select All  
This is used to select (highlight ) everything in the displayed file. 
 
GGoo  ttoo  LLiinnee  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Go to Line #  
This opens a small dialog box that allows  you to enter a number indicating the 
line to which you want to move.  Molecular Evolutionary Genetics Analysis 
96 SShhooww  LLiinnee  NNuummbbeerrss  ((iinn  TTeexxtt  EEddiittoorr))  
Display | Show Line Numbers  
This item can be checked ( on) or un-checked (off) to show whether line numbers 
are displayed next to the lines. 
 
WWoorrdd  WWrraapp  ((iinn  TTeexxtt  EEddiittoorr))  
Display | Word Wrap  
This item can be checked ( on) or un-checked (off) to show whether lines in the 
edit window are automatically wrapped around based on the current window’s 
width.  
SSaavvee  ((iinn  TTeexxtt  EEddiittoorr))  
File | Save 
This allows you to save the file currently being edited. 
 
SSaavvee  AAss  (
(iinn  TTeexxtt  EEddiittoorr))  
File | Save As 
This command brings up the Save As  dialog box, which allows  you to choose the 
directory, the filename and extension, and the type of file you wish to save. To 
make a file suitable for loading as data in MEGA , you should save the file in 
MEGA  format (it is a plain ASCII text file).  If there is already another file with the 
same name, it will be overwritten 
 
PPrriinntt  ((iinn  TTeexxtt  EEddiittoorr))  
File | Print 
This command will print the currently disp layed file to the selected printer. 
 
CClloossee  FFiillee  ((iinn  TTeexxtt  EEddiittoorr))  
File | Close File  
This closes the current file. 
 
EExxiitt  EEddiittoorr  ((iinn  TTeexxtt  EEddiittoorr))  
File | Exit Editor 
This closes the currently open file.  If t he file was modified, but the modifications 
have not been saved, MEGA will ask whether to discard the changes.  Note that 
this command exits the Text Editor  only, not MEGA . 
 
DDeelleettee  ((iinn  TTeexxtt  EEddiittoorr))  Part III:  Input Data Types and File Format 
97 Edit | Delete  
This deletes the selected (highlighted) te xt.  It is NOT copied to the clipboard. 
 
Edit Menu  
CCuutt  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Cut 
This command places a copy of  the selected text on the Windows  clipboard, 
removing the original string. To paste the contents on the c lipboard, use the 
Paste command.  
CCooppyy  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Copy This places a copy of the selected text on the Windows
 clipboard, leaving the 
original string untouched. To paste the contents on the clipb oard, use the Paste 
command. 
 
PPaassttee  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Paste 
This inserts the most recently copied text present on the Windows  clipboard. 
UUnnddoo  ((iinn  TTeexxtt  EEddiittoorr))  
Edit | Undo 
Choose this command to undo your most recent action.  Repeated use of this 
command will undo each action, starting wit h the most recent and going to the 
oldest. It has unlimited depth. 
 
FFoonntt  ((iinn  TTeexxtt  EEddiittoorr))  
Display | Set Font 
Choose this command to activate a di alog box with which you can change the 
display font used by the Text Editor . Since an ASCII text file does not have a font 
attribute, it simply contains the text in the file.  Therefore t he change in the font 
only affects the display. The new font is remembered by MEGA  as your preferred 
display font for the Text Editor .   
Search Menu  
FFiinndd  ((iinn  TTeexxtt  EEddiittoorr))  
Search | Find Choose this command to display the Find Text  dialog box. 
 Molecular Evolutionary Genetics Analysis 
98 FFiinndd  AAggaaiinn  ((iinn  TTeexxtt  EEddiittoorr))  
Search | Find Again 
Choose this to repeat the last Find command. 
 
RReeppllaaccee  ((iinn  TTeexxtt  EEddiittoorr))  
Search | Replace This brings up a Search and Replace dialog box, which allows you to replace a 
text string in the file  currently being edited. 
 
 
5.6 Visual Tools for Data Management 
5.6.1 Setup/Select Taxa & Groups Dialog 
 
This dialog box has two sub-windows ( Taxa/Groups  and Ungrouped Taxa ), a panel bar 
between them containing a few buttons, and a command panel, with the lower part 
containing the Add, Delete , Close , and Help buttons. 
 
Taxa/Groups sub-window on the left:  It shows all the currently defined taxa and group 
names hierarchically.  If a taxon has been assigned to a group, it will appear connected 
to that group.  Groups may be displayed in a collapsed format (indicated by a + mark before their name). You can click '+' to expand the group to a listing of the taxa 
contained in it, and click ‘–‘ to collapse the group to only view the group name. Groups 
that do not contain any members do not have this box. Next is a checkbox indicating 
whether a given group or taxon will be included in an analysis. Following that is an icon indicating a taxon (single box) or a group (lay er of boxes).  Grayed out check boxes are 
used to indicate that some of the taxa in a group are selected and others are unselected.  
You can rearrange the order of taxa and groups using drag-and-drop. However, note 
that this order is not automatically used in the Data Explorer . To enforce this order, use 
the Sort command in the Data Explorer . 
 
Ungrouped Taxa Sub-window  on the right:  This shows the names of all the taxa that do 
not belong to any of the groups to facilitate your ability to move taxa into groups.  If this 
sub-window does not appear on your screen, then hold and drag the lower right corner 
of the dialog box to expand its width to unhide it.  Middle Command Panel:  This resides between the above-mentioned two sub-windows 
and contains a splitter on its right edge.  You can grab the splitter and move it to change 
the proportion of the space taken by the two sub-windows.  In this panel left and right 
arrow buttons are used to add or remove taxa from the groups.  Clicking the hand-with-a-pencil icon with a highlighted taxon or group name will allow you to edit that name.  Lower Command Panel :  In the lower part of the Select/Edit Taxa/Groups  window are 
buttons that are used to add and/or delete groups.  The ‘+’ and ‘–‘ buttons are also Part III:  Input Data Types and File Format 
99 present on the middle command panel. 
 
Buttons  Description  
Add Creates a new group. 
Delete Deletes the currently selected group. Any taxa that were assigned to the group will become freestanding. 
Ungroup Makes all the taxa in the selected group freestanding, but does not remove the group from the list. 
Close Closes the dialog box. 
Help Brings up help regarding the dialog box. 
 
How to perform functions:
 
 
Function  Description  
Creating a new 
group Click on the Add button. Click on the highlighted name of the 
group and type in a new name. 
Deleting a group Select the group and click the Delete  button.  Any taxa that 
were assigned to this group will become freestanding. 
Adding taxa to a 
group Drag-and-drop the taxon on the desired group or select one 
or more taxa in the Ungrouped Taxa  window and click on 
the left arrow button on the middle command panel.  
Removing a taxon 
from a group Click on the taxon and drag-and-drop it into a group (or 
outside all groups).  Or, select the taxon and click on the 
right arrow button on the middle command panel. 
Include/Exclude taxa or groups Click the checkbox next to the group or taxa name. 
 
5.6.2 Groups of taxa 
A group of taxa is a set of one or more taxa. Members of a group can be 
specified in the input data file, and created and edited in the Setup Taxa and 
Groups dialog. 
Groups of taxa often are constructed bas ed on their evolutionary relatedness.  
For example, sequences may be grouped ba sed on the geographic origin of the 
source individual, or sequences from a multi-gene family may be arranged into 
groups consisting of orthologous sequences.  
5.6.3 Data Subset Selection 
SSeeqquueennccee  DDaattaa  SSuubbsseett  SSeelleeccttiioonn
  
Any subset of sequence data can be selected for analysis using the options in 
the Data menu.  You may: Molecular Evolutionary Genetics Analysis 
100 1. Select Taxa  (sequences) or Groups  of taxa through the Setup/Select Taxa & 
Groups  dialog box, 
2. Choose Domains  and Genes  through the Setup/Select Genes & Domains  
dialog box, 
Items 1 and 2 lead to the construction of a primary data subset, which is 
maintained until it is modified in the two dialog boxes mentioned in the above 
items or in the Sequen ce Data Explorer. 
3. Select any combination of Codon Positions to use through the Analysis 
Preferences/Options dialog box  from the Data | Sele ct Preferences menu 
item in the main interface.   
4. Choose to include only the Labeled Sites through the Data | Select 
Preferences menu item. 
5. Decide to enforce Complete-Deleti on or Pair-wise-Dele tion of the missing 
data and alignment gaps. 
Items 3, 4, and 5 provide t he second level of data subset  options.  You are given 
relevant choices immediately prior to the start of the analysis.  Therefore, these 
choices are secondary in nature and are s pecific to the currently requested 
analysis.  The Analysis Preferences  dialog box remem bers them for your 
convenience and provides them as a def ault the next time you conduct an 
analysis that utilizes those options. 
  
DDiissttaannccee  DDaattaa  SSuubbsseett  SSeelleecctt
iioonn  
You may select Select Taxa  (sequences) or Groups of taxa through the Setup/Select 
Taxa & Groups dialog box to construct a distance matrix.  You also can select 
sequences in the Distance Data Explorer  by clicking on the check marks next to the taxa 
names. 
  
101 6 Part IV:  Evolutionary Analysis 
6.1 Computing Basic Statistical Quantities for Sequence 
Data 
6.1.1 Basic Sequence Statistics 
In the study of molecular evolution, it often is necessary to know some basic statistical 
quantities, such as nucleotide frequencies, codon frequencies, and 
transition/transversion ratios. The statistical quantities that can be computed by MEGA  
are discussed in this section. 
 
6.1.2 Nucleotide and Amino Acid Compositions 
The relative frequencies of the four nucleotides (nucleotide composition) or of the 20 
amino acid residues (amino acid composition) can be computed for one specific 
sequence or for all sequences. For the coding regions of DNA, additional columns are presented for the nucleotide compositions at the first, second, and third codon positions.  
All results are presented domain-by-domain, if the dataset contains multiple domains.  Results for the amino acid composition are presented in a similar tabular form. 
 
Nucleotide Pair Frequencies  
Statistics | Nucleotide Pair Frequencies 
This command is visible only if the data c onsists of nucleotide sequences.  There 
are two options available: one in whic h the nucleotide acid pairs are counted 
bidirectionally site-by-site for the tw o sequences (giving rise to 16 different 
nucleotide pairs), the other, in which t he pairs are counted unidirectionally (10 
nucleotide pairs).  MEGA  will compute the frequencies of these quantities for 
each sequence as well as an overall average.  They will be displayed in a Text 
Editor domain by domain (if domains have been defined in Setup/Select Genes & 
Domains). 
Codon Usage  
Statistics | Codon Usage 
This command is visible only if the dat a contains protei n-coding nucleotide 
sequences.  MEGA 4  computes the percent c odon usage and the RCSU values 
for each codon for all sequences inclu ded in the dataset.  Results will be 
displayed in a Text Editor domain (if domains have been defined in Setup/Select 
Genes & Domains). 
 
6.1.3 Pattern Menu 
This menu provides access to the test for examining the substitution pattern 
homogeneity between sequences (Kumar and Gadagkar 2001) and computing the two Molecular Evolutionary Genetics Analysis 
102 statistics related to this test (pair-wise sequence composition distance and the disparity 
index) (Kumar and Gadagkar 2001). 
 
 
6.2 Computing Evolutionary Distances 
6.2.1 Distance Models 
MMooddeellss  ffoorr  eessttiimmaattiinngg  ddiissttaanncceess  
The evolutionary distance between a pair of sequences usually is measured by the 
number of nucleotide (or amino acid) substitutions occurring between them. Evolutionary 
distances are fundamental for the study of molecular evolution and are useful for 
phylogenetic reconstructions and the estimation of divergence times. Most of the widely 
used methods for distance estimation for nucleotide and amino acid sequences are included in MEGA . In the following three sections, we present a brief discussion of these 
methods: nucleotide substitutions, synonymous-non-synonymous substitutions, and amino acid substitutions. Further details of these methods and general guidelines for the 
use of these methods are given in Nei and Kumar (2000).  Note that in addition to the 
distance estimates, MEGA 4  also computes the standard errors of the estimates using 
the analytical formulas and the bootstrap method. 
Distance methods included in MEGA  in divided in three categories (Nucleotide, 
Syn-non-synonymous, and Amino acid): 
Nucleotide 
 Sequences are compared nucleotide-by-nucleotide.  These distances can be 
computed for protein coding and non-coding nucleotide sequences. 
 No. of differences   
 p-distance  
 Jukes-Cantor  Model  
     with Rate Uniformity Among Sites      with Rate Variation Among Sites 
 Tajima-Nei  Model 
     with Rate Uniformity and Pattern Homogeneity   
     with Rate Variation Among Sites  
     with Pattern Heterogeneity Between Lineages       with Rate Variation and Pattern Heterogeneity Heterogeneity   Kimura 2-Parameter  Model 
     with Same Rate Among Sites   
     with Rate Variation Among Sites) 
 Tamura 3-Parameter  Model 
     with Rate Uniformily and Pattern Homogeneity   
     with Rate Variation Among Sites  
     with Pattern Heterogeneity Between Lineages       with Rate Variation and Pattern Heterogeneity  
 Tamura-Nei  Model 
     With Rate Uniformity and Pattern Homogeneity   
     with Rate Variation Among Sites Part IV:  Evolutionary Analysis 
103      with Pattern Heterogeneity Between Lineages  
     with Rate Variation and Pattern Heterogeneity  
 Log-Det Method 
     with Pattern Heterogeneity Between Lineages 
 Maximum Composite Likelihood  Model  
     with Rate Uniformity and Pattern Homogeneity  
     with Rate Variation Among Sites  
     with Pattern Heterogeneity Between Lineages       with Rate Variation and Pattern Heterogeneity  
  
SSyynn--NNoonn--ssyynnoonnyymmoouuss  
Sequences are compared codon-by-codon.  These distances can only be computed for 
protein-coding sequences or domains.  Nei-Gojobori Method   
 Modified Nei-Gojobori Method   
 Li-Wu-Luo Method   
 Pamilo-Bianchi-Li Method   
 Kumar Method   
  
AAmmiinnoo  AAcciidd  
Amino acid sequences are compared residue-by-residue.  These distances can be computed for protein sequences and protein-coding nucleotide sequences.  In the latter case, protein-coding nucleotide sequences are automatically translated using the selected genetic code table.  No. of differences   
 p-distance  
 Poisson  Model 
     with Rate Uniformily Among Sites   
     with Rate Variation Among Sites 
 Equal Input  Model 
     with Rate Uniformity and Pattern Homogeneity  
     with Rate Variation Among Sites       with Pattern Heterogeneity Between Lineages       with Rate Variation and Pattern Heterogeneity  
 Dayhoff and JTT  Models 
     with Rate Uniformity Among Sites  
     with Rate Variation Among Sites  
  
  
NNuucclleeoottiiddee  SSuubbssttiittuuttiioonn  MMooddeellss  
No. of differences (Nucleotide)  
 
This distance is the number of sites at which the two compared sequences differ.  If you Molecular Evolutionary Genetics Analysis 
104 are using the pair-wise deletion option for handling gaps and missing data, it is important 
to realize that this count does not normalize the number of differences based on the number of valid sites compared, if the sequences contain alignment gaps.  Therefore, 
we recommend that if you use this distance you use the complete-deletion option. 
 For this distance, MEGA  provides facilities for computing the following quantities: 
d: Transitions + Transversions : Number of different nucleotide sites. 
s: Transitions only : Number of nucleotide sites with transitional differences. 
v: Transversions only : Number of nucleotide sites with transversional differences. 
R = s/v: Transition/transversions ratio. 
L: No of valid common sites : Number of compared sites. 
Formulas for computing these quantities and their variances are as follows. 
Var(d)  = 
 
Var(s) = 
  
Var(v) = 
  
R = 
  
Var(R) = 
  
where 
  and 
  
P and Q are the proportion of sites showing transitional and transversional differences, 
respectively. 
 
See also Nei and Kumar (2000), page 33. 
  
p-distance (Nucleotide)  
This distance is the proportion ( p) of nucleotide sites at which two sequences being 
compared are different. It is obtained by dividing the number of nucleotide differences by 
the total number of nucleotides compared.  It does not make any correction for multiple 
substitutions at the same site, substitution rate biases (for example, differences in the 
transitional and transversional rates), or diffe rences in evolutionary rates among sites. 
 MEGA  provides facilities for computing following p-distances and related quantities: 
 
d: Transitions + Transversions   : Proportion of nucleotide sites that are different. 
s: Transitions only  : Proportion of nucleotide sites with transitional differences. 
v: Transversions only  : Proportion of nucleotide sites with transversional differences. 
R = s/v : Transition/transversions ratio. 
L: No of valid common sites : Number of sites compared. 
 
Formulas for computing these quantities are as follows: 
Quantity
 Formula  Variance  
, 
 , 
  
s, 
, 
  
v, 
, 
  Part IV:  Evolutionary Analysis 
105 R, 
 , 
  
where 
 and 
  
P and Q are the proportion of sites showing transitional and transversional differences, 
respectively. 
 See also Nei and Kumar (2000), page 33. 
 
 
Jukes-Cantor distance  
In the Jukes and Cantor (1969) model, the rate of nucleotide substitution is the same for 
all pairs of the four nucleotides A, T, C, and G.  As is shown below, the multiple hit correction equation for this model produces a maximum likelihood estimate of the number of nucleotide substitutions between two sequences.  It assumes an equality of 
substitution rates among sites (see the related gamma distance), equal nucleotide 
frequencies, and it does not correct for higher rate of transitional substitutions as compared to transversional substitutions.  The Jukes-Cantor model 
 
 
MEGA  provides facilities for computing the following quantities: 
d: Transitions + Transversions  : Number of nucleotide substitutions per site. 
L: No of valid common sites:  Number of sites compared. 
Formulas for computing these quantities are as follows: 
Distance  
 
where p is the proportion of sites with different nucleotides. 
 
Variance 
 
See also Nei and Kumar (2000), page 36. 
 
 
Tajima-Nei distance  
 In real data, nucleotide frequencies often deviate substantially from 0.25. In this case the Tajima-Nei distance (Tajima and Nei 1984) gives a better estimate of the number of 
nucleotide substitutions than the Jukes-Cantor distance. Note that this assumes an 
equality of substitution rates among sites and between transitional and transversional Molecular Evolutionary Genetics Analysis 
106 substitutions. 
 The Felsenstein-Tajima-Nei model 
 
 
MEGA  provides facilities for computing the following quantities for this method: 
d: Transitions + Transversions  : Number of nucleotide substitutions per site. 
L: No of valid common sites : Number of sites compared. 
Formulas for computing these quantities are as follows: 
Distance  
 
where p is the proportion of sites with different nucleotides and 
 
where xij is the relative frequency of the nucleotide pair i and j,  gi’s are the nucleotide 
frequencies. Variance 
 
 
See also Nei and Kumar (2000), page 38. 
  
Kimura 2-parameter distance  
Kimura’s two parameter model (1980) corrects for multiple hits, taking into account 
transitional and transversional substitution rates, while assuming that the four nucleotide 
frequencies are the same and that rates of substitution do not vary among sites (see related Gamma distance). 
The Kimura 2-parameter model 
 
 
MEGA 4  provides facilities for computing the following quantities: 
 Part IV:  Evolutionary Analysis 
107 Quantity  Description  
d: Transitions + 
Transversions Number of nucleotide substitutions per site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of trans versional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
Formulas for computing these quantities are as follows: 
Distances  
 
where P and Q are the frequencies of sites with transitional and transversional 
differences respectively, and 
 
Variances 
 
where 
 
 
See also Nei and Kumar (2000), page 37. 
 
Tamura 3-parameter distance  
Tamura’s 3-parameter model corrects for multiple  hits, taking into account differences in 
transitional and transversional rates and G+C-content bias (1992).  It assumes an Molecular Evolutionary Genetics Analysis 
108 equality of substitution rates among sites. 
 The Tamura 3-parameter model 
 
 
MEGA 4  provides facilities for computing the following quantities: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas for computing these quantities are as follows: 
Distances
 
 
where P and Q are the proportion of sites with transitional and transversional differences 
respectively, and  
 
Variances 
 Part IV:  Evolutionary Analysis 
109 where 
 
 
See also Nei and Kumar (2000), page 39. 
 
Tamura-Nei distance  
The Tamura-Nei model (1993) corrects for multiple hits, taking into account the 
differences in substitution rate between nucleotides and the inequality of nucleotide frequencies.  It distinguishes between transitional substitution rates between purines and transversional substitution rates between pyrimidines.  It also assumes equality of substitution rates among sites (see related gamma model). 
 
The Tamura-Nei model 
 
 
MEGA 4  provides facilities for computing the following quantities for this method: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of trans versional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas for computing these quantities are as follows: Distances
 
 Molecular Evolutionary Genetics Analysis 
110 where P1 and P2 are the proportions of transitional differences between nucleotides A 
and G, and between T and C, respectively, Q is the proportion of transversional 
differences, gA, gC, gG, gT, are the respective frequencies of A, C, G and T, gR = gA + gG, 
gY, = gT + gC, and 
 
Variances 
 
where 
 
 
See also Nei and Kumar (2000), page 40. 
  
Maximum Composite Likelihood Method  
A composite likelihood is defined as a sum of related log-likelihoods. Since all pair-wise 
distances in a distance matrix have correlations due to the phylogenetic relationships 
among the sequences, the sum of their log-li kelihoods is a composite likelihood. Tamura 
et al. (2004) showed that pair-wise distances and the related substitution parameters are 
accurately estimated by maximizing the composite likelihood. They also found that, unlike the cases of ordinary independent estimation of each pair-wise distance, a complicated model had virtually no disadvantage in the composite likelihood method for 
phylogenetic analyses. Therefore, only the Tamura-Nei (1993) model is available for this 
method in MEGA4 (see related Tamura-Nei distance). It assumes equality of substitution pattern among lineages and of substitution rates among sites (see related gamma model and heterogeneous patterns). 
 Part IV:  Evolutionary Analysis 
111  
Gamma Distances  
CCoommppuuttiinngg  tthhee  GGaammmmaa  PPaarraammeetteerr  ((aa))  
In the computation of gamma distances, it is necessary to know the gamma parameter 
(a).  This parameter may be estimated from the dataset under consideration or you may 
use the value obtained from previous studies.  For estimating a, a substantial number of 
sequences is necessary; if the number of sequences used is small, the estimate has a 
downward bias (Zhang and Gu 1998).  The current release of MEGA 4  does not contain 
any programs for estimating a; however we plan to make them available in the future.  
Therefore you need to use another program for estimating the a value.  Some of the 
frequently used programs that include this facility are PAUP* (Swofford 1998) for DNA 
sequences, PAML and PAMP programs for DNA and protein sequences (Yang 1999), and GAMMA programs from Gu and Zhang (1997). 
 
EEqquuaall  IInnppuutt  MMooddeell  ((GGaammmmaa))  
In real data, amino acid frequencies usually  vary among the different kinds of amino 
acids and substitution rates are not uniform among sites. In this case, the correction 
based on the equal input model gives a better estimate of the number of amino acid substitutions than the Poisson correction distance.  The rate variation among sites is 
modeled using the Gamma distribution; for computing this distance you will need to provide a gamma parameter ( a). 
 
MEGA  provides facilities for computing the following quantities: 
Quantity
 Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas used are: 
Distance  
 
where p is the proportion of different amino acid sites, a is the gamma parameter, gi is 
the frequency of amino acid i, and 
 
Variance 
 
 
 
JJuukkeess--CCaannttoorr  GGaammmmaa  ddiissttaannccee  
 
In the Jukes and Cantor (1969) model, the rate of nucleotide substitution is the same for Molecular Evolutionary Genetics Analysis 
112 all pairs of the four nucleotides A, T, C, and G.  The multiple hit correction equation for 
this model, which is given below, produces a maximum likelihood estimate of the number of nucleotide substitutions between two sequences, while relaxing the 
assumption that all sites are evolving at the same rate.  However, it assumes equal 
nucleotide frequencies and does not correct for higher rate of transitional substitutions as compared to transversional substitutions.  If the rate variation among sites is modeled 
using the Gamma distribution, you will need to provide a gamma parameter ( a) for 
computing this distance. The Jukes-Cantor model 
 
 
MEGA  provides facilities for computing the following p-distances and related quantities: 
 
d: Transitions + Transversions   : Number of nucleotide substitutions per site. 
L: No of valid common sites : Number of sites compared. 
 
The formulas for computing these quantities are as follows: 
Distance  
 
where p is the proportion of sites with different nucleotides and a is the gamma 
parameter. Variance 
 
See also Nei and Kumar (2000), page 36 and estimating gamma parameter. 
 
KKiimmuurraa  ggaammmmaa  ddiissttaannccee  
Kimura’s two-parameter gamma model correct s for multiple hits, taking into account 
transitional and transversional substitution rates and differences in substitution rates 
among sites.  Evolutionary rates among sites are modeled using the Gamma distribution, and you will need to provide a gamma parameter for computing this 
distance. 
 The Kimura 2-parameter model 
 
 
MEGA 4  provides facilities for computing the following quantities: Part IV:  Evolutionary Analysis 
113 Quantity  Description  
d: Transitions + 
Transversions Number of nucleotide substitutions 
per site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas for computing these quantities are as follows: Distances
 
 
where P and Q are the respective total frequencies of transition type pairs and 
transversion type pairs, a is the gamma parameter, and  
 
Variances 
 
where 
 
  
 
See also Nei and Kumar (2000), page 44 and estimating gamma parameter. Molecular Evolutionary Genetics Analysis 
114 TTaajjiimmaa  NNeeii  ddiissttaannccee  ((GGaammmmaa  rraatteess))  
In real data, nucleotide frequencies often deviate substantially from 0.25. In this case the 
Tajima-Nei distance (Tajima and Nei 1984) gives a better estimate of the number of 
nucleotide substitutions than the Jukes-Cantor distance. Note that this assumes an equality of substitution rates among sites and between transitional and transversional 
substitutions.  The rate variation among sites is modeled using the gamma distribution, and you will need to provide a gamma parameter ( a) for computing this distance. 
 
The Felsenstein-Tajima-Nei model 
 
 
MEGA  provides facilities for computing the following quantities for this method: 
d: Transitions + Transversions  : Number of nucleotide substitutions per site. 
L: No of valid common sites : Number of sites compared. 
The formulas for computing these quantities are as follows: 
Distance  
 
where p is the proportion of sites with different nucleotides, a is the gamma parameter, 
and  
 
where xij is the relative frequency of the nucleotide pair i and j,  gi’s are the nucleotide 
frequencies. Variance 
 
 
TTaammuurraa--NNeeii  ggaammmmaa  ddiissttaannccee  
 The Tamura-Nei (1993) distance with the gamma model corrects for multiple hits, taking 
into account the different rates of substitution between nucleotides and the inequality of 
nucleotide frequencies.  In this distance , evolutionary rates among sites are modeled 
using the gamma distribution.  You will need to provide a gamma parameter for 
computing this distance.  The Tamura-Nei model Part IV:  Evolutionary Analysis 
115 
 
 
MEGA 4  provides facilities for computing the following quantities for this method: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas for computing these quantities are as follows: 
Distances
 
 
where P1 and P2 are the proportions of transitional differences between nucleotides A 
and G, and between T and C, respectively, Q is the proportion of transversional 
differences, gA, gC, gG, gT, are the respective frequencies of A, C, G and T, gR = gA + gG, 
gY, = gT + gC, a is the gamma parameter and 
 
Variances  Molecular Evolutionary Genetics Analysis 
116 
 
where 
 
 
See also Nei and Kumar (2000), page 45 and estimating gamma parameter. 
 
TTaammuurraa  33--ppaarraammeetteerr  ((GGaammmmaa))  
Tamura’s 3-parameter model corrects for multiple hits, taking into account the differences in transitional and transversional rates and the G+C-content bias (1992).  
Evolutionary rates among sites are modeled using the gamma distribution, and you will 
need to provide a gamma parameter for computing this distance. 
 The Tamura 3-parameter model 
 
 
MEGA 4  provides facilities for computing the following quantities: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per 
site. 
v: Transversions only Number of transversional substitutions per 
site. 
R = s/v Transition/transversions ratio. Part IV:  Evolutionary Analysis 
117 L: No of valid common 
sites Number of sites compared. 
 
The formulas for computing these quantities are as follows: 
Distances  
 
where P and Q are the proportion of sites with transitional and transversional 
differences, respectively, a is the gamma parameter, and  
 
Variances 
 
where 
 
 
 
MMaaxxiimmuumm  CCoommppoossiittee  LLiikkeelliihhoooodd  ((GGaammmmaa  RRaatteess))  
The Tamura-Nei (1993) distance with the gam ma model estimated by the composite 
likelihood method (Tamura et al. 2004) corrects for multiple hits, taking into account the 
different rates of substitution between nucleotides and the inequality of nucleotide 
frequencies.  In this distance, evolutionary rates among sites are modeled using the 
gamma distribution.  You will need to provide a gamma parameter for computing this distance. See related Tamura-Nei gamma distance. 
 Molecular Evolutionary Genetics Analysis 
118 Heterogeneous Patterns  
TTaajjiimmaa  NNeeii  DDiissttaannccee  ((HHeetteerrooggeenneeoouuss  ppaatttteerrnnss))  
In real data, nucleotide frequencies often deviate substantially from 0.25. In this case the 
Tajima-Nei distance (Tajima and Nei 1984) gives a better estimate of the number of nucleotide substitutions than the Jukes-Cantor distance. Note that this assumes an equality of substitution rates among sites and between transitional and transversional substitutions. When the nucleotide frequencies are different between the sequences, the 
modified formula (Tamura and Kumar 2002) relaxes the assumption of substitution 
pattern homogeneity. 
 
The Felsenstein-Tajima-Nei model 
 
 
MEGA  provides facilities for computing the following quantities for this method: 
d: Transitions + Transversions  : Number of nucleotide substitutions per site. 
L: No of valid common sites : Number of sites compared. 
 
Formulas for computing these quantities are as follows: Distance
 
 
where p is the proportion of sites with different nucleotides and 
 
where xij is the relative frequency of the nucleotide pair i and j,  gi’s are the nucleotide 
frequencies. 
Variance can be estimated by the bootstrap method.  
TTaammuurraa  33  ppaarraammeetteerr  ((HHeetteerrooggeenneeoouuss  ppaatttteerrnnss))  
Tamura’s 3-parameter model corrects for multiple hits, taking into account the differences in transitional and transversional rates and the G+C-content bias (1992).  It 
assumes an equality of substitution rates among sites. When the G+C-contents are 
different between the sequences, the modified formula (Tamura and Kumar 2002) 
relaxes the assumption of substitution pattern homogeneity.  The Tamura 3-parameter model Part IV:  Evolutionary Analysis 
119 
 
 
MEGA 4  provides facilities for computing the following quantities: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas for computing these quantities are as follows: 
Distances
 
 
where P and Q are the proportion of sites with transitional and transversional 
differences, respectively, and  
 
The variances can be estimated by the bootstrap method. . 
 Molecular Evolutionary Genetics Analysis 
120 TTaammuurraa--NNeeii  ddiissttaannccee  ((HHeetteerrooggeenneeoouuss  PPaatttteerrnnss))  
The Tamura-Nei model (1993) corrects for multiple hits, taking into account the 
substitution rate differences between nucleotides and the inequality of nucleotide frequencies.  It distinguishes between transitional substitution rates between purines and 
transversional substitution rates between pyrimidines.  It assumes an equality of 
substitution rates among sites (see related gamma model). When nucleotide frequencies are different between the sequences, the modified formula (Tamura and Kumar 2002) relaxes the assumption of substitution pattern homogeneity.  The Tamura-Nei model 
 
 
MEGA 4  provides facilities for computing the following quantities for this method: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas for computing these quantities are as follows: Distances
 
 
where P1 and P2 are the proportions of transitional differences between nucleotides A 
and G, and between T and C, respectively, Q is the proportion of transversional 
differences, gXA, gXC, gXG, gXT, are the respective frequencies of A, C, G and T of 
sequence X, g XR = gXA + gXG and gXY = gXT + gXC, gA, gC, gG, gT, gR, and gY are the 
average frequencies of the pair of sequences, and Part IV:  Evolutionary Analysis 
121 
 
 
The variances can be estimated by the bootstrap method.  
 
MMaaxxiimmuumm  CCoommppoossiittee  LLiikkeelliihhoooodd  ((HHeetteerrooggeenneeoouuss  PPaatttteerrnnss))  
The Tamura-Nei distance (1993) estimated by  the composite likelihood method (Tamura 
et al. 2004) corrects for multiple hits, taking into account the substitution rate differences between nucleotides and the inequality of nucleotide frequencies. When the nucleotide frequencies between the sequences are different, the expected proportions of observed differences (P1, P2, and Q) in the computation of the composite likelihood can be 
obtained by the modified formulas according to Tamura and Kumar (2002) to relax the 
assumption of the substitution pattern homogeneity. See related Tamura-Nei distance 
(Heterogeneous Patterns). 
 
 
GGaammmmaa  RRaatteess  
Equal Input Model (Gamma rates and Heterogeneous Patterns) 
In real data, amino acid frequencies usually vary among different kind of amino acids.  
Therefore, the correction based on the equal input model gives a better estimate of the 
number of amino acid substitutions than t he Poisson correction distance. If you are 
computing the rate variation among sites using the Gamma distribution, you will need to 
provide a gamma parameter ( a). When the amino acid frequencies are different between 
the sequences, the modified formula (Tamura and Kumar 2002) relaxes the estimation 
bias. 
 
MEGA  provides facilities for computing the following quantities: 
Quantity  Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 Formulas used are: 
Distance
 
 
where p is the proportion of different amino acid sites, a is the gamma parameter, gXi is 
the frequency of amino acid i for sequence X, gi is the average frequency for the pair of 
the sequences, and Molecular Evolutionary Genetics Analysis 
122 
 
The variance of d can be estimated by the bootstrap method. 
 
 
Tajima Nei Distance (Gamma Rates and Heterogeneous patterns) 
In real data, nucleotide frequencies often deviate substantially from 0.25. In this case the Tajima-Nei distance (Tajima and Nei 1984) gives a better estimate of the number of nucleotide substitutions than the Jukes-Cantor distance. Note that this assumes an 
equality of substitution rates among sites and between transitional and transversional 
substitutions.  The rate variation among sites is modeled using the gamma distribution, and you will need to provide a gamma parameter ( a) for computing this distance. When 
the nucleotide frequencies are different between the sequences, the modified formula (Tamura and Kumar 2002) relaxes the assumption of substitution pattern homogeneity. 
 
The Felsenstein-Tajima-Nei model 
 
 
MEGA  provides facilities for computing the following quantities for this method: 
d: Transitions + Transversions  : Number of nucleotide substitutions per site. 
L: No of valid common sites : Number of sites compared. 
 
The formulas for computing these quantities are as follows: Distance
 
 
where p is the proportion of sites with different nucleotides, a is the gamma parameter, 
and  
 
where xij is the relative frequency of the nucleotide pair i and j,  gi’s are the nucleotide 
frequencies. 
Variance can be estimated by the bootstrap method.  
 
Tamura-Nei distance (Gamma rates and Heterogeneous patterns) 
The Tamura-Nei (1993) distance with the gamma model corrects for multiple hits, taking Part IV:  Evolutionary Analysis 
123 into account the rate substitution differences between nucleotides and the inequality of 
nucleotide frequencies.  In this distance , evolutionary rates among sites are modeled 
using the gamma distribution.  You will need to provide a gamma parameter for 
computing this distance. When the nucleotide frequencies between the sequences are 
different, the modified formula (Tamura and Kumar 2002) relaxes the assumption of the substitution pattern homogeneity.  The Tamura-Nei model 
 
 
MEGA 4  provides facilities for computing the following quantities for this method: 
 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversions ratio. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas for computing these quantities are as follows: Distances
 
 
where P1 and P2 are the proportions of transitional differences between nucleotides A 
and G, and between T and C, respectively, Q is the proportion of transversional 
differences, gXA, gXC, gXG, gXT, are the respective frequencies of A, C, G and T of 
sequence X, g XR = gXA + gXG and gXY = gXT + gXC, gA, gC, gG, gT, gR, and gY are the 
average frequencies of the pair of sequences, a is the gamma parameter and Molecular Evolutionary Genetics Analysis 
124 
 
The variances can be estimated by the bootstrap method.  
 
Tamura 3 parameter (Gamma rates and Heterogeneous patterns) 
Tamura’s 3-parameter model corrects for multiple hits, taking into account the 
differences in transitional and transversional rates and the G+C-content bias (1992).  
Evolutionary rates among sites are modeled using the gamma distribution, and you will need to provide a gamma parameter for computing this distance. When the G+C-
contents between the sequences are different, the modified formula (Tamura and Kumar 2002) relaxes the assumption of substitution pattern homogeneity.  
The Tamura 3-parameter model 
 
 
MEGA 4  provides facilities for computing the following quantities: 
Quantity  Description  
d: Transitions & 
Transversions Number of nucleotide substitutions per 
site. 
s: Transitions only Number of transitional substitutions per site. 
v: Transversions only Number of transversional substitutions per site. 
R = s/v Transition/transversion ratio. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas for computing these quantities are as follows: 
Distances
 Part IV:  Evolutionary Analysis 
125 
 
where P and Q are the proportion of sites with transitional and transversional 
differences, respectively, a is the gamma parameter, and  
 
The variances can be estimated by the bootstrap method. 
 
Maximum Composite Likelihood (Gamma  Rates and Heterogeneous Patterns) 
The Tamura-Nei (1993) distance estimated by  the composite likelihood method (Tamura 
et al. 2004) with the gamma model corrects for multiple hits, taking into account the rate 
substitution differences between nucleotides and the inequality of nucleotide frequencies.  In this distance, evolutionary rates among sites are modeled using the 
gamma distribution.  You will need to provide a gamma parameter for computing this 
distance. When the nucleotide frequencies between the sequences are different, the expected proportions of observed differences (P1, P2, and Q) in the computation of the composite likelihood can be obtained by the modified formulas according to Tamura and Kumar (2002) to relax the assumption of the substitution pattern homogeneity. 
 
AAmmiinnoo  AAcciidd  SSuubbssttiittuuttiioonn  MMooddeellss  
No. of differences (Amino acids)  
This distance is the number of sites at which two sequences being compared are 
different.  If the sequences contain alignment gaps or missing data and you are using the pair-wise deletion option, you must realize that this count does not normalize the 
number of differences based on the number of valid sites compared.  Therefore, if you 
use this distance, we recommend that you use the complete-deletion option.  MEGA  computes the following quantities: 
Quantity
 Description  
d: distance Number of sites 
different. 
L: No of valid common 
sites Number of sites 
compared. Molecular Evolutionary Genetics Analysis 
126 The formulas used are: 
Quantity  Formula  Variance  
 None 
 
 
See also Nei and Kumar (2000), page 18. 
 
p-distance (Amino acids)  
This distance is the proportion ( p) of amino acid sites at which the two sequences to be 
compared are different.  It is obtained by dividing the number of amino acid differences by the total number of sites compared.  It does not make any correction for multiple substitutions at the same site or differences in evolutionary rates among sites. 
 MEGA  provides facilities to compute the following quantities: 
Quantity
 Description  
d: distance Proportion of amino acid sites 
different. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas used are: 
Quantity  Formula  Variance  
 
  
  
where 
  is the number of amino acids that are different between two aligned 
sequences. 
 
See also Nei and Kumar (2000), page 18. 
  
Equal Input Model (Amino acids)  
In real data, frequencies usually vary among different kind of amino acids. In this case, 
the correction based on the equal input model gives a better estimate of the number of amino acid substitutions than the Poisson correction distance. Note that this assumes an 
equality of substitution rates among sites and the homogeneity of substitution patterns 
between lineages.  MEGA  provides facilities to compute the following quantities: 
Quantity
 Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 
The formulas used are: 
Distance  
 
where p is the proportion of different amino acid sites, gi is the frequency of amino acid i, 
and Part IV:  Evolutionary Analysis 
127 
 
Variance  
 
 
Poisson Correction (PC) distance  
 
The Poisson correction distance assumes equality of substitution rates among sites and 
equal amino acid frequencies while correcting for multiple substitutions at the same site.  
MEGA  provides facilities to compute the following quantities: 
Quantity
 Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 Formulas used are: 
Quantity
 Formula  Variance  
 
  
  
 
See also Nei and Kumar (2000), page 20. 
  
Dayhoff and JTT Models  
The PAM and JTT distances correct for multiple substitutions based on the model of amino acid substitution described as substitution-rate matrices. The PAM distance uses the PAM 001 matrix (p. 348 in Dayhoff 1979) and the JTT distance uses the JTT matrix (Jones et al. 1992). Using a substitution-rate matrix ( Q), the matrix ( F), which consists of 
the observed proportions of amino acid pairs between a pair of sequences with their 
divergence time t, is given by the following equation 
 
where A denotes the diagonal matrix of the equilibrium amino acid frequencies for Q. 
From this equation, the evolutionary distance d = 2tQ can be iteratively computed by a 
maximum-likelihood method. The eigen values for the PAM and JTT matrices required in 
this computation were obtained from the program source code of PHYLIP version 3.6 
(Felsenstein et al. 1993-2001). 
 
MEGA  provides facilities for computing the following quantities: 
Quantity  Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 Molecular Evolutionary Genetics Analysis 
128 The variance of d can be estimated by the bootstrap method. 
 
Gamma Distances  
CCoommppuuttiinngg  tthhee  GGaammmmaa  PPaarraammeetteerr  ((aa))  
In the computation of gamma distances, it is necessary to know the gamma parameter 
(a).  This parameter may be estimated from the dataset under consideration or you may 
use the value obtained from previous studies.  For estimating a, a substantial number of 
sequences is necessary; if the number of sequences used is small, the estimate has a 
downward bias (Zhang and Gu 1998).  The current release of MEGA 4  does not contain 
any programs for estimating a; however we plan to make them available in the future.  
Therefore you need to use another program for estimating the a value.  Some of the 
frequently used programs that include this facility are PAUP* (Swofford 1998) for DNA sequences, PAML and PAMP programs for DNA and protein sequences (Yang 1999), and GAMMA programs from Gu and Zhang (1997). 
 
DDaayyhhooffff  aanndd  JJTTTT  ddiissttaanncceess  ((GGaammmmaa  rraatteess))  
The PAM and JTT distances correct for multiple substitutions based on a model of 
amino acid substitution described as substitution-rate matrices. The PAM distance uses PAM 001 matrix (p. 348 in Dayhoff 1979) and the JTT distance uses JTT matrix (Jones et al. 1992). The matrix ( F) uses a substitution-rate matrix ( Q) and the gamma 
distribution with parameter a for the rate variation among sites.  It consists of the 
observed proportions of amino acid pairs with their divergence time t, given by the 
following equation 
 
where A denotes the diagonal matrix of the equilibrium amino acid frequencies for Q. 
From this equation, the evolutionary distance d = 2tQ can be computed iteratively by a 
maximum-likelihood method. The eigen values for the PAM and JTT matrices required in 
this computation were obtained from the program source code of PHYLIP version 3.6  
(Felsenstein et al. 1993-2001). 
 
MEGA  provides facilities for computing the following quantities: 
Quantity  Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 
The variance of d can be estimated by the bootstrap method. 
 
GGaammmmaa  ddiissttaannccee  ((AAmmiinnoo  aacciiddss))  
 
The Gamma distance improves upon the Poisson correction distance by taking care of Part IV:  Evolutionary Analysis 
129 the inequality of the substitution rates among sites.  For this purpose, you will need to 
provide the gamma shape parameter ( a). 
 
For estimating the Dayhoff distance, use a = 2.25 (see Nei and Kumar [2000], page 21 
for details).   
For computing Grishin’s distance, use a = 0.65. 23 (see Nei and Kumar [2000], page 23 
for details)   MEGA  provides facilities to compute the following quantities: 
Quantity
 Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas used are: 
Quantity  Formula  Variance  
 
 
  
 
See also Nei and Kumar (2000), page 23 and estimating gamma parameter. 
 
Heterogeneous Patterns  
EEqquuaall  IInnppuutt  MMooddeell  ((HHeetteerrooggeenneeoouuss  PPaatttteerrnnss))  
In real data, amino acid frequencies usually vary among different kinds of amino acids. 
In this case, a correction based on the equal input model gives a better estimate of the number of amino acid substitutions than does the Poisson correction distance. Note that 
this assumes an equality of substitution rates among sites. When the amino acid 
frequencies are different between the sequenc es, the modified formula (Tamura and 
Kumar 2002) relaxes the estimation bias.  MEGA  provides facilities for computing the following quantities: 
Quantity
 Description  
d: distance Number of amino acid substitutions 
per site. 
L: No of valid common 
sites Number of sites compared. 
 
Formulas used are: 
Distance  
 
where p is the proportion of different amino acid sites, gXi is the frequency of amino acid i 
for sequence X, gi is the average frequency for the pair of the sequences, and  
 
The variance of d can be estimated by the bootstrap method. Molecular Evolutionary Genetics Analysis 
130 SSyynnoonnyymmoouussee  aanndd  NNoonn--ssyynnoonnyymmoouuss  SSuubbssttiittuuttiioonn  MMooddeellss  
Nei-Gojobori Method  
This method computes the numbers of synony mous and non-synonymous substitutions 
and the numbers of potentially synonymous and potentially non-synonymous sites (Nei 
and Gojobori 1986).  Based on these estimates, MEGA  can be asked to produce the 
following quantities: 
 
Number of differences  (Sd or Nd) 
These are simple counts of the number of synonymous ( Sd) and non-
synonymous ( Nd) differences.  To compare these two numbers, you must use the 
p-distance because the number of potentia l synonymous sites is much smaller 
than the number of non-synonymous sites. 
  
p-distance  (pS or pN) 
The count of the number of synonymous differences ( Sd) is normalized using the 
possible number of synonymous sites ( S).  A similar computation can be made 
for non-synonymous differences. 
 
  Jukes-Cantor correction (dS or dN) 
The p-distances computed above can be corrected to account for multiple 
substitutions at the same site.  
 
Difference between synonymous and non-synonymous distances  
MEGA 4  can compute differences between the synonymous and non-
synonymous distances.  These statistics are useful in conducting tests for 
selection. 
 
 Number of Sites  (S or N) 
The numbers of potential synonymous and  non-synonymous sites can be 
computed using this option.  For each pair of sequences, the average number of 
synonymous or non-synonymous  sites is reported. 
 
The formulas for computing these quantities are:  Quantity
 Formula  Variance  
 
     
   
 
   
  
 
 
 
 
 
Dp 
  
  
Dd 
  
  
 
See also Nei and Kumar (2000), page 52 
 Part IV:  Evolutionary Analysis 
131 Nei-Gojobori Method  
This method computes the numbers of synony mous and non-synonymous substitutions 
and the numbers of potentially synonymous and potentially non-synonymous sites (Nei 
and Gojobori 1986).  Based on these estimates, MEGA  can be asked to produce the 
following quantities: 
 
Number of differences  (Sd or Nd) 
These are simple counts of the number of synonymous ( Sd) and non-
synonymous ( Nd) differences.  To compare these two numbers, you must use the 
p-distance because the number of potentia l synonymous sites is much smaller 
than the number of non-synonymous sites. 
  
p-distance  (pS or pN) 
The count of the number of synonymous differences ( Sd) is normalized using the 
possible number of synonymous sites ( S).  A similar computation can be made 
for non-synonymous differences. 
 
  Jukes-Cantor correction (dS or dN) 
The p-distances computed above can be corrected to account for multiple 
substitutions at the same site.  
 
Difference between synonymous and non-synonymous distances  
MEGA 4  can compute differences between the synonymous and non-
synonymous distances.  These statistics are useful in conducting tests for 
selection. 
 
 Number of Sites  (S or N) 
The numbers of potential synonymous and  non-synonymous sites can be 
computed using this option.  For each pair of sequences, the average number of 
synonymous or non-synonymous  sites is reported. 
 
The formulas for computing these quantities are:  
Quantity
 Formula  Variance  
 
     
   
 
   
  
 
 
 
 
 
Dp 
  
  
Dd 
  
  
 
See also Nei and Kumar (2000), page 52 
 
Modified Nei-Gojobori Method  
The modified Nei-Gojobori distance differs from the original Nei-Gojobori formulation in Molecular Evolutionary Genetics Analysis 
132 one way: transitional and transversional substitutions are no longer assumed to occur 
with the same frequency. Thus the user is requested to provide the Transition/Transversion ( R) ratio.  When R = 0.5, this method becomes identical to the 
Nei-Gojobori method.  When R > 0.5, the number of synonymous sites is less than 
estimated using Nei-Gojobori method and consequently, the number of non-synonymous 
sites will be larger than estimated with the original Nei-Gojobori (Nei and Gojobori 1986) approach. 
 
Number of differences
 (Sd or Nd) 
These are counts of the numbers of synonymous ( Sd) and non-synonymous ( Nd) 
differences.  To compare these two numbers you must use the p-distance 
because the number of potential synonymous sites is much smaller than the 
number of non-synonymous sites. 
  
p-distance  (pS or pN) 
The count of the number of synonymous differences ( Sd) is normalized using the 
number of potential synonymous sites ( S).  A similar computation can be made 
for non-synonymous differences. 
 
  Jukes-Cantor correction (dS or dN) 
The p-distances computed above can be corrected to account for multiple 
substitutions at the same site.  
 
Difference between synonymous and non-synonymous distances  
MEGA 4  can compute differences betw een synonymous an d non-synonymous 
distances.  These statistics are useful when conducting tests for selection. 
 
 Number of Sites  (S or N) 
Numbers of potentially synonymous and non-synonymous sites can be computed 
using this option.  For each pair of sequences, the average number of synonymous or non-synonymous  sites is reported. 
 
The formulas for computing these quantities are:  Quantit
y Formula  Variance  
 
     
    
 
   
  
 
  
  
 
  
 
 
  
  
D 
  
  
 
See also Nei and Kumar (2000), page 52. Part IV:  Evolutionary Analysis 
133  
Pamilo-Bianchi-Li Method  
 
This method (Pamilo and Bianchi 1993; Li 1993) is a modification of Li, Wu and Luo's method. The only difference concerns the allocation of 2-fold sites to synonymous and non-synonymous categories. Rather than assuming an equal transition and transversion 
rate, the rate is inferred from the observed number of transitions and transversions at the 
4-fold degenerate sites. Based on this information, the following quantities can be 
estimated:    
Synonymous distance
 
This is the number of synonymous s ubstitutions per synonymous site.  
  
Non-synonymous distance  
This is the number of non-synonymous substitutions per non-synonymous site.  
 
  Substitutions at the 4-fold degenerate sites ( d4) 
This is the number of substitutions per 4-fold degenerate site; it is useful for measuring the rate of neutral evolution. 
 
 Substitutions at the 0-fold degenerate sites ( d
0) 
This is the number of substitutions per 0-fold degenerate site; it is useful for 
measuring the rate of amino acid sequence evolution. 
 
 Number of 4-fold degenerate sites( L4) 
The estimate of the number of 4-fold degenerate sites, computed by averaging the number of 4-fold degenerate sites in the two sequences, compared. 
 
 Number of 0-fold degenerate sites ( L
0) 
The estimate of the number of 0-fold degenerate sites, computed by averaging 
the number of 0-fold degenerate sites in the two sequences, compared. 
 
Difference between synonymous an d non-synonymous distances ( D) 
This computes the differences betw een the synonymous and non-synonymous 
distances.  These statistics are useful for conducting tests of selection. 
 The formulas for computing these quantities are: 
 
Quantity
 Formula  Variance  
 
 
 
 
  
 
d4 
 
 Molecular Evolutionary Genetics Analysis 
134 d0 
 
 
D 
  
  
Ai 
  
 
Bi 
 
 
 
Here, 
 are the number of 0-fold, 2-fold and 4-fold degenerate sites, respectively. 
,   and   
, where  
,  
 , 
 , 
  
 
Pi and Qi are the proportions of i-fold degenerate sites that show transitional and 
transversional differences, respectively. 
 
, 
 
 
 
See also Nei and Kumar (2000), page 64.  
 
Kumar Method  
 
This method is a modification of the Pamilo-Bianchi-Li and Comeron (1995) methods and is able to handle some problematic degeneracy class assignments (see a detailed description below).  It computes the following quantities:    
Synonymous distance
 
This is the number of synonymous s ubstitutions per synonymous site.  
  
Non-synonymous distance  
This is the number of non-synonymous substitutions per non-synonymous site.  
 
  Substitutions at the 4-fold degenerate sites  
This is the number of substitutions per 4-fold degenerate site.  It is useful for 
measuring the rate of neutral evolution. 
  Substitutions at the 0-fold degenerate sites
 
This is the number of substitutions per 0-fold degenerate site.  It is useful for measuring the rate of amino acid sequence evolution.  Part IV:  Evolutionary Analysis 
135  Number of 4-fold degenerate sites  
This is the estimate of the number of 4-fold degenerate sites, computed by 
averaging the number of 4-fold degenerate sites in the two sequences, 
compared. 
 
 Number of 0-fold degenerate sites  
This is the estimate of the number of 0-fold degenerate sites, computed by 
averaging the number of 0-fold degenerate sites in the two sequences, 
compared. 
 
Difference between synonymous and non-synonymous distances  
This computes the differences betw een the synonymous and non-synonymous 
distances.  These statistics are useful for conducting tests of selection. 
 Kumar’s modification of the PBL method:
 
The treatment of arginine and isoleucine codons in the Li-Wu-Luo and the Pamilo-
Bianchi-Li methods is arbitrary, which sometimes creates a problem because the 
arginine codons occur quite frequently.  Comeron (1995) addressed this problem by 
dividing the 2-fold degenerate sites into two groups: 2S-fold and 2V-fold.  The 2S-fold refers to sites in which the transitional change is synonymous and the two transversional changes are non-synonymous, whereas the 2V-fold represents sites in which the 
transitional change is non-synonymous and the transversional changes are 
synonymous.  Although these definitions help in correcting some of the inaccurate classifications of synonymous and non-synony mous sites (e.g., methionine codons), 
they do not solve the problem completely.  For  example, consider mutations in the first 
nucleotide position of the arginine codon: CGG produces TGG (Trp), AGG (Arg), or 
GGG (Gly).  The transitional change (C to T) results in a non-synonymous change.  Of 
the two transversional substitutions, one (C to A) results in a synonymous change, while 
the other (C to G) results in a non-synonymous change.  Therefore, this nucleotide site is neither a 2S-fold nor a 2V-fold site.  Thus, the first position of three arginine codons (CGU, CGC, and CGA) and the third position of two isoleucine codons (ATT and ATC) cannot be assigned to any of the Comeron (1995) categories.  For this reason, Comeron 
(personal communication) used a more co mplicated classification of codons when he 
wrote his computer program. For example, the first position of arginine codon CGG was 
assigned to a 2V-fold site with a probability of one-third and to a 0-fold site with a 
probability of two-thirds.  Similar assignments are used by W.-H. Li (personal 
communication) in his computer program. 
Since the nucleotide site assignments discussed above are quite arbitrary and may not 
apply to all known genetic code tables, Kumar developed another method that uses the 
PBL method for any genetic code table.  In this version, nucleotide sites are first 
classified into 0-fold, 2-fold, and 4-fold degenerate sites.  The 2-fold degenerate sites are further subdivided into simple 2-fold and complex 2-fold degenerate sites.  Simple 2-fold sites are those at which the transitional change results in a synonymous substitution and 
the two transversional changes result in non-syn onymous substitutions.  All other 2-fold 
sites, including those for the three isoleucine codons, belong to the complex 2-fold site 
category.  If we use this definition, all nucleotide sites can be classified into the five 
groups shown in the following table. 
 Molecular Evolutionary Genetics Analysis 
136 Degeneracy  -> 0-fold  Simple 2-fold Complex 2-fold 4-fold  
No. of sites  -> L0 L2S L2C  L4 
   Syn Nonsyn   
Transition ( s) s0 s2 s2S s2N s4 
Transversion ( v) v0 V2 v2S v2N v4 
Here,  L0, L2S, L2C, and L4 are the numbers of 0-fold, simple 2-fold, complex 2-fold, and 4-
fold degenerate sites, respectively. 
 
Once this table is filled using the observed counts for a given pair of sequences, we 
compute the proportions of transitional ( Pi) and transversional (Q i) differences for the i-
fold degenerate site in the following way:  
 
 
  
       
  
 
  
From these quantities, we compute the Ai and Bi as in the PBL method.   Then using L2 
= L2C + L2S, we apply the formulas for the PBL method.  
 See also Nei and Kumar (2000), page 64.  
 
6.2.2 Specifying Distan ce Estimation Options 
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((DDiissttaannccee  CCoommppuuttaattiioonn))  
In this dialog box you can select and view the desired options in the Options Summary .  
Options are organized in logical sections. A lime square in the right-most cell in a row 
indicates that you have a choice regarding the attribute in that row The three primary sets of options available in this dialog box are: Analysis 
Compute
 
Use this to specify whether to compute Distances only  or Distances and 
Standard Errors .  If you select the latter, then you are given a choice as to how to 
compute it in the Standard Error Computation  box. 
Standard Error Computation By  
This row is visible only if you have chosen Distances and Std. Err in the Compute  
row.  You may choose to use analytical formulas or the bootstrap method to 
calculate standard errors depending on the type of distance computed.  
Whenever the standard errors are estimated by the bootstrap method, you will be 
prompted for the number of bootstrap replicates and a random number seed.   
When you compute average distance or diversity, only the bootstrap method is 
available for computing standard errors. Part IV:  Evolutionary Analysis 
137 Include Sites 
These are options for handling gaps or missing data, including or excluding 
codon positions, and restricting the analysis to labeled sites, if applicable.  
Gaps and Missing Data  
You may choose to remove all sites containing alignment gaps and missing 
information before the calculation begins (Complete-deletion option).  Alternatively, you may choose to retain all such sites initially, excluding them as necessary in the pair-wise distance estimation (Pair-wise-deletion option). 
Codon Positions
 
Click on the ellipses or the lime square, for the option of selecting any 
combination of 1st, 2nd, 3rd, and non-coding positions for analysis.  This option is 
available only if the nucleotide sequences  contain protein-coding regions and you 
have selected a nucleotide-by-nucleotide analysis. Labeled Sites
 
This option is available only if some or all of the sites have associated labels.  By clicking on the ellipses, you will be provided with the option of including sites with selected labels.  If you choose to include only labeled sites, then these sites will 
be the first extracted from the data.  Then all other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon 
must be included for a full codon to be incorporated in the analysis. 
Substitution Model 
In this set of options, you choose the various attributes of the substitution 
models.  
Model
 
Here you select a stochastic model for estimating evolutionary distance by clicking on the ellipses to the right of the currently selected model (click on the 
lime square to select this row first).  This will reveal a menu containing many 
different distance methods and models. 
Substitutions to Include  
Depending on the distance model or method selected, the evolutionary distance 
can be teased into two or more components.  By clicking on the drop-down 
button (first click on the lime square to select this row), you will be provided with 
a list of components relevant to the chosen model. Transition/Transversion Ratio
 
This option will be visible if the chosen model requires you to provide a value for the Transition/Transversion ratio (R). 
Pattern among Lineages
 
This option becomes available if the selected model has formulas that allow the 
relaxation of the assumption of homogeneity of substitution patterns among lineages. Rates among Sites
 
This option becomes available if the selected distance model has formulas that allow rate variation among sites.  If you choose gamma-distributed rates, then the Gamma parameter option becomes visible.  
 
 
DDiissttaannccee  MMooddeell  OOppttiioonnss  
With this option, you can choose the general attributes of the substitution models for 
DNA and protein sequence evolution. Molecular Evolutionary Genetics Analysis 
138 Model  
You can select a stochastic model for estimating evolutionary distances by clicking on 
the ellipses to the right of the currently selected model (click on the lime square to select 
this row first).  This will reveal a menu containing many different distance 
methods/models. Transition/Transversion Ratio
 
This option will be visible if the chosen model requires you to provide a value for the Transition/Transversion ratio (R). Pattern among Lineages
 
This option becomes available if the distance model you have selected has formulas that 
allow the relaxation of the assumption of homogeneity of substitution patterns among lineages. 
Rates among Sites
 
This option becomes available if the distance model you have selected has formulas that 
allow rate variation among sites.  If you choose gamma distributed rates, then the 
Gamma parameter option becomes visible. 
 
 
BBoooottssttrraapp  mmeetthhoodd  ttoo  ccoommppuuttee  ssttaannddaarrdd  eerrrroorr  ooff  ddiissttaannccee  eessttiimmaatteess  
When you choose the bootstrap method for estimating the standard error, you must 
specify the number of replicates and the seed for the pseudorandom number generator.  In each bootstrap replicate, the desired quantity is estimated and the standard deviation 
of the original values is computed (see Nei and Kumar [2000], page 25 for details).   
It is possible that in some bootstrap replicates the quantity you desire is not calculable for statistical or technical reasons.  In these cases, MEGA  will discard the results of the 
bootstrap replicates and its final estimate will be the results of all valid replicates.  This means that the number of bootstrap replicates used can be smaller than the number specified by the user.  However, if the number of valid bootstrap replicates is < 25, then 
MEGA  will report that the standard error cannot be computed (an "n/c" swill appear in 
the result window). 
 
6.3 Constructing Phylogenetic Trees 
6.3.1 Phylogenetic Inference 
Reconstruction of the evol utionary history of genes and species is currently one 
of the most important  subjects in molecular evolut ion. If reliable phylogenies are 
produced, they will shed light  on the sequence of evolutionary events that 
generated the present day diversity of genes and species and help us to 
understand the mechanisms of evolution as  well as the hist ory of organisms. 
Phylogenetic relationships of genes or organisms usually are presented in a 
treelike form with a root, which is called a rooted tree . It also is possible to draw a 
tree without a root, which is called an unrooted tree . The branching pattern of a 
tree is called a topology. 
There are numerous methods for construc ting phylogenetic trees from molecular 
data (Nei and Kumar 2000). They can be classified into Distance methods , Part IV:  Evolutionary Analysis 
139 Parsimony methods , and Likelihood methods .  These methods are explained in 
Swofford et al. 1996, Li (1997), Page and Holmes (1998), and Nei and Kumar 
(2000).  
 
6.3.2 NJ/UPGMA Methods 
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((NNJJ//UUPPGGMMAA))  
In this dialog box, you can view and select desired options in the Options Summary .  
Options are organized in logical sections.  A lime square in the right cell of a row 
indicates that you have a choice for that attribute.  The three primary sets of options available in this dialog box are: 
Phylogeny Test and Options 
To assess the reliability of a phylogenetic tree, MEGA  provides two different 
types of tests: the Bootstrap test  and the Interior branch test .  Both of these tests 
use the bootstrap re-sampling strategy, so you need to enter the number of 
replicates  and a starting random seed . For a given data set applicable tests and 
the phylogeny inference method are enabled.   
Include Sites 
These are options for handling gaps and missing data, including or excluding 
codon positions, and restricting the analysis to labeled sites, if applicable.  
Gaps and Missing Data
 
You may choose to remove all sites containing alignment gaps and missing-
information before the calculation begins using the Complete-deletion option.  Alternatively, you may choose to retain all such sites initially, excluding them as necessary using the Pair-wise-deletion option. 
Codon Positions
 
By clicking on the ellipses or the lime square, you may select any combination of 
1st, 2nd, 3rd, and non-coding positions for analysis.  This option is available only if 
the nucleotide sequences contain protein-coding regions and you have selected a nucleotide-by-nucleotide analysis. Labeled Sites
 
This option is available only if there are labels associated with some or all of the 
sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you chose to include only labeled sites, then these 
sites will be first extracted from the data and all other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon 
must be included for a full codon in the analysis. 
Substitution Model 
In this set of options, you can choose various attributes of the substitution models 
for DNA and protein sequences. Model
 
By clicking on the ellipses to the right of the currently selected model, you may 
select a stochastic model (method) for estimating evolutionary distance (click on 
the lime square to select this row first) .  This will reveal a menu containing many 
different distance methods and models. Substitutions to Include
 
Depending on the distance model or method selected, the evolutionary distance Molecular Evolutionary Genetics Analysis 
140 can be teased into two or more components.  By clicking on the drop-down 
button (first click on the lime square to select this row), you will be provided with 
a list of components relevant to the chosen model. 
Transition/Transversion Ratio  
This option will be visible if the chosen model requires you to provide a value for 
the Transition/Transversion ratio (R). Pattern among Lineages
 
This option becomes available if the selected model has formulas that allow the relaxation of the assumption of homogeneity of substitution patterns among 
lineages. 
Rates among Sites
 
This option becomes available if the selected distance model has formulas that 
allow rate variation among sites.  If you choose gamma-distributed rates, then 
the Gamma parameter option becomes visible. 
 
 
6.3.3 Minimum Evolution Method 
MMiinniimmuumm  EEvvoolluuttiioonn  
In the ME method, distance measures that correct for multiple hits at the same 
sites are used, and a topology showing t he smallest value of the sum of all 
branches ( S) is chosen as an estimate of t he correct tree.  However, the 
construction of a minimum evolution tree is  time-consuming because, in principle, 
the S values for all topologies must be evaluated. The number of possible 
topologies (unrooted trees) r apidly increases with the number of taxa so it 
becomes very difficult to examine all t opologies.  In this case, one may use the 
neighbor-joining method.  While the NJ tr ee is usually the same as the ME tree, 
when the number of taxa is  small the difference betw een the NJ and ME trees 
can be substantial (reviewed in Nei and Ku mar 2000).  In this case if a long DNA 
or amino acid sequence is used, the ME tree is preferable.  When the number of 
nucleotides or amino acids used is relati vely small, the NJ method generates the 
correct topology more often than does the ME method (Nei et al. 1998, 
Takahashi and Nei 2000). In MEGA , we have provided the close-neighbor-
interchange search to examine the neigh borhood of the NJ tree to find the 
potential ME tree. 
 
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((MMiinniimmuumm  EEvvoolluuttiioonn))  
In this dialog box you can select and view desired options in the Options Summary .  
Options are organized in logical sections.  A lime square in the right cell of a row 
indicates that you have a choice for that particular attribute.   The primary sets of options available in this dialog box are: 
Tree Inference 
Phylogeny Test and Options
 
To assess the reliability of a phylogenetic tree, MEGA  provides two different 
types of tests: the Bootstrap test  and the Interior branch test .  Both of these tests Part IV:  Evolutionary Analysis 
141 use the bootstrap re-sampling strategy, so you need to enter the number of 
replicates  and a starting random seed . For a given data set, applicable tests and 
the phylogeny inference method are enabled.   
 
Search Options  
This sets the extensiveness of the heuristic search for the Minimum Evolution 
(ME) tree.  MEGA  employs the Close-Neighbor-Interchange (CNI) algorithm for 
finding the ME tree.  It is a branch swapping method, which begins with an initial 
NJ tree. 
Include Sites 
These are options for handling gaps and missing data, including or excluding 
codon positions, and restricting the analysis to labeled sites, if applicable.  Gaps and Missing Data
 
You may choose to remove all sites containing alignment gaps and missing 
information before the calculation begins using Complete-deletion option.  Alternatively, you may choose to retain all such sites initially, excluding them as 
necessary using the (Pair-wise-deletion option). 
Codon Positions
 
By clicking on the ellipses or the lime square, you may select any combination of 
1st, 2nd, 3rd, and non-coding positions for analysis.  This option is available only if 
the nucleotide sequences contain protein-coding regions and you have selected 
a nucleotide-by-nucleotide analysis. 
Labeled Sites  
This option is available only if there are labels associated with some or all of the sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you chose to include only labeled sites, then these 
sites will be first extracted from the data and all other options mentioned above 
will be enforced.  Note that labels associated with all three positions in the codon 
must be included for a full codon in the analysis. 
Substitution Model 
In this set of options, you can choose various attributes of the substitution models 
for DNA and protein sequences. Model
 
By clicking on the ellipses to the right of the currently selected model, you may 
select a stochastic model for estimati ng evolutionary distance (click on the lime 
square to select this row first).  This w ill reveal a menu containing many different 
distance methods and models. 
Substitutions to Include  
Depending on the distance model or method selected, the evolutionary distance 
can be teased into two or more components.  By clicking on the drop-down 
button (first click on the lime square to select this row), you will be provided with 
a list of components relevant to the chosen model. Transition/Transversion Ratio
 
This option will be visible if the chosen model requires you to provide a value for the Transition/Transversion ratio (R). 
Pattern among Lineages
 
This option becomes available if the selected model has formulas that allow the 
relaxation of the assumption of homogeneity of substitution patterns among Molecular Evolutionary Genetics Analysis 
142 lineages. 
Rates among Sites  
This option becomes available if the selected distance model has formulas that 
allow rate variation among sites.  If you choose gamma-distributed rates, then 
the Gamma parameter option becomes visible. 
 
 
6.3.4 Maximum Parsimony (MP) Method 
BBrraanncchh--aanndd--BBoouunndd  aallggoorriitthhmm  
The branch-and-bound algorithm is used to fi nd all the MP trees.  It guarantees 
to find all the MP trees without co nducting an exhaustive search.  MEGA  also 
employs the Max-mini branch-and-bound sear ch, which is described in detail in 
Kumar et al. (1993) and Nei and Kumar (2000, page 123). 
 
AAlliiggnnmmeenntt  GGaappss  aanndd  SSiitteess  wwiitthh  MMiissssiinngg  IInnffoorrmmaattiioonn  
In MEGA , gap sites are ignored in the MP anal ysis, but there are two different 
ways to treat these sites. One is to delet e all of these sites from data analysis. 
This option, called the Complete-Deletion  option, is generally desirable because 
different regions of DNA or amino acid sequences often evolve under different 
evolutionary forces. However, if the num ber of nucleotides (or amino acids) 
involved in a gap is small and gaps are distributed more or less randomly, you 
may include all such sites and treat t hem as missing data. Therefore, gaps and 
missing data are never used in computing tree lengths in MEGA 4 . 
 
CCoonnsseennssuuss  TTrreeee  
The MP method produces many equally parsimonious trees.  Choosing this 
command produces a composite tree that is a consensus among all such trees, 
for example, either as a strict cons ensus, in which all conflicting branching 
patterns among the trees are resolved by making those nodes multifurcating or 
as a Majority-Rule consensus, in which conflicting branching patterns are resolved by selecting the pattern s een in more than 50% of the trees. 
 (Details are given in Nei and Kumar [2000], page 130). 
 
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((MMaaxxiimmuumm  PPaarrssiimmoonnyy))
  
This dialog box contains four overlapping pages, with each page marked by Tabs 
running across the top.  You can go to any page by simply clicking on the Tab.  Each tab 
page organizes a set of logically related options.  Information from all the pages is used in the requested analysis, so it is important that you examine the options selected in 
each tab before pressing OK to proceed with analysis. 
Phylogeny Test and Options 
To assess the reliability of the MP trees, MEGA  provides the bootstrap test.  You 
need to enter the number of replicates  and a starting random seed  for this test. Part IV:  Evolutionary Analysis 
143 Search Options 
Use this to select between the branch-and-bound and the heuristic (close-
neighbor interchange) searches.  For the branch-and-bound search, an optimized Max-mini branch-and-bound algorithm is used.  While this algorithm is 
guaranteed to find all the MP trees, a branch-and-bound search often is too time 
consuming for more than 15 sequences, although this number varies from data 
set to data set.  Alternatively, you may use the heuristic search (Close-Neighbor-
Interchange)., a branch swapping method that begins with a given initial tree.  You may automatically obtain a set of initial trees by using the Min-mini algorithm with a given search factor.  Alternatively, you can use the random addition option 
to produce the initial trees. 
Include Sites    
This provides options for handling gaps and missing data in the analysis, 
specifying inclusion and exclusion of codon positions, and restricting the analysis to only some types of labeled sites (if applicable).  
Gaps and Missing Data
 
You may choose to remove all sites containing alignment gaps and missing-
information before the parsimony analysis begins using the Complete-deletion option.  Alternatively, you may choose to retain all such sites.  In this case, all 
missing-information and alignment gap sites are treated as missing data in the calculation of tree length. 
Codon Positions
 
By clicking on the ellipses (or the lime square), you may select any combination 
of 1st, 2nd, 3rd, and non-coding positions for analys is.  This option is available only 
if the nucleotide sequences contain protein-coding regions.  If they do, you can 
choose between the analysis of nucleotide sequences or translated protein sequences.  If you choose the latter, MEGA  will translate all protein-coding 
regions into amino acid sequences and conduct the protein sequence parsimony 
analysis. Labeled Sites
 
This option is available only if there are labels associated with some or all of the 
sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you choose to include only labeled sites, then these 
sites will be the first extracted from the data and all other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon must be included for a full codon to be incorporated in the analysis. 
 
HHeeuurriissttiicc  SSeeaarrcchh  
Min-mini algorithm  
This is a heuristic search algorithm for finding the MP tree, and is somewhat 
similar to the branch-and bound search meth od.  However, in this algorithm, 
many trees that are unlikely to have a sm all local tree length are eliminated from 
the computation of their L values. Thus while the algorithm speeds up the search 
for the MP tree, as compared to the branch-and-bound search, the final tree or 
trees may not be the true MP tree(s).  The user can spec ify a search factor to 
control the extensiven ess of the search and MEGA  adds the user specified 
search factor to the current local upper bound.  Of course, the larger the search 
factor, the slower the search, since many more trees will be examined.   Molecular Evolutionary Genetics Analysis 
144  (See also Nei & Kumar (2000), pages 122, 125)  
 
Close-Neighbor-Interchange (CNI)  
In any method, examining all possible topolo gies is very time consuming.  This 
algorithm reduces the time spent search ing by first producing a temporary tree, 
(e.g., an NJ tree when an ME tree is bei ng sought), and then examining all of the 
topologies that are different  from this temporary tree by a topological distance of 
dT = 2 and 4.  If this is repeated many times, and all the topologies previously 
examined are avoided, one can usually obtain the tree being sought.   
For the MP method, the CNI search can start with a tree generated by the 
random addition of sequences.  This process can be repeated multiple times to 
find the MP tree. See Nei & Kumar (2000) for details.  
6.3.5 Statistical Test s of a Tree Obtained 
GGeenneerraall  CCoommmmeennttss  oonn  SSttaattiissttiiccaall  TTeessttss
  
There are two different types  of methods for testing the reliability of an obtained 
tree. One is to test t he topological difference betw een the tree and its closely 
related tree by using a certain quantity,  for example, the sum of all branch 
lengths in the minimum evolution method.   This type of test examines the 
reliability of every interior branch of the tree, and is generally a conservative test 
as compared to other tests included in MEGA .  
The other type of test exam ines the reliability of each interior branch whether or 
not it is significantly diffe rent from 0.  If a particu lar interior branch is not 
significantly different from 0, we cannot exclude the possibility of  a trifurcation of 
the associated branches or that the other  types of bifurcating trees can be 
generated by changing the splitting order of the three branches involved.  
Therefore, in MEGA  we implement the bootstrap pr ocedure for estimating the 
standard error of the interior branch and te st the deviation of the branch length 
from 0 (Dopazo 1994).   
The third type of test is the bootstrap te st, in which the reliability of a given 
branch pattern is ascertained by examin ing the frequency of its occurrence in a 
large number of trees, each bas ed on the re-sampled dataset. 
Details of these procedures are giv en in Nei and Kumar (2000, chapter 9). 
 
CCoonnddeennsseedd  TTrreeeess  
When several interior branches of a phyl ogenetic tree have low statistical support 
(PC or PB) values, it often is useful to produc e a multi-furcating tree by assuming 
that all interior branches have a branch length equal to 0. We call this multi-
furcating tree a condensed tree . In MEGA , condensed trees can be produced for 
any level of PC or PB value. For example, if t here are several branches with PC or 
PB values of less than 50%, a condensed tree with the 50% PC or PB level will Part IV:  Evolutionary Analysis 
145 have a multi-furcating tree with all it s branch lengths reduced to 0.  
Since branches of low significance are e liminated to form a condensed tree, this 
tree emphasizes the reliable portions of br anching patterns. However, this tree 
has one drawback. Since some branches are r educed to 0, it is difficult to draw a 
tree with proper branch lengths for the rema ining portion. Therefore we give our 
attention only to the topology so the branch lengths of a condensed tree in 
MEGA  are not proportional to the number  of nucleotide or amino acid 
substitutions. 
Note that, although they may look similar,  condensed trees are different from the 
consensus trees mentioned earlier. A c onsensus tree is produced from many 
equally parsimonious trees, whereas a condensed tree is merely a simplified 
version of a tree. A condensed tree can be produced for any type of tree (NJ, 
ME, UPGMA, MP, or ma ximum-likelihood tree).  
See also Nei and Kumar (2000) page 175. 
 
IInntteerriioorr  BBrraanncchh  TTeessttss  
Interior Branch Test of Phylogeny  
Phylogeny | Interior Branch Test of Phylogeny 
A t-test, which is computed using the bootstrap procedure, is constructed based on the 
interior branch length and its standard error and is available only for the NJ and 
Minimum Evolution trees.   MEGA  shows the confidence probability in the Tree Explorer; 
if this value is greater than 95% for a given branch, then the inferred length for that 
branch is considered significantly positive.    
See Nei and Kumar (2000) (chapter 9) for further details. 
 
Neighbor Joining (Construct Phylogeny)  
Phylogeny | Construct Phylogeny | Neighbor-Joining… 
This command is used to construct a neighbor-joining (NJ) tree (Saitou & Nei 1987).  
The NJ method is a simplified version of the minimum evolution (ME) method, which uses distance measures to correct for multiple hits at the same sites, and chooses a 
topology showing the smallest value of the sum of all branches as an estimate of the 
correct tree.  However, the construction of an ME tree is time-consuming because, in 
principle, the S values for all topologies have to be evaluated and the number of possible 
topologies (un-rooted trees) rapidly increases with the number of taxa.  
With the NJ method, the S value is not computed for all or many topologies. The 
examination of different topologies is imbedded in the algorithm, so that only one final 
tree is produced. This method does not require the assumption of a constant rate of 
evolution so it produces an un-rooted tree.  However, for ease of inspection,  MEGA  
displays NJ trees in a manner similar to rooted trees. The algorithm of the NJ method is somewhat complicated and is explained in detail in Nei and Kumar (2000).   For constructing the NJ tree, MEGA  may request that you specify the distance 
estimation method, subset of sites to include, and whether to conduct a test of the 
inferred tree through an Analysis Preferences dialog box. 
 Molecular Evolutionary Genetics Analysis 
146 BBoooottssttrraapp  TTeessttss  
Bootstrap Test of Phylogeny  
Phylogeny | Bootstrap Test of Phylogeny 
One of the most commonly used tests of the reliability of an inferred tree is Felsenstein's 
(1985) bootstrap test, which is evaluated using Efron's (1982) bootstrap re-sampling technique.  If there are m sequences, each with n nucleotides (or codons or amino 
acids), a phylogenetic tree can be reconstructed using some tree building method.  From 
each sequence, n nucleotides are randomly chosen with replacements, giving rise to m 
rows of n columns each.  These now constitute a new set of sequences.  A tree is then 
reconstructed with these new sequences using the same tree building method as before.  Next the topology of this tree is compared to that of the original tree.  Each interior branch of the original tree that is different from the bootstrap tree the sequence it partitions is given a score of 0; all other interior branches are given the value 1.  This procedure of re-sampling the sites and the subsequent tree reconstruction is repeated 
several hundred times, and the percentage of times each interior branch is given a value 
of 1 is noted.  This is known as the bootstrap value.  As a general rule, if the bootstrap value for a given interior branch is 95% or higher, then the topology at that branch is 
considered "correct".  See Nei and Kumar (2000) (chapter 9) for further details. This test is available for four different methods: Neighbor Joining, Minimum Evolution, 
Maximum Parsimony, and UPGMA. 
  
BBoooottssttrraapp  mmeetthhoodd  ttoo  ccoommppuuttee  ssttaannddaarrdd  eerrrroorr  ooff  ddiissttaannccee  eessttiimmaatteess  
When you choose the bootstrap method for estimating the standard error, you must 
specify the number of replicates and the seed for the pseudorandom number generator.  In each bootstrap replicate, the desired quantity is estimated and the standard deviation of the original values is computed (see Nei and Kumar [2000], page 25 for details).   
It is possible that in some bootstrap replicates the quantity you desire is not calculable 
for statistical or technical reasons.  In these cases, MEGA  will discard the results of the 
bootstrap replicates and its final estimate will be the results of all valid replicates.  This means that the number of bootstrap replicates used can be smaller than the number specified by the user.  However, if the number of valid bootstrap replicates is < 25, then 
MEGA  will report that the standard error cannot be computed (an "n/c" swill appear in 
the result window). 
 
6.3.6 Molecular Clock Tests 
TTaajjiimmaa''ss  TTeesstt  ((RReellaattiivvee  RRaattee))  
Phylogeny | Relative Rate Tests | Tajima’s Test 
Use this to conduct Tajima’s relative rate test (Tajima 1993), which works in the following 
way.  Consider three sequences, 1, 2 and 3, and let 3 be the out-group.  Let nijk be the 
observed number of sites in which sequences 1, 2 and 3 have nucleotides i, j and k.  
Under the molecular clock hypothesis, E( nijk)  =  E( njik) irrespective of the substitution 
model and whether or not the substitution rate varies with the site.  If this hypothesis is 
rejected, then the molecular clock hypothesis can be rejected for this set of sequences. 
In response to this command, you can select the three sequences for conducting 
Tajima’s test.  For nucleotide sequences, this test offers the flexibility of using only Part IV:  Evolutionary Analysis 
147 transitions, only transversions, or both.  If the data is protein coding, then you can 
choose to analyze translated sequences or any combination of codon positions by clicking on the ‘Data for Analysis’ button. 
 
See Nei and Kumar (2000) (page 193-196) for further description and an example.  
6.3.7 Handling Missing Data and Alignment Gaps 
AAlliiggnnmmeenntt  GGaappss  aanndd  SSiitteess  wwiitthh  MMiissssiinngg  IInnffoorrmmaattiioonn  
Gaps often are inserted during the alignment of homologous regions of sequences and 
represent deletions or insertions (indels). They introduce some complications in distance 
estimation. Furthermore, sites with missing information sometimes result from experimental difficulties; they present the same alignment problems as gaps. In the 
following discussion, both of these situations are treated in the same way. 
In MEGA , there are two ways to treat gaps. One is to delete all of these sites from the 
data analysis. This option, called the Complete-Deletion , is generally desirable because 
different regions of DNA or amino acid sequences evolve under different evolutionary forces. The second method is relevant if the number of nucleotides involved in a gap is small and if the gaps are distributed more or less randomly. In that case it may be possible to compute a distance for each pair of sequences, ignoring only those gaps that 
are involved in the comparison; this option is called Pair-wise-Deletion . The following 
table illustrates the effect of these options on distance estimation with the following three 
sequences:  
         1
       10         20  
seq1     A-AC-GGAT-AGGA-ATAAA 
seq2     AT-CC?GATAA?GAAAAC-A 
seq3     ATTCC-GA?TACGATA-AGA     Total sites = 20. 
Here, the alignment gaps are indicated with a hyphen (-) and the missing information 
sites are denoted by a question mark (?).  
Complete-Deletion  and Pair-wise-Deletion  options  
  Differences/Compariso
ns 
Option  Sequence Data  (1,2)  (1,3)  (2,3)  
Complete 
deletion 1.  A  C  GA  A GA A A A 
2.  A  C  GA  A GA A C A 
3.  A  C  GA  A GA A A A 1/10 0/10 1/10 
Pair-wise 
Deletion 1.  A-AC-GGAT-AGGA-ATAAA 
2.  AT-CC?GATAA?GAAAAC-A 
3.  ATTCC-GA?TACGATA-AGA 2/12 3/13 3/14 
In the above table, the number of compared sites varies with pair-wise comparisons in 
the Pair-wise-Deletion  option, but remains the same for pair-wise comparisons in the 
Complete-Deletion  option. In this data set, more information can be obtained by using 
the Pair-wise-Deletion  option. In practice, however, different regions of nucleotide or 
amino acid sequences often evolve differently, in which case, the Complete-Deletion  
option is preferable. 
 Molecular Evolutionary Genetics Analysis 
148  
AAlliiggnnmmeenntt  GGaappss  aanndd  SSiitteess  wwiitthh  MMiissssiinngg  IInnffoorrmmaattiioonn  
In MEGA , gap sites are ignored in the MP anal ysis, but there are two different 
ways to treat these sites. One is to del ete all of these sites from data analysis. 
This option, called the Complete-Deletion  option, is generally desirable because 
different regions of DNA or amino acid sequences often evolve under different 
evolutionary forces. However, if the num ber of nucleotides (or amino acids) 
involved in a gap is small and gaps are distributed more or less randomly, you 
may include all such sites and treat t hem as missing data. Therefore, gaps and 
missing data are never used in computing tree lengths in MEGA 4 . 
 
IInncclluuddee  SSiitteess  OOppttiioonn  
With this command you can set the options for handling gaps and missing data in the 
analysis, such as including or excluding codon positions, and restricting the analysis to 
only some types of labeled sites, if applicable.  Gaps and Missing Data
 
You may choose to remove all sites containing alignment gaps and missing information before the parsimony analysis begins (Complete-deletion option).  Alternatively, you may 
choose to retain all such sites.  In this case, all missing-information and alignment gap 
sites are treated as missing data in the calculation of tree length. Codon Positions
 
By clicking on the ellipses  (revealed by c licking on the lime-colored square), you will be 
provided with the option of selecting any combination of 1st, 2nd, 3rd, and non-coding 
positions for analysis.  This option is avail able only if the nucleotide sequences contain 
protein-coding regions.  If it does, you can choose between the analysis of nucleotide 
sequences or translated protein sequences.  If the latter is chosen, MEGA  will translate 
all protein-coding regions into amino acid sequences and conduct the protein sequence 
parsimony analysis. Labeled Sites
 
This option is available only if you have labels associated with some or all of the sites in 
the data.  By clicking on the ellipses, you will be provided with the option of including sites with selected labels.  If you choose to include only labeled sites, then these sites 
will be the first extracted from the data.  Then all other options mentioned above will be 
enforced.  Note that labels associated with all three positions in the codon must be included for a full codon to be incorporated in the analysis. 
 
 
6.4 Tests of Selection 
6.4.1 Synonymous/Non- synonymous Tests 
LLaarrggee  SSaammppllee  TTeessttss  ooff  SSeelleeccttiioonn  
One way to test whether positive selection is operating on a gene is to compare the 
relative abundance of synonymous and non-sy nonymous substitutions that have Part IV:  Evolutionary Analysis 
149 occurred in the gene sequences.  For a pair of sequences, this is done by first estimating 
the number of synonymous substi tutions per synonymous site ( dS) and the number of 
non-synonymous substitutions per non-synonymous site ( dN), and their variances: 
Var(dS) and Var( dN), respectively.  With this information, we can test the null hypothesis 
that H 0: dN = dS using a Z-test: 
 Z = ( dN - dS) / SQRT(Var( dS) + Var( dN)) 
The level of significance at which the null hypothesis is rejected depends on the alternative hypothesis (HA).  H
0:  dN = dS 
 HA:  (a) dN ≠ dS  (test of neutrality). 
(b) dN > dS  (positive selection). 
(c) dN < dS  (purifying selection). 
 For alternative hypotheses (b) and (c), we use a one-tailed test and for (a) we use a two-tailed test.  These three tests can be conducted directly for pairs of sequences, overall 
sequences, or within groups of sequences.  For testing for selection in a pair-wise 
manner, you can compute the variance of ( d
N - dS) by using either the analytical formulas 
or the bootstrap re-sampling method.  
For data sets containing more than two sequences, you can compute the average number of synonymous substitutions and the average number of non-synonymous 
substitutions to conduct a Z-test in manner similar to the one mentioned above.  The 
variance of the difference between these two quantities is estimated by the bootstrap method (Nei and Kumar [2000], page 56).  
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((ZZ--tteesstt  ooff  SSeelleeccttiioonn))  
In this dialog box, you can view and select options in the Options Summary.  Options are 
organized in logical sections.  A lime square in the right cell of a row indicates that you 
have a choice for that particular attribute.  The three primary sets of options available in 
this dialog box are:  
Analysis 
Test Hypothesis  
One way to test whether positive selection is operating on a gene is to compare 
the relative abundance of synonymous and non-synonymous substitutions within the gene sequences.  For a pair of sequences, this is done by first estimating the 
number of synonymous substitu tions per synonymous site ( d
S) and the number of 
non-synonymous substitutions per non-synonymous site ( dN), and their 
variances: Var( dS) and Var( dN), respectively.  With this information, we can test 
the null hypothesis that H 0: dN = dS using a Z-test: 
 Z = ( dN - dS) / SQRT(Var( dS) + Var( dN)) 
The level of significance at which the null hypothesis is rejected depends on the 
alternative hypothesis (HA): 
 H 0:  dN = dS 
 HA:  (a) dN ≠ dS  (test of neutrality). 
  (b) dN > dS  (positive selection). 
  (c ) dN < dS  (purifying selection). 
 
For alternative hypotheses (b) and (c), we use a one-tailed test and for (a) we use a two-tailed test.  These three tests can be conducted directly for pairs of Molecular Evolutionary Genetics Analysis 
150 sequences, overall sequences, or within groups of sequences.  For testing for 
selection in a pair-wise manner, you can compute the variance of ( dN - dS) by 
using either the analytical formulas or the bootstrap resampling method. 
For data sets containing more than two sequences, you can compute the 
average number of synonymous substi tutions and the average number of non-
synonymous substitutions to conduct a Z-test in a manner similar to the one 
mentioned above.  The variance of the difference between these two quantities 
can be estimated by the bootstrap method (Nei and Kumar [2000], page 56).   
 Analysis Scope  
Use this option to specify whether to conduct an analysis for sequence pairs, an 
overall average, or within sequence groups (if sequence groups are specified).   
Std. Err. Computation by  
Depending on the scope of the analysis (pair-wise versus other), you may 
compute standard errors using analytical formulas or the bootstrap method.  
Whenever standard errors are estimated by the bootstrap method, you will be 
prompted for the number of bootstrap replicates and a random number seed.   
When the selected test involves the computation of average distance, only the 
bootstrap method is available for computing standard errors. 
Include Sites 
These are options for handling gaps and missing data and restricting the analysis 
to labeled sites, if applicable.  
Gaps and Missing Data  
You may choose to remove all sites containing alignment gaps and missing 
information before the calculation begins (Complete-deletion option).  Alternatively, you may choose to retain all such sites initially, excluding them as necessary in the pair-wise distance estimation (Pair-wise-deletion option). 
Labeled Sites
 
This option is available only if there are labels associated with some or all of the 
sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you chose to include only labeled sites, they will be 
first extracted from the data and all of the other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon must be included for a full codon in the analysis. 
Substitution Model 
In this set of options, you can choose various attributes of the substitution models for DNA and protein sequences. Model
 
By clicking on the ellipses to the right of the currently selected model, you may 
select a stochastic model for estimati ng evolutionary distance (click on the lime 
square to select this row first).  This w ill reveal a menu containing many different 
distance methods and models. 
Transition/Transversion Ratio  
This option will be visible if the chosen model requires you to provide a value for the Transition/Transversion ratio (R). 
 
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((FFiisshheerr''ss  EExxaacctt  TTeesstt))  Part IV:  Evolutionary Analysis 
151 When the numbers of codons or the to tal numbers of synonymous and/or non-
synonymous substitutions are small, the large sa mple Z-test is too liberal in rejecting the 
null hypothesis.  In these cases, tests of selection can be conducted to examine the null 
hypothesis of the neutral evolution.  Only the Nei-Gojobori and Modified Nei-Gojobori 
methods can be used for this test because it requires the direct computation of the numbers of synonymous and non-synonymous  differences, and the number of 
synonymous and non-synonymous sites.  It should be used only when sequences show 
a small number of differences. To conduct Fi sher’s Exact Test, you need to specify two 
specific options: 
Analysis 
Test Hypothesis
 
This tests for positive selection ( dN > dS) and can only be computed for sequence 
pairs. 
Include Sites 
These options handle gaps and missing data and restrict the analysis to labeled 
sites, if applicable.  Gaps and Missing Data
 
You may choose to remove all sites containing alignment gaps and missing 
information before the calculation begins by using the Complete-deletion option.  
Alternatively, you may choose to retain all such sites initially, excluding them as 
necessary using the Pair-wise-deletion option. Labeled Sites
 
This option is available only if there are labels associated with some or all of the 
sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you chose to include only labeled sites, then these 
sites first will be extracted from the data then all other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon 
must be included for a full codon in the analysis. 
Substitution Model 
In this set of options, you choose various attributes of the substitution models for 
DNA and protein sequences. 
Model
 
By clicking on the ellipses to the right of the currently selected model, you may 
select a stochastic model for estimati ng evolutionary distance (click on the lime 
square to select this row first).  This will reveal a menu containing two different 
options: the original or modified Nei & Gojobori methods. 
Transition/Transversion Ratio  
This option will be visible if the chosen model requires you to provide a value for 
the Transition/Transversion ratio (R). 
  
AAnnaallyyssiiss  PPrreeffeerreenncceess  ((PPaatttteerrnn  HHoommooggeenneeiittyy  AAnnaallyyssiiss))  
In this dialog box, you can select and view options in the Options Summary .  Options 
are organized in logical sections and a lime square on the right cell in a row indicates that you have a choice for that particular attribute.  The two primary sets of options available in this dialog box are to compute the composition distance, disparity index, or to test the homogeneity of substitution pattern (Kumar and Gadagkar 2001). Molecular Evolutionary Genetics Analysis 
152 Calculate 
Use this to specify whether to compute Composition Distance , Disparity Index, 
or to test the homogeneity of evolutionary patterns.  If the test is selected, MEGA  
will conduct the Monte-Carlo analysis, fo r which you need to provide the number 
of replicates and a starting random seed. 
Include Sites 
These are options for handling gaps and missing data, including or excluding 
codon positions, and restricting the analysis to labeled sites (if applicable).  
Gaps and Missing Data  
You may choose to remove all sites containing alignment gaps and missing 
information before the calculation begins by using the Complete-deletion option.  
Alternatively, you may choose to retain all such sites initially, excluding them as 
necessary by using the Pair-wise-deletion option. Codon Positions
 
By clicking on the ellipses or the lime square, you may select any combination of 
1st, 2nd, 3rd, and non-coding positions for analysis.  This option is available only if 
the nucleotide sequences contain protein-coding regions and you have selected a nucleotide-by-nucleotide analysis.  If they do, you also can choose between the analysis of nucleotide sequences or translated protein sequences.  If the latter is 
chosen, MEGA  will translate all protein-coding regions into amino acid 
sequences and conduct the protein sequence analysis. 
Labeled Sites
 
This option is available only if there are labels associated with some or all of the 
sites in the data.  By clicking on the ellipses, you will have the option of including 
sites with selected labels.  If you chose to include only labeled sites, then these 
sites first will be extracted from the data and all other options mentioned above will be enforced.  Note that labels associated with all three positions in the codon must be included for a full codon in the analysis. 
  
6.4.2 Other Tests 
TTaajjiimmaa''ss  TTeesstt  ooff  NNeeuuttrraalliittyy  
Selection | Tajima’s Test of Neutrality 
This conducts Tajima’s test of neutrality ( Tajima 1989), which compares the number of 
segregating sites per site with the nucleotide diversity.   (A site is considered segregating 
if, in a comparison of m sequences, there are two or more nucleotides at that site; 
nucleotide diversity is defined as the average number of nucleotide differences per site 
between two sequences).  If all the alleles are selectively neutral, then the product 4Nv 
(where N is the effective population size and v is the mutation rate per site) can be 
estimated in two ways, and the difference in the estimate obtained provides an indication of non-neutral evolution.  Please see Nei and Kumar (2000) (page 260-261) for further 
description. 
   
153 7 Part V: Visualizing and Exploring Data and Results 
7.1 Distance Matrix Explorer 
7.1.1 Distance Matrix Explorer 
The Distance Matrix Explorer  is used to display results from the pair-wise distance 
calculations.  It is an intelligent viewer with the flexibility of altering display modes and 
functionalities and for computing within groups, among groups, and overall averages.  
This explorer consists of a number of regions as follows: Menu Bar
 
 File Menu  
 Display Menu   Average Menu  
Help: This button brings up the help file. 
Tool Bar
 
The tool bar provides quick access  to a number of menu items. 
• General Utilities 
• Lower-left Triangle button:  Click this icon to display pair-wise distances in 
the lower-left matrix.  If standard errors (or other statistics) are shown, they 
will be displayed in the upper-right. 
• Upper-right Triangle button:  Click this icon to display pair-wise distances in 
the upper-right matrix.  If standard errors (or other statistics) also are shown, 
they will be displayed in the lower-left. 
• (A, B):  This button is an on-off switch to write or hide the name of the 
highlighted taxa pair.  The taxa pair is displayed in the status bar below. 
• Distance Display Precision 
• 
  :  This decreases the precision of the distance display by one decimal 
place with each click of the button. 
• 
  :  This increases the precision of the distance display by one decimal 
place with each click of the button. 
• Column Sizer: This is a slider that increases or decreases the width of the columns showing the pair-wise distances. 
The 2-Dimensional Data Grid
 
This grid displays the pair-wise distances between taxa (or within groups etc.) in the 
form of a lower or upper triangular matrix.  The taxa names are the row-headers; the 
column headers are numbered from 1 to m, with m being the number of taxa.  There is a 
column sizer for the row-headers, so that you can increase or decrease the column size 
to accommodate the full name of the sequences or groups. 
• Fixed Row :  This is the first row in the data grid and displays the column number. 
• Fixed Column :  This is the first and leftmost column in the data grid.  This column is Molecular Evolutionary Genetics Analysis 
154 always visible even if you scroll past the initial screen.  It contains taxa names and 
an associated check box.  To include or exclude taxa from analysis, you can check or uncheck this box.  In this column, you can drag-and-drop taxa names to sort them. 
• Rest of the Grid :  Cells to the right of the first column and below the first row contain 
the nucleotides or amino acids of the input data.  Note that all cells are drawn in light color if they contain data corresponding to unselected sequences or genes and 
domains. 
Status bar
 
The left sub-panel shows the name of the statistic for the currently selected value.  In the 
next panel, the status bar shows the taxa-pair name for the selected value. 
 
7.1.2 Average Menu (in Di stance Matrix Explorer) 
With this menu, you can compute the following average values: 
Overall :  Computes and displays the overall average. 
Within groups :  This item is enabled only if at least one group is defined.  For each 
group, an arithmetic average is computed fo r all valid pair-wise comparisons and the 
results are displayed in the Distance Matrix Explorer .  All incalculable within-group 
averages are shown with an "n/c" in red. 
Between Groups :  This item is enabled only if at least two groups of taxa are defined.  
For each between-group average, an arithmetic average is computed for all valid inter-
group pair-wise comparisons and results are displayed in the Distance Matrix Explorer .  
All incalculable within-group averages are shown with an "n/c" in red. 
Net Between Groups :  This item is enabled only if at least two groups of taxa are 
defined.  It computes net average distances between groups of taxa.  This value is given 
by 
dA = dXY – (dX - dY)/2 
where dXY is the average distance between groups X and Y, and dX and dY are the mean 
within-group distances.   You must have at least two groups of taxa with a minimum of 
two taxa each for this option to work.  All incalculable within-group averages are shown with a red "n/c".
 
 
7.1.3 Display Menu (in Di stance Matrix Explorer) 
The display menu consists of four main commands: 
• Show Pair Name : This is a toggle to write or hide the name of the taxa pair 
highlighted, which is displayed in the status bar below. 
• Sort Taxa :  This provides a submenu for sorting the order of taxa in one of three 
ways: by input order, by taxon name or by group name. 
• Show Names : This is a toggle for displaying or hiding the taxa name. 
• Show Group Names :  This is a toggle for displaying or hiding the group name next 
to the name of each taxon, when available. 
• Change Font :  This brings up the dialog box that allows you to choose the type 
and size of the font for displaying the distance values. 
 Part V: Visualizing and Exploring Data and Results 
155 7.1.4 File Menu (in Dist ance Matrix Explorer) 
The file menu consists of three commands: 
• Show Input Data Title :  This displays the title of the input data. 
• Show Analysis Description:   This displays various options used to calculate the 
quantities displayed in the Matrix Explorer . 
• Export/Print Distances :  This brings up a dialog box for writing pair-wise distances 
as a text file, with a choice of several formats. 
• Quit Viewer : This exits the Distance Data Explorer . 
 
7.2 Sequence Data Explorer 
SSeeqquueennccee  DDaattaa  EExxpplloorreerr  
 
The Sequence Data Explorer  shows the aligned sequenc e data.  You can scroll 
along the alignment using t he scrollbar at the botto m right hand side of the 
explorer window.  The Sequence Data Explorer  provides a number of useful 
functionalities for exploring the statisti cal attributes of the data and also for 
selecting data subsets. 
 
This explorer consists of a number of regions as follows: 
Menu Bar  
Data menu 
Display menu 
Highlight menu 
Statistics menu  Help: This item brings up the help file for the Sequence Data Explorer . 
Tool Bar
 
The tool bar provides quick acce ss to the following menu items: 
• General Utilities 
• 
 : This brings up the Exporting Se quence Data dialog box, which 
contains options to control how MEGA  writes the output data. 
• Color: This brings up a color palette selection box with which you can 
choose the color to be displaye d in the highlighted sites.   
• 
: This brings up the dialog box for setting up and selecting domains 
and genes. 
• 
: This brings up the dialog box fo r setting up, editing, and selecting 
taxa and groups of taxa. 
• 
 : This toggle replaces the nucleoti de (amino acid) at a site with the 
identical symbol (e.g. a dot) if the site contains the same nucleotide Molecular Evolutionary Genetics Analysis 
156 (amino acid). 
• Highlighting Sites 
• C: If this button is pressed, then all constant sites will be highlighted.  
A count of the highlighted sites wi ll be displayed on the status bar. 
• V: If this button is pressed, then all variable sites will be highlighted.  
A count of the highlighted sites wi ll be displayed on the status bar. 
• Pi: If this button is pressed, then all parsimony-informative sites will 
be highlighted.  A count of the hi ghlighted sites will be displayed on 
the status bar. 
• S: If this button is pressed, then all singleton sites will be highlighted.  
A count of the highlighted sites wi ll be displayed on the status bar. 
• 0: If this button is pressed, then sites will be highlighted only if they 
are zero-fold degenerate sites in all sequences displayed.  A count of 
highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 2: If this button is pressed, then sites will be highlighted only if they 
are two-fold degenerate sites in all sequences displayed.  A count of highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 4: If this button is pressed, then sites will be highlighted only if they 
are four-fold degenerate sites in all s equences displayed.  A count of 
highlighted sites will be displayed on the status bar.  (This button is 
available only if the dataset cont ains protein coding DNA sequences). 
• 
 : This button provides the facility to translate 
codons in the sequence data into amino acid sequences and back.  All 
protein-coding regions will be automatic ally identified and translated for 
display.  When the translated seq uence is already displayed, then 
issuing this command displays t he original nucleotide sequences 
(including all coding and non-coding regions).  Depending on the data 
displayed (translated or nucleotid e), relevant menu options in the 
Sequence Data Explorer become enabled.  Note that the translated/un-
translated status in this data expl orer does not have any impact on the 
options for analysis available in MEGA  (e.g., Distances  or Phylogeny  
menus), as MEGA  provides all possible options  for your dataset at all 
times.  
The 2-Dimensional Data Grid  
Fixed Row :  This is the first row in the dat a grid.  It is used to display the 
nucleotides (or amino acids) in t he first sequence when you have chosen 
to show their identity using a spec ial character.  For protein coding 
regions, it also clearly marks t he first, second, and the third codon 
positions.  
Fixed Column :  This is the first and the leftm ost column in the data grid.  It Part V: Visualizing and Exploring Data and Results 
157 is always visible, even when you are scrolling through sites.  The column 
contains the sequence names and an associated check box.  You can 
check or uncheck this box to include or  exclude a sequence from analysis.  
Also in this column, you can dr ag-and-drop sequences to sort them. 
Rest of the Grid :  Cells to the right of and bel ow the first row contain the 
nucleotides or amino acids of the input data.  Note that all cells are drawn 
in light color if they  contain data corresponding to unselected sequences 
or genes or domains. 
Status Bar  
This section displays the location of the focused site and the total 
sequence length.  It also shows the site  label, if any, and a count of the 
highlighted sites. 
 
7.2.1 Data Menu 
Data Menu  
This allows you to explore the active data set, and establish various data attributes, and 
data subset options.  
Data Menu (in Sequence Data Explorer)  
This menu provides commands for wo rking with selected data in the Sequence 
Data Explorer  
The commands in this menu are: 
Write Data to File  Brings up the Exporting Sequence Data  dialog 
box. 
Translate/Untranslate  Translates protein-coding nucleotide 
sequences into protein sequences, and back 
to nucleotide sequences. 
Select Genetic Code 
Table  Brings up the Select Genetic Code  dialog box, 
in which you can select, edit or add a genetic 
code table. 
Setup/Select Genes 
and Domains  Brings up the Sequence Data Organizer , in 
which you can define and edit genes and 
domains.  
Setup/Select Taxa and 
Groups  Brings up the Select/Edit Taxa and Groups dialog, in which you can edit taxa and define 
groups of taxa.  
Quit Data Viewer  Takes the user back to the main interface. 
 Molecular Evolutionary Genetics Analysis 
158 Translate/Untranslate (in Sequence Data Explorer)  
Data | Translate/Untranslate 
This command is available only if t he data contain protei n-coding nucleotide 
sequences.  It automatically extracts a ll protein-coding domains for translation 
and displays the corresponding protein sequ ence.  If the translated sequence is 
already displayed, then issuing this command displays the original nucleotide 
sequences, including all c oding and non-coding regions.  Depending on the data 
displayed (translated or nucleotide), rele vant menu options in the Sequence Data 
Explorer are enabled.  However, transla ted and un-translated status does not 
have any impact on the analytical options available in MEGA  (e.g., Distances  or 
Phylogeny  menus), as MEGA  provides all possible options  for your dataset at all 
times.  
 
Select Genetic Code Table (in Sequence Data Explorer)  
Data | Select Genetic Code Table 
Select Genetic Code Table, can be in voked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Setup/Select Taxa & Groups (in Sequence Data Explorer)  
Data | Setup/Select Taxa & Groups  
Setup/Select Taxa & Groups, can be in voked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Setup/Select Genes & Domains (in Sequence Data Explorer)  
Data | Setup/Select Genes & Domains 
Setup/Select Genes & Domains, can be in voked from within the Data menu in 
Sequence Data Explorer, and is also available in the main interface directly in the 
Data  Menu. 
 
Export Data (in Sequence Data Explorer)  
Data | Export Data 
The Exporting Sequence Data  dialog box first displays an edit box for entering a 
title for the sequence data bei ng exported.  The default name is the original name 
of the data set, if there wa s one.  Below the title is a space for entering a brief 
description of the data set being exported.   
Next is the option for det ermining the format of the data set being exported; 
MEGA  currently allows the us er to export the data in MEGA , PAUP 3.0 and 
PAUP 4.0 (Nexus, Interleaved in both case s), and PHYLIP 3.0 (Interleaved).  tA 
the end of each line, is "Wri ting site numbers." The three options available are to Part V: Visualizing and Exploring Data and Results 
159 not write any number, to write one for each site, or to writ e the site number of the 
last site. 
Other options in this dialog box include t he number of sites per line, which codon 
position(s) is to be used and whether non-coding regions should be included, and 
whether the output is to be interleav ed.  For missing or ambiguous data and 
alignment gaps, there are four options: in clude all such data, exclude all such 
data, exclude or include sites with mi ssing or ambiguous data only, and exclude 
sites with alignment gaps only. 
 
Quit Data Viewer  
Data | Quit Data Viewer 
This command closes the Sequence Data Explorer, and takes the user back to 
main interface. 
 
7.2.2 Display Menu 
Data Menu (in Sequence Data Explorer)  
This menu provides commands for wo rking with selected data in the Sequence 
Data Explorer  
The commands in this menu are: 
Write Data to File  Brings up the Exporting Sequence Data  dialog 
box. 
Translate/Untranslate  Translates protein-codi ng nucleotide sequences 
into protein sequences, and back to nucleotide 
sequences. 
Select Genetic Code 
Table  Brings up the Select Genetic Code  dialog box, in 
which you can select, edit or add a genetic code 
table. 
Setup/Select Genes 
and Domains  Brings up the Sequence Data Organizer , in which 
you can define and edit genes and domains.  
Setup/Select Taxa and Groups  Brings up the Select/Edit Taxa and Groups dialog, in which you can edit taxa and define 
groups of taxa.  
Quit Data Viewer  Takes the user back to the main interface. 
 
Restore Input Order
 
Display | Restore Input Order 
Choosing this restores the or der in Sequence Data Explor er to that in the input 
text file. 
 Molecular Evolutionary Genetics Analysis 
160 Show Only Selected Sequences  
Display | Show only Selected Sequences 
The check boxes in the left column of the display grid can be used to select or 
deselect sequences for analysis.  Subseq uent use of the "Show Only Selected 
Sequences" option in the Display menu of  Sequence Data Explorer hides all the 
deselected sequences and displa ys only the selected ones. 
 
Color Cells  
Display | Color cells 
This command colors individual cells in  the two-dimensional display grid 
according to the nucleotide or amino acid  it contains.  A list of default colors, 
based on the biochemical properties of the residues, is given below.  In a future 
version, these colors will be customizable by the user.  
 
For DNA sequences:  
Symbo
l Color  
A Yellow 
G Fuchsia 
C Olive 
T Green 
U Green 
 For amino acid sequences:
 
Symbo
l Color   Symbo
l Color  
A Yellow  M Yellow 
C Olive  N Green D Aqua  P Blue 
E Aqua  Q Green 
F Yellow  R Red 
G Fuchsi
a  S Green 
H Teal  T Green 
I Yellow  V Yellow 
K Red  W Green 
L Yellow  Y Lime 
  
Use Identical Symbol
 
Display | Use Identical Symbol 
Data that contain multiple aligned sequences  may be easier to view if, when the 
nucleotide (amino acid) is the same as that  in the corresponding site in the first Part V: Visualizing and Exploring Data and Results 
161 sequence, the nucleotide (amino acid) is r eplaced by a dot.  Choosing this option 
again brings back the nucleotide (amino acid) single-letter codes. 
 
Show Sequence Names  
Display | Show Sequence Names 
This option displays the full sequenc e names in Sequence Data Explorer   
 
Show Group Names  
Display | Show Group Names 
This option displays the full group names  in Sequence Data Explorer if the 
sequences have been grouped in Select/Edit Taxa Groups 
 
Change Font...  
Display | Change Font… 
This command brings up the Change Font  dialog box, which allows you to 
change the display font, including font type, style and size.  Options to strikeout 
or underline selected parts of the sequences are also available.  There is also an 
option for using different scripts, although the only option currently available is 
"Western".  Finally the "Sample" window displays the effects of your choices  
 
Sort Sequences  
Display | Sort Sequences 
The sequences in the data set can be sorted based on several options: 
sequence name, group name, gr oup and sequence names, or as per the order in 
the Select/Edit Taxa Groups dialog box.  
Sort Sequences by Group Name
 
Display | Sort Sequences | By Group Name 
Sequences that have been gr ouped in Select/Edit Taxa Groups can be sorted by 
the alphabetical order of group names or numerical or der of group ID numbers.  
If the group names contain both a name and a number, the numerical order will 
be nested within the alphabetical order. 
 
Sort Sequences by Group and Sequence Names  
Display | Sort Sequences | By Group and Sequence Names  
Sequences that have been gr ouped in Select/Edit Taxa Groups can be sorted by 
the alphabetical order of group names or the numerical order of group ID 
numbers.  If the group names contain both a nam e and a number, the numerical 
order is nested within t he alphabetical order.  The sequences can be further 
arranged by sorting the sequence names within the group names. Molecular Evolutionary Genetics Analysis 
162 Sort Sequences As per Taxa/Group Organizer  
Display | Sort Sequences | As per Taxa/Group Organizer 
The sequence/group order seen in Select/Edi t Taxa Groups is initially the same 
as the order in the input text file.  However, this order can be changed by 
dragging-and-dropping.  Choose this option if you wish to see the data in the 
same order in the Sequence Data Explorer as in Select/Edit Taxa Groups . 
 
Sort Sequences By Sequence Name  
Display | Sort Sequences | By Sequence Name 
The sequences are sorted by the alphabet ical order of sequence names or the 
numerical order of sequence ID numbers.  If the sequenc e names contain both a 
name and a number, then the sorting is done with the numerical order nested 
within the alphabetical order. 
 
7.2.3 Highlight Menu 
Highlight Menu (in Sequence Data Explorer)  
This menu can be used to highlight certai n types of sites.  The options are 
constant sites, variable sites, parsimony-inf ormative sites, singl eton sites, 0-fold, 
2-fold and 4-fold degenerate sites. 
 
Highlight Conserved Sites  
Highlight | Conserved Sites 
Use this command to high light constant sites  
 
Highlight Variable Sites  
Highlight | Variable Sites 
Use this command to highli ght variable sites sites. 
 
Highlight Singleton Sites  
Highlight | Singleton Sites 
Use this command to high light singleton sites. 
 
Highlight Parsimony Informative Sites  
Highlight | Parsim-Info Sites 
Use this command to highlight pa rsimony-informative sites.  
 Part V: Visualizing and Exploring Data and Results 
163 Highlight 0-fold Degenerate Sites  
Highlight | 0-fold  Degenerate Sites 
Use this command to highlight  0-fold degenerate  sites. 
 
Highlight 2-fold Degenerate Sites  
Highlight | 2-fold  Degenerate Sites 
Use this command to highlight 2-fold degenerate sites. The command is visible 
only if the data consists of nucleotide sequences. 
 
Highlight 4-fold Degenerate Sites  
Highlight | 4-fold  Degenerate Sites 
Use this command to highlight 4-fold degenerate sites. The command is visible 
only if the data consists of nucleotide sequences. 
 
7.2.4 Statistics Menu 
Statistics Menu (in Sequence Data Explorer)  
Various summary statistics of the sequences can be computed and displayed 
using this menu.  The commands are: 
Nucleotide Composition. 
Nucleotide Pair Frequencies. Codon Usage. Amino Acid Composition. 
Use All Selected Sites. 
Use only Highlighted Sites.  Sites c an be selected according to various 
criteria (see Highlight Sites), and analysis can be performed only on the 
chosen subset of sites. 
 
Nucleotide Composition
 
Statistics | Nucleotide Composition 
This command is visible only if the dat a consist of nucleotide sequences.  MEGA  
computes the base frequencies for each sequenc e as well as an overall average.  
These will be displayed by domain in a Te xt Editor domain (if the domains have 
been defined in Setup/Select Genes & Domains). 
 
Nucleotide Pair Frequencies  
Statistics | Nucleotide Pair Frequencies 
This command is visible only if the data c onsists of nucleotide sequences.  There 
are two options available: one in which the nucleotide acid pairs are counted bi-
directionally site-by-site for the two sequences (giving rise to 16 different Molecular Evolutionary Genetics Analysis 
164 nucleotide pairs), the other, in which t he pairs are counted unidirectionally (10 
nucleotide pairs).  MEGA  will compute the frequencies of these quantities for 
each sequence as well as an overall average.  They will be displayed in a Text 
Editor domain by domain (if domains have been defined in Setup/Select Genes & 
Domains). 
 
Codon Usage  
Statistics | Codon Usage 
This command is visible only if the dat a contains protei n-coding nucleotide 
sequences.  MEGA 4  computes the percent c odon usage and the RCSU values 
for each codon for all sequences included in the dataset.  Results will be 
displayed in a Text Editor domain (if domains have been defined in Setup/Select 
Genes & Domains). 
 
Amino Acid Composition  
Statistics | Amino acid Composition  
This command is visible only if the data c onsists of amino acid sequences or if 
the translated protein coding nucleot ide sequences are displayed.  MEGA  will 
compute the amino acid frequencies for each sequence as well as an overall 
average, which will be displayed in a Te xt Editor domain (if domains have been 
defined in Setup/Select  Genes & Domains). 
 Use All Selected Sites
 
Statistics | Use All Selected Sites  
Analysis is conducted on all sites in the sequences, irrespective of whether any 
sites have been labeled or highlighted. 
 
Use only Highlighted Sites  
Statistics | Use only Highlighted Sites 
Sites can be selected according to various  criteria (see Highlight Sites), and 
analyses will be performed only on the chosen s ubset of sites.  All statistical 
attributes will be based on these sites. 
 
7.3 Tree Explorer 
7.3.1 Tree Explorer 
Phylogeny | Any tree-building option 
The Tree Explorer  displays the evolutionary tree based on the options used to 
compute or display the phyl ogeny.  The main menu of the Tree Explorer  has the 
following items: Part V: Visualizing and Exploring Data and Results 
165 File Menu  
Image Menu  Sub-tree Menu  
View Menu  
Compute Menu  
 
7.3.2 Information Box 
The information box in the Tree Explorer  lists the various statistical attributes of 
the displayed tree with the branch or node highlighted.  It usually contains 
multiple tabs. 
General:  This reminds the user of the number  of taxa (and groups, if any) and of 
the strategy used to deal with gaps and missing data.  Tree:   This contains information about the type of tree –r ooted/unrooted, and the 
sum of branch lengths, SBL, or the tree- length.  In addition,  information about the 
total number of trees and t he tree number of the curr ent tree is displayed. 
Branch:    In the Tree Explorer  window you may click on a branch or on a node of 
the tree.  If you click on a branch, this t ab displays its location in terms of the two 
nodes it connects.  (Leaf taxa are numbered in the order in which they appear in 
the input data file.)  This window also di splays the length of the selected branch.  
If you click on a node, the inte rnal identification number of  that node is displayed. 
 
 
7.3.3 File Menu (in Tree Explorer) 
This menu has the following options: 
Save Current Session : This brings up the Save As  dialog box and saves all the 
information currently held by the Tree Explorer  to a file in a binary format.  This 
feature allows you to retrieve the current Tree Explorer session for tree 
manipulation and printing.   
Export Current Tree (Newick) : This writes the topology of  the current tree in the 
MEGA  tree format to a specified file.  No te that only the branching pattern is 
stored.  
Export All Trees (Newick) :  This writes the topologies  of all trees in the MEGA  
tree format to a specified file. Note t hat only the branching pattern is stored. 
Show Information :  This brings up the Information dialog box. 
Print : This brings up the Print dialog box and prints th e current tree in the 
displayed size; if the displayed tree is larger than the page size , it will be printed 
on multiple pages.  
Print in a sheet : This brings up the Print dialog box and prints  the current tree, 
after restricting the size of the printed tree to one sheet. The current tree also can 
be printed using the button on the toolbar. Printer Setup : This allows the user to setup the printer.   
Exit Tree Explorer : This exits the Tree Exp lorer. 
  Molecular Evolutionary Genetics Analysis 
166 7.3.4 Image Menu (in Tree Explorer) 
The image menu contains three options: 
Copy to Clipboard : This copies the tree image to the clipboard, which can also 
be done by simultaneously pressing Ctrl and ‘C’ keys. You then can paste the 
copied image into any other Windows applic ation (e.g., PowerPoint and Word). 
Save as Enhanced metafile :  This option saves the image as an enhanced 
windows metafile ( .EMF ).  It brings up the Save As  dialog box to specify the 
filename. 
Save as TIFF:  This option saves the tree image as Tagged Image File Format 
(TIFF) with 400dpi resolution and without LZW compression. TIFF is a popular 
raster graphics format widely supported by  image-manipulation software such as 
Adobe Photoshop. Note that one cannot edit each tree part in this format as in 
the cases of EMF and PDF, while the graphics quality and cross-platform 
compatibility are better. Also, users should no tice that the file size is much larger 
than EMF and PDF and it usually becomes tens or hundreds of mega bytes. It 
brings up the Save As dialog box to specify the filename. 
 
Loan Taxon Images :  This option automatically  associates images to each 
taxon.  To use it, you will be prompted fo r the directory where the bitmap images 
(in BMP format) reside.  For each ta xon, the image file  must have a BMP 
extension and the filename mu st be identical to the ta xon name displayed in the 
Tree Explorer .  All of the valid images t hat are found will be retrieved and 
displayed. 
 
7.3.5 Subtree Menu (in Tree Explorer) 
This menu contains the tree mani pulation options Swap, Flip and 
Compress/Expand.  In addition, by cli cking on the corresponding items in the 
menu (for which there are tool  buttons on the left), you c an specify the root of the 
tree, and display a subtree (a portion of  the tree defined by a given internal 
branch) in a separate window.   
Choosing ‘Divergence Time’ transforms the cu rsor to an arrow below which is the 
icon associated with the divergence time opt ion.  To obtain the evolutionary rate 
of a specific lineage, you s hould point the cursor to that  branch and click.  On the 
other hand, if you are interested in the av erage evolutionary rate of a cluster of 
two or more taxa, then you should cli ck at the node at the common ancestor of 
the cluster.  Either way, MEGA  brings up the Divergence Time dialog box, which 
displays the evolutionary rate info rmation for a given divergence time. 
Many of these functionalities are also avai lable through tools in the toolbar on the 
left side of the displayed tree.  
7.3.6 Subtree Drawing Options (in Tree Explorer) 
This dialog box provides choices options for changing various visual attributes for the 
selected subtree. If the Overwrite Downstream option is checked, any subtree drawing Part V: Visualizing and Exploring Data and Results 
167 options that have been applied to downstream nodes within the current subtree will be 
overwritten. 
Property Tab: 
Name/Caption: This section allows y ou to provide an alphanumeric caption for 
the selected node. 
Node/Subtree Marker: This  section provides elements for changing the shape 
and color of the selected s ubtree node marker. If the Apply to Taxon Markers 
option is checked, the se lected shape and color options will be applied to all 
taxon markers contained within the subtree.  
Branch Line: This section provides vari ous drawing options that will be applied to 
the branch lines of t he selected subtree.  
Display Tab: 
Display Caption: If checked, the node capt ion, if set within t he Property Tab, will 
be displayed.  
Display Bracket: If checked, this item will display a bracket that encompasses the 
selected subtree using the conf igured bracket drawing options. 
Display Taxon Names: If checked, the taxon names attributed to the leaf nodes 
will be displayed. 
Display Node Markers: If checked, any node markers that were configured within 
the Property Tab will be displayed.  Display Taxon Markers: If checked, any  taxon markers that were configured 
within the Property Tab will be displayed.  Compress Subtree: If checked, the selected subtree will be compressed and 
rendered as a graphical vector according to the configured drawing options. 
Image Tab: 
Display Image: If checked, the Tree Expl orer will display an im age, if loaded, at 
the configured position relative to the subtree node caption text. 
7.3.7 Cutoff Values Tab 
In this tab, you can specify a cut-off level for the condensed or consensus trees.  
Appropriate options become availabl e depending on the trees displayed.  
 
7.3.8 Divergence Time Dialog Box 
This dialog box allows the us er to specify the evolutio nary rate for constructing 
linearized trees.  This can be done by prov iding the evolutionary rate directly or 
by providing the divergenc e time for the given node. 
 7.3.9 View Menu (in Tree Explorer) 
This menu brings up several viewing options: 
Topology only : This displays the tree in the fo rm of relationships among the 
taxa, ignoring the branch lengths. 
Root on Midpoint : This roots the tree on the midpoint of the longest path Molecular Evolutionary Genetics Analysis 
168 between two taxa. 
Arrange Taxa : This allows you to arrange the ta xa in the tree based on the order 
of taxa in the input data file or to produce a tree that looks "balanced." 
Tree/Branch Style : This allows you to select the display of the tree in one of 
three styles: Traditional , Radiation , or Circle .  For Traditional, there are three 
additional options: Rectangular , Straight  or Curved .  
Show/Hide : This allows you to display or hi de the following information: taxon 
label, taxon marker, statis tics (e.g., bootstrap values), branch lengths, or scale 
bar. 
Fonts : This allows you to choose features  such as font type and size for 
information, including the taxon label, statistics, and scale bar. 
Options : This brings up the Option dialog box, which provides control over 
various aspects of the tree drawing, including individual branches, the taxon 
names, and the scale bar. 
 
 
7.3.10 Options dialog box (in Tree Explorer) 
Through this dialog box, you can specify va rious drawing attributes for the tree.  
All options are organized in five tabs. 
Tree  
Branch  Labels  Scale  Cutoff  
7.3.11 Tree tab (in Options dialog box) 
This allows you to manipulate aspects  of the tree, dependi ng on the style you 
used to draw the tree.  For instance, if you used the traditiona l rectangular style, 
then you can manipulate the taxon separat ion distance, branch length, or tree 
width, in the number of pixels.  This t ab also contains a schematic of a tree 
illustrating these features. 
  
7.3.12 Branch tab (i n Options dialog box) 
This tab has options for the following aspects of the tree: 
Line Width:  This allows the user to choose the width of the lines. 
Display Statistics/Frequency:  This presents the options to Hide or Show  the 
statistics and frequency, to choose the font , or to alter the placement of the 
numbers by manipulating the horiz ontal and vertical positions. 
Display Branch Length:  This presents the option to Show  the branch length or 
Hide it if it is shorter than a specified length, to alter the placement of  the written 
branch lengths, and to choose the number of decimal places for writing the Part V: Visualizing and Exploring Data and Results 
169 branch lengths. 
 
7.3.13 Labels tab (in Options dialog box) 
This tab has options for the following: 
Display Taxon Names:   Presents the option to show (checked) or hide 
(unchecked) the label and to choose the font. 
Display Markers:   Allows you to draw sma ll symbols along with or instead of 
taxa names in the tree.  Two combo box es and a list allow you to select the 
marker graphics and its color. 
 
7.3.14 Scale Bar tab (in Options dialog box) 
This tab has options: 
Line Width:  This drop-down menu allows you to choose the width of the line and 
the font size used in the scale bar. Show Distance Scale .  This allows you to 
show or hide the scale bar distance, to  enter the unit used and to choose its 
length and the interval between tick marks. Show Time Scale:  This presents the option of s howing or hiding the divergence 
time in the scale bar, and to enter the units used.  You also can determine the 
interval between two major ti cks and two minor ticks.  To ac tivate this option the 
divergence time for a node or the ev olutionary rate must be given. 
 
 
7.3.15 Compute Menu (in Tree Explorer) 
This performs various tree computati ons, including Condensed tree, Linearized 
tree, and Consensus tree, and allows you to  estimate the divergence time for 
each node using the molecular clock. 
 
7.4 Alignment Explorer 
7.4.1 Alignment Explorer 
The Alignment Explorer  provides options to (1) view and manually edit 
alignments and (2) generate alignment s using a built-in CLUSTALW 
implementation (for the complete sequenc e or data in any rectangular region).  
The Alignment Explorer  also provides tools for exploring web-based databases 
(e.g., NCBI Query and BLAST searches) and retrieving desired sequence data 
directly into the current alignment. 
The Alignment Explorer  has the following menus in its main menu: Data , Edit, 
Search, Alignment, Web, Sequencer, Display, and Help.   In addition, there are 
Toolbars that provide quick access to many Alignment Explorer  functions. The 
main Alignment Explorer  window contains up to  two alignment grids. 
For amino acid input sequence data, the Alignment Explorer  provides only Molecular Evolutionary Genetics Analysis 
170 one view.  However, it o ffers two views of DNA sequence data:  the DNA 
Sequences grid and the Translated Prot ein Sequences grid.  These two views 
are present in alignment grids in the two tabs with each grid displaying the 
sequence data for the current alignment. Ea ch row represents a single sequence 
and each column represents a site.  A "*" character is used to indicate site 
columns, exhibiting consensus across all sequences. An entire sequence may be 
selected by clicking on the gray sequence label cell found to the left of the 
sequence data. An entire site may be sele cted by clicking on the gray cell found 
above the site column. The alignment grid has the ability to assign a unique color to each unique nucleotide or amino acid and it can display a background color for each cell in the grid. This behav ior can be controlled from the Display menu item 
found in the main menu. Pl ease note that when the Clust alW alignment algorithm 
is initiated, it only will align the sites cu rrently selected in th e alignment grids.  
Multiple sites may be selected by c licking and then draggi ng the mouse within 
the grid.  Note that all of the manual or automatic alignment procedures carried 
out in the Protein Sequences grid will be imposed on the corresponding DNA 
sequences as soon as you flip to the DNA sequence grid.  Even more 
importantly, the Alignment Explorer  provides unlimited UNDO capabilities. 
 
7.4.2 Creating Multiple Sequence Alignments 
In this example, we will create an ali gnment from protein sequence data that will 
be imported into the alignment ed itor using different methods.  
Ex 1.0.1:  Start MEGA by double-clicking on t he MEGA desktop icon, or by using 
the Windows start-menu to click on the MEGA icon located in the programs 
folder. 
Ex 1.0.2:  Launch the Alignment Expl orer by selecting the Alignment|Alignment 
Explorer/CLUSTAL  menu command. 
In order to align sequenc es contained in a Sequence Data File, do the following: 
Ex 1.1.1:  Add unaligned sequences from the hsp20.fas example file into the 
Alignment Explorer by clicking selecting the Data|Open|Retrieve  Sequences from 
File menu command. Ex 1.1.2:  Select the Edit|Select All  menu command to select every site for all 
sequences in the alignment. Ex 1.1.3:  Select the Alignment|Align by ClustalW  menu command to align the 
selected sequences data usi ng the ClustalW algorithm. 
Ex 1.1.4:  Save the current alignment  session by selecting the Data|Save Session 
menu item. This will allow the current ali gnment session to be re stored for future 
editing. Ex 1.1.5:  Exit the Alignment Explorer by selecting the Data|Exit Alignment 
Explorer menu item. A mess age will appear asking if you would like to save the 
data to a MEGA file. Choose "YES," and t hen a "Save As" dialog box will appear. 
Enter hsp20_aligned.meg as the file name, and click the "Save" button. An input 
box will appear asking for a title for the data. Ente r "HSP 20 Aligned by MEGA" 
as the title, and click the "O K" button. Another dialog bo x will appear asking you if 
the sequence data is protein c oding. In this case, click "Yes." A final dialog box Part V: Visualizing and Exploring Data and Results 
171 will appear asking you if y ou would like to open the data file in MEGA. Click 
"Yes." 
Now, we will examine how to send sequence data from the Internet (Web 
Explorer) to the Alignment Explorer. 
Ex 1.2.1:  If the Alignment Explorer already contains sequence data, select the 
Data| Create new menu command to create a new alignment from Alignment 
Explorer window. Choose "YES" on the di alog box that appears to indicate that 
you are creating a DNA sequence.  Ex 1.2.2:  Activate the Web Expl orer tab by selecting Web|Query Gene Banks  
from the menu. Ex 1.2.3:  When the NCBI Entrez  site is loaded, select either the nucleotide or 
protein database, enter a search term in to the search box, and press the "GO" 
button. Ex 1.2.4:  When the search results are displayed,  select the specific search item 
and choose "Sequence" from the menu bar. Press the "Add to Alignment" button 
located to the left of the address box. This will display the Web Fetch dialog 
window. 
Ex 1.2.5:  Click the box to the left of eac h accession number whose sequences’ 
information you would like to fetch from  the web. When you are done, you can 
select accessions by pressing the "Fetch" button. Ex 1.2.6:  When the status column indicates t hat all sequences are fetched, press 
the "Send to Alignment" button to send the fetched sequence data to the 
Alignment Explorer. Ex 1.2.7:  Align the fetched data using the steps detailed in Ex 1.1.2 – Ex 1.1.5.  
You may also open a trace file in the Trace Data Viewer/Editor  and send it 
directly to the Alignment Explorer. 
 
7.4.3 Aligning coding seque nces via protein sequences 
MEGA provides a convenient method for aligning coding sequences based on 
the alignment of protein sequences. In order to accomplish this you use the 
Alignment Explorer to load a data file containing protein-coding sequences. If you 
click on the Translated Protein Sequences tab you will see t hat the protein-
coding sequences are automatically trans lated into their respective protein 
sequence. With this tab active select the Alignment|Align by  ClustalW menu item 
or click on the "W" tool bar icon to begin the alignment of t he translated protein 
sequences. Once the alignment  of the translated prot ein sequences completes, 
click on the DNA Sequences tab and you’ll find that Alignment Explorer 
automatically aligned the pr otein-coding sequences according to the aligned 
translated protein sequences. Any manual  adjustments made to the translated 
protein sequence alignment will also be re flected in the protein-coding sequence 
tab.    Molecular Evolutionary Genetics Analysis 
172 TToooollbbaarrss  iinn  AAlliiggnnmmeenntt  EExxpplloorreerr  
 
Basic Functions 
 This prepares Alignment Builder  for a new alignment. Any 
sequence data currently loaded into Alignment Builder is 
discarded. 
 This activates the Open File dialog window. It is used to send 
sequence data from a properly  formatted file into Alignment 
Builder . 
  This activates the Save Alignment Session dialog window. It may 
be used to save the cu rrent state of the Alignment Builder into a file 
so that it may be restored in the future. 
 This causes nucleotide sequences currently loaded into Alignment 
Builder to be translated into their respective amino acid sequences. 
Web/Data Explorer Functions 
 This displays the NCBI BLAST web site in the Web Explorer tab 
window. If a sequence in the sequence grid is selected prior to 
clicking this button, the Web Expl orer will auto-fill the BLAST query 
window with the selected sequence data. 
 This displays the default database (GenBank) in the Web Explorer 
tab window. 
 This activates the Open Trace File dialog window, which may be 
used to open and view a sequencer file. The sequence data from the sequencer file then can be sent into Alignment Explorer . 
Alignment Functions 
 This displays the ClustalW parameters  dialog window, which is 
used to configure ClustalW and in itiate the alignment of the 
selected sequence data. If you do not  select sequence data prior to 
clicking this button, a message box will appear asking if you would 
like to select all of t he currently loaded sequences. 
 This marks or unmarks the current ly selected single site in the 
alignment grid. Each sequence in the alignment may have only one 
site marked at a time. Modifica tions can be made to the alignment 
by marking two or more sites and then aligning them using the 
Align Marked Sites function. 
 This button aligns marked sites. Two or more sites must be marked 
in order for this function to have an effect. 
Search Functions 
 This activates the Find Motif search box. When this box appears, it 
asks you to enter a motif sequence (a small subsequence of a larger sequence) as the search term. After the search term is Part V: Visualizing and Exploring Data and Results 
173 entered, the Alignment Builder finds each occurrence of the search 
term and indicates it with yellow highl ighting. For example, if you 
were to enter the motif "AGA" as the search term, then each 
occurrence of "AGA" across all sequences in the sequence grid 
would be highlighted in yellow. 
 This searches towards the beginning of the current sequence for 
the first occurrence of the motif se arch term. If no motif search has 
been performed prior to clicking this button, the Find Motif search 
box will appear. 
 This searches towards the end of the current sequence for the first 
occurrence of the motif search term. If no moti f search has been 
performed prior to cli cking this button, the Find Motif search box will 
appear. 
 This locates the marked site in t he current sequence. If no site has 
been marked, a warning box will appear. 
Editing Functions 
 This undoes the last Alignment Builder action. 
 This copies the current selection to the clipboard. It may be used to 
copy a single base, a block of bases, or entire sequences to the 
clipboard. 
 This removes the current selection from the Alignment Builder and 
sends it to the clipboard. This function can affect a single base, a 
block of bases, or entire sequences. 
 This pastes the contents of  the clipboard into the Alignment 
Builder. If the clipboard contains a block of bases, it will be pasted 
into the builder starting  at the point of the cu rrent selection. If the 
clipboard contains complete sequences they will be added to the 
current alignment. For example, if  the contents of a FASTA file 
were copied to the clipboard fr om a web browser, it would be 
pasted into Alignment Builder as a new sequence in the alignment. 
 This deletes a block of selected bases from the alignment grid. 
 This deletes gap-only sites (sit es containing a gap across all 
sequences in the alignment grid) fr om a selected block of bases. 
Sequence Data Insertion Functions 
 This creates a new, empty sequence row in the alignment grid. A 
label and sequence data must be provided for this new row. 
 This activates an Open File dialog box that allows for the selection 
of a sequence data file. Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Builder as 
new sequence rows in the alignment grid. 
Site Number display on the status bar 
Site #  The Site # field indicates the site represented by the current Molecular Evolutionary Genetics Analysis 
174 selection.  If the w/o Gaps  radio button is selected, then the 
Alignment Builder will disregard the shifting affect of gaps when 
determining gap sites. If a block of sites are selected, then this field 
will contain the site # for the firs t site in the block. If an entire 
sequence is selected this field will c ontain the site # for the last site 
in the sequence. 
 
 
7.4.4 Menu Items 
AAlliiggnnmmeenntt  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to commands for editing the sequence data in the 
alignment grid.  The commands are: 
Align by ClustalW : This option is used to ali gn the DNA or protein sequence 
included in the current sele ction on the alignment grid .  You will be prompted for 
the alignment parameters (DNA  or Protein) to be used in  ClustalW; to accept the 
parameters, press "OK". This init iates the ClustalW alignment system. Alignment 
Builder then aligns the current selection in the alignment grid using the accepted 
parameters. Mark/Unmark Site : This marks or unmarks a single site in the alignment grid. 
Each sequence in the alignment may only have one site marked at a time. 
Modifications can be made to the alignm ent by marking two or more sites and 
then aligning them using the Align Marked Sites function. 
Align Marked Sites : This aligns marked sites. Two or more sites in the 
alignment must be marked for this function to have an effect. 
Unmark All Sites : This item unmark all currently marked sites across all 
sequences in the alignment grid. 
Delete Gap-Only Sites : This item deletes gap-only sites (site columns 
containing gaps across all sequences ) from the alignment grid.   
Auto-Fill Gaps : If this item is checked, then the Alignment Builder will ensure 
that all sequences in the alignment grid  are the same length by padding shorter 
sequences with gaps at the end. 
 
DDiissppllaayy  MMeennuu  ((iinn  AAlliiggnnmmeenntt  
EExxpplloorreerr))  
This menu provides access to commands th at control the display of toolbars in 
the alignment grid.   The commands in this menu are: 
Toolbars : This contains a submenu of the toolbars found in Alignment Explorer . 
If an item is checked, then its toolbar will be visible within the Alignment Explorer 
window. 
Use Colors : If checked, Alignment Explorer  displays each unique base using a 
unique color indicating the base type. Background Color : If checked, then Alignment Explorer colors the background Part V: Visualizing and Exploring Data and Results 
175 of each base with a unique color t hat represents the base type. 
Font : The Font dialog window can be used to select the font used by Alignment 
Explorer for displaying the sequence data in the alignment grid. 
 
 
EEddiitt  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to commands for editing the sequence data in the 
alignment grid .  The commands in this menu are: 
Undo : This undoes the last Alignment Explorer action. 
Copy : This copies the current selection to the clipboard. It ma y be used to copy a 
single base, a block of bases, or entire sequences. 
Cut: This removes the current selection from the Alignment Explorer and sends it 
to the clipboard. This function can affect a single base, a block of bases, or entire 
sequences. Paste : This pastes the contents of the clipboard into the Alignment Explorer. If 
the clipboard contains a block of bas es, they will be pasted into the builder, 
starting at the point of the current selection. If the c lipboard contains complete 
sequences, they will be added to the current  alignment. For ex ample, if the 
contents of a FASTA file are copied from a web browser to t he clipboard, they 
will be pasted into the Alignment Explorer as a new sequence in the alignment. 
Delete : This deletes a block of select ed bases from the alignment grid. 
Delete Gaps : This deletes gaps from a selected block of bases. 
Insert Blank Sequence : This creates a new, empty sequence row in the 
alignment grid. A label and sequence data must be provided for this new row. 
Insert Sequence From File : This activates an Open File dialog box that allows 
for the selection of a sequence data file . Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Explorer as new sequence 
rows in the alignment grid. 
Select Site(s) : This selects the entire site column  for each site within the current 
selection in the alignment grid. Select Sequences : This selects the entire s equence for each site within the 
current selection in the alignment grid. Select all : This selects all of the si tes in the alignment grid. 
Allow Base Editing : If this item is checked, it changes the base values for all 
cells in the alignment grid. If  it is not checked, then all bases in the alignment grid 
are treated as read-only.   
  
  
  
  Molecular Evolutionary Genetics Analysis 
176 TToooollbbaarrss  iinn  AAlliiggnnmmeenntt  EExxpplloorreerr  
 
Basic Functions 
 This prepares Alignment Builder  for a new alignment. Any 
sequence data currently loaded into Alignment Builder is 
discarded. 
 This activates the Open File dialog window. It is used to send 
sequence data from a properly  formatted file into Alignment 
Builder . 
  This activates the Save Alignment Session dialog window. It may 
be used to save the cu rrent state of the Alignment Builder into a file 
so that it may be restored in the future. 
 This causes nucleotide sequences currently loaded into Alignment 
Builder to be translated into their respective amino acid sequences. 
Web/Data Explorer Functions 
 This displays the NCBI BLAST web site in the Web Explorer tab 
window. If a sequence in the sequence grid is selected prior to 
clicking this button, the Web Expl orer will auto-fill the BLAST query 
window with the selected sequence data. 
 This displays the default database (GenBank) in the Web Explorer 
tab window. 
 This activates the Open Trace File dialog window, which may be 
used to open and view a sequencer file. The sequence data from the sequencer file then can be sent into Alignment Explorer . 
Alignment Functions 
 This displays the ClustalW parameters  dialog window, which is 
used to configure ClustalW and in itiate the alignment of the 
selected sequence data. If you do not  select sequence data prior to 
clicking this button, a message box will appear asking if you would 
like to select all of the currently loaded sequences. 
 This marks or unmarks the current ly selected single site in the 
alignment grid. Each sequence in the alignment may have only one 
site marked at a time. Modificati ons can be made to the alignment 
by marking two or more sites and then aligning them using the 
Align Marked Sites function. 
 This button aligns marked sites. Two or more sites must be marked 
in order for this function to have an effect. 
Search Functions 
 This activates the Find Motif search box. When this box appears, it 
asks you to enter a motif sequence (a small subsequence of a larger sequence) as the search term. After the search term is Part V: Visualizing and Exploring Data and Results 
177 entered, the Alignment Builder finds each occurrence of the search 
term and indicates it with yellow highl ighting. For example, if you 
were to enter the motif "AGA" as the search term, then each 
occurrence of "AGA" across all sequences in the sequence grid 
would be highlighted in yellow. 
 This searches towards the beginning of the current sequence for 
the first occurrence of the motif se arch term. If no motif search has 
been performed prior to clicking this button, the Find Motif search 
box will appear. 
 This searches towards the end of the current sequence for the first 
occurrence of the motif search term. If no moti f search has been 
performed prior to cli cking this button, the Find Motif search box will 
appear. 
 This locates the marked site in t he current sequence. If no site has 
been marked, a warning box will appear. 
Editing Functions 
 This undoes the last Alignment Builder action. 
 This copies the current selection to the clipboard. It may be used to 
copy a single base, a block of bases, or entire sequences to the 
clipboard. 
 This removes the current selection from the Alignment Builder and 
sends it to the clipboard. This function can affect a single base, a 
block of bases, or entire sequences. 
 This pastes the contents of  the clipboard into the Alignment 
Builder. If the clipboard contains a block of bases, it will be pasted 
into the builder starting  at the point of the cu rrent selection. If the 
clipboard contains complete sequences they will be added to the 
current alignment. For example, if  the contents of a FASTA file 
were copied to the clipboard fr om a web browser, it would be 
pasted into Alignment Builder as a new sequence in the alignment. 
 This deletes a block of selected bases from the alignment grid. 
 This deletes gap-only sites (sit es containing a gap across all 
sequences in the alignment grid) fr om a selected block of bases. 
Sequence Data Insertion Functions 
 This creates a new, empty sequence row in the alignment grid. A 
label and sequence data must be provided for this new row. 
 This activates an Open File dialog box that allows for the selection 
of a sequence data file. Once a suitable sequence data file is 
selected, its contents will be imported into Alignment Builder as 
new sequence rows in the alignment grid. 
Site Number display on the status bar 
Site #  The Site # field indicates the site represented by the current Molecular Evolutionary Genetics Analysis 
178 selection.  If the w/o Gaps  radio button is selected, then the 
Alignment Builder will disregard the shifting affect of gaps when 
determining gap sites. If a block of sites are selected, then this field 
will contain the site # for the first site in the block. If an entire 
sequence is selected this field will c ontain the site # for the last site 
in the sequence. 
 
 
SSeeaarrcchh  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu allows searching for sequence motifs and marked sites.   The 
commands in this menu are: 
Find Motif : This activates the Find Motif search box. When this  box appears, it 
asks you to enter a motif sequence (a sm all subsequence of a larger sequence) 
as the search term. After you enter the search term, the Alignment Explorer  finds 
each occurrence of it and indicates it with yellow highlighting. Fo r example, if you 
enter the motif "AGA" as the search te rm, then each occurrence of "AGA" across 
all sequences in the sequence grid  would be highlighted in yellow. 
Find Next : This searches for the first occu rrence of the motif search term 
towards the end of the current sequence.  If no motif search has been performed 
prior to clicking this button, the Find Motif search box will appear. 
Find Previous : this search towards the beginni ng of the current sequence for the 
first occurrence of the motif search te rm. If no motif search  has been performed 
prior to clicking this button, the Find Motif search box will appear. 
Find Marked Site : This locates the marked site in the current sequence. If no 
site has been marked for this sequence, a warning box will appear. 
Highlight Motif : If this item is checked, then a ll occurrences of the text search 
term (motif) are highlighted in the alignment grid. 
  
SSeeqquueenncceerr  MMeennuu  ((iinn  AAlliiggnnmmeen
ntt  EExxpplloorreerr))  
Edit Sequencer File : This item displays the Open File dialog box used to open a 
sequencer data file. Once opene d, the sequencer data file is displayed in the 
Trace Data File Viewer/Editor . This editor allows you to  view and edit trace data 
produced by the automated DNA sequencer.  It reads and edits data in ABI and 
Staden file formats and the sequences disp layed can be added directly into the 
Alignment Explorer or send to the W eb Browser for conducting BLAST searches. 
 
WWeebb  MMeennuu  ((iinn  AAlliiggnnmmeenntt  EExxpplloorreerr))  
This menu provides access to comm ands for querying GenBank and doing a 
BLAST search, as well as access to the MEGA web Browser.  The commands in 
this menu are: 
Query Gene Banks : This item starts the W eb Browser and accesses the NCBI 
home page (http://www.ncbi.nlm.nih.gov).  Part V: Visualizing and Exploring Data and Results 
179 Do BLAST Search : This item starts the W eb Browser and accesses the NCBI 
BLAST query page. If you se lect a sequence in the a lignment grid prior to 
selecting this item, the web browse r will automatically copy the selected 
sequence data into the search field. 
Show Browser :  This item will show the Web Browser. 
  
181 8 Appendix 
8.1 Appendix A: Frequently Asked Questions 
8.1.1 Computing statisti cs on only highlighted sit es in Data Explorer 
Go to the Statistics  menu in the Sequence Data Explorer , and click on Use highlighted 
sites only .  Now all statistical quantities computed using the Statistics  menu will be 
based only on the highlighted sites. 
 
  
8.1.2 Finding the number of sit es in pair-wise comparisons 
If you want to find the number of sites between pairs of sequences or the average 
number of sites, then go to the Distance  menu and select the desired distance type. 
Then in Substitutions to Include,  select an option regarding the number of sites.   
  
 
8.1.3 Get more information about th e codon based Z-test for selection 
The codon based Z-test for selection can be done in two places.  First, you can use the 
Tests | Codon Based tests of selection | Z-test (large sample)  option to find the 
probability that the null hypothesis will be rejected, in addition to the actual value of the Z-statistic.  Alternatively, if you w ant to know the difference between s and n 
(synonymous and non-synonymous substitutions and their variance, you can go to the 
Distances | Pair-wise  menu option and in the distance computation dialog, select an 
appropriate method (e.g., Nei-Gojobori method) and then choose s-n (or n-s depending 
on your need) from the Substitutions to include  menu.  Also, you can choose to compute 
standard error.  
8.1.4 Menus in MEGA are so short; where are all the options? 
Our aim in developing the objectively driven user-interface of MEGA  has been a clutter-
free work environment that asks the user for information on a need-to-know basis 
Although this modular analytical tool looks simple, behind each menu item is a wide range of useful options and tools that come with enhancements that are designed to reduce the amount of time needed for mundane non-technical tasks.  Consider, for 
example, the Sequence Data Explorer.  This unique module is hidden away when you 
don't want it but is always working behind the scenes. It allows you to view the data in 
various ways, export data subsets, and compute many important basic statistical 
quantities. Another interesting module is the Genetic Code selector, 
which allows you to 
choose the depth at which you wish to work with a code table.  With it you can select a 
desired code table, add new data to and edit the existing code table, view the selected 
code table in a conventional format, compute the degeneracy for each site in every 
codon, and compute the number of potentia lly synonymous and non- synonymous sites Molecular Evolutionary Genetics Analysis 
182 for each codon.  In addition, you can always find help by checking the help index.   
  
8.1.5 Writing only 4-fold degene rate sites to an output file 
All sequence data subset facilities are acce ssible through the Export Data command in 
the Sequence Data Explorer .  To write 4-fold degenerate sites to a file, highlight the 4-
fold degenerate sites on the screen and then select Export Data.  In that command, choose to write only the highlighted sites.  For example, if you select to write only the third codon positions, all 4-fold degenerate sites found in the third codon positions will be 
written to the file.   
 
 Appendix 
183 8.2 Appendix B: Main Menu Items and Dialogs 
Reference 
8.2.1 Main MEGA Menus 
MMaaiinn  MMEEGGAA  WWiinnddooww  
The main window in MEGA  contains a menu bar, a toolbar, and a data description 
window (DDW).  The menu bar may contain two or more menu items depending on 
whether a data file is active and on the type of data being analyzed. Menu Bar
 
 
Menus: Description  
File menu Use the File menu commands to open, save, close 
data for analysis and for editing text files 
Data  menu Use the View  menu commands to display the active 
data, edit different data attributes, and compute basic statistical properties. 
Distances  
menu Use the Distance  menu commands to calculate 
evolutionary distances and diversity. 
Pattern  menu  Use this menu to conduct tests and compute statistics 
regarding the substitution pattern homogeneity among lineages. 
Selection  
menu Use this menu to conduct tests of selection. 
Phylogeny  
menu Use the Phylogeny  menu commands to calculate 
evolutionary trees, test their reliability, and view saved 
trees. 
Alignment  
menu Use this menu to construct sequence alignments and explore the world-wide-web. 
Help  menu Use the Help menu to access the online help system, 
which is displayed in a special help window. 
 
Toolbar
 
This contains shortcuts to some frequently used menu commands, such as those in the 
Data  menu. 
 Data Description window
 
This displays a summary of the currently active data set. 
 
FFiillee  DDaattaa  Molecular Evolutionary Genetics Analysis 
184 Open Data  
File | Open Data 
Choose this command to load a data file for analysis. A dialog box will appear to allow 
you to give the data file name. MEGA  will first read the data file to check if it contains the 
Format command (see MEGA format), which specifies certain attributes of the input data (e.g., type of data).  If MEGA  does not find sufficient information in the format command, 
it will request the necessary information through an Input Data Format dialog.   
If you attempt to open a dataset from a file and MEGA  detects inconsistencies or errors 
in the format, it will open the file in the text editor, allowing you to make changes in the text file so that it conforms to the MEGA  format. 
Once a data file is opened successfully, the Open Data  command will be disabled, some 
of the file’s basic attributes will be displayed the bottom of the main window.  To enable the Open D ata command, close the currently active data using the File | Close Data 
command.  
Open dialog box
 
Use the open dialog box to load new data into MEGA  for analysis. 
 
Property  Description  
Look In Lists the current directory. Use the drop-down list to select a 
different drive or directory. 
Files Displays all files in the current directory matching the wildcards 
given in File Name  or the file type in Files Of Type . You can display 
a list of files (default) or you can show details for each file. 
File Name Enter the data file name you want to load or type in the wildcards to 
use as filters. 
Files of Type Choose the type of data file you want to open.  At present MEGA  
allows you to load in MEGA format files only, which should usually 
have the .MEG  extension. 
Up One Level Click this button to move you directory level up from the current 
directory. 
Create New Folder Click this button to create a new subdirectory in the current directory. 
List Click this button to view a list of files and directories in the current directory. 
Details Click this button to view a list of files and directories along with time stamp, size, and attribute information. 
 Appendix 
185 Open Data  
File | Open Data 
Choose this command to load a data file for analysis. A dialog box will appear to allow 
you to give the data file name. MEGA  will first read the data file to check if it contains the 
Format command (see MEGA format), which specifies certain attributes of the input data 
(e.g., type of data).  If MEGA  does not find sufficient information in the format command, 
it will request the necessary information through an Input Data Format dialog.   If you attempt to open a dataset from a file and MEGA  detects inconsistencies or errors 
in the format, it will open the file in the text editor, allowing you to make changes in the 
text file so that it conforms to the MEGA  format. 
Once a data file is opened successfully, the Open Data  command will be disabled, some 
of the file’s basic attributes will be displayed the bottom of the main window.  To enable the Open D ata command, close the currently active data using the File | Close Data 
command.  Open dialog box
 
Use the open dialog box to load new data into MEGA  for analysis. 
 
Property  Description  
Look In Lists the current directory. Use the drop-down list to select a 
different drive or directory. 
Files Displays all files in the current directory matching the wildcards 
given in File Name  or the file type in Files Of Type . You can display 
a list of files (default) or you can show details for each file. 
File Name Enter the data file name you want to load or type in the wildcards to 
use as filters. 
Files of Type Choose the type of data file you want to open.  At present MEGA  
allows you to load in MEGA format files only, which should usually have the .MEG  extension. 
Up One Level Click this button to move you directory level up from the current directory. 
Create New Folder Click this button to create a new subdirectory in the current directory. 
List Click this button to view a list of files and directories in the current directory. 
Details Click this button to view a list of files and directories along with time stamp, size, and attribute information. 
 
Reopen Data  
File | Reopen Data 
This reopens a recently closed data file from  the submenu, which shows the names of 
the five most recently used data files. Molecular Evolutionary Genetics Analysis 
186 Open Data  
File | Open Data 
Choose this command to load a data file for analysis. A dialog box will appear to allow 
you to give the data file name. MEGA  will first read the data file to check if it contains the 
Format command (see MEGA format), which specifies certain attributes of the input data (e.g., type of data).  If MEGA  does not find sufficient information in the format command, 
it will request the necessary information through an Input Data Format dialog.   
If you attempt to open a dataset from a file and MEGA  detects inconsistencies or errors 
in the format, it will open the file in the text editor, allowing you to make changes in the text file so that it conforms to the MEGA  format. 
Once a data file is opened successfully, the Open Data  command will be disabled, some 
of the file’s basic attributes will be displayed the bottom of the main window.  To enable the Open D ata command, close the currently active data using the File | Close Data 
command.  
Open dialog box
 
Use the open dialog box to load new data into MEGA  for analysis. 
 
Property  Description  
Look In Lists the current directory. Use the drop-down list to select a 
different drive or directory. 
Files Displays all files in the current directory matching the wildcards 
given in File Name  or the file type in Files Of Type . You can display 
a list of files (default) or you can show details for each file. 
File Name Enter the data file name you want to load or type in the wildcards to 
use as filters. 
Files of Type Choose the type of data file you want to open.  At present MEGA  
allows you to load in MEGA format files only, which should usually 
have the .MEG  extension. 
Up One Level Click this button to move you directory level up from the current 
directory. 
Create New Folder Click this button to create a new subdirectory in the current directory. 
List Click this button to view a list of files and directories in the current directory. 
Details Click this button to view a list of files and directories along with time stamp, size, and attribute information. 
 
Exit 
File | Exit 
This command closes the currently active data file and all other windows. If you want to 
save changes to the data set displayed on the screen, before issuing this command you must choose   File | Export Data and Print or Save .   Note that MEGA  does not Appendix 
187 automatically save changes made to active data to the original data file. 
 
Printer Setup  
File | Printer Setup 
Choose this command to change the properties of your printer. 
 
Main MEGA Window  
The main window in MEGA  contains a menu bar, a toolbar, and a data description 
window (DDW).  The menu bar may contain two or more menu items depending on 
whether a data file is active and on the type of data being analyzed. Menu Bar
 
 Menus: Description
 
File menu Use the File menu commands to open, save, close 
data for analysis and for editing text files 
Data  menu Use the View  menu commands to display the active 
data, edit different data attributes, and compute basic 
statistical properties. 
Distances  
menu Use the Distance  menu commands to calculate 
evolutionary distances and diversity. 
Pattern  menu  Use this menu to conduct tests and compute statistics 
regarding the substitution pattern homogeneity among 
lineages. 
Selection  
menu Use this menu to conduct tests of selection. 
Phylogeny  
menu Use the Phylogeny  menu commands to calculate 
evolutionary trees, test their reliability, and view saved 
trees. 
Alignment  
menu Use this menu to construct sequence alignments and 
explore the world-wide-web. 
Help  menu Use the Help menu to access the online help system, 
which is displayed in a special help window. 
 
Toolbar  
This contains shortcuts to some frequently used menu commands, such as those in the 
Data  menu. 
 
Data Description window  
This displays a summary of the currently active data set. 
 
DDaattaa  MMeennuu  Molecular Evolutionary Genetics Analysis 
188 Data Menu  
This allows you to explore the active data set, and establish various data attributes, and 
data subset options. 
 
Data Explorer  
Data | Data Explorer  
Data Explorers used to view the currently active data set, calculate its basic statistical 
attributes, export it in formats compatible with other programs, and define subsets for analysis.  Depending on the currently active data type, one of the following explorers will 
be available: 
 
Data Type
 Explorer  
DNA, RNA, Protein 
sequences Sequence Data Explorer  
Evolutionary divergence Distance Data Explorer  
 
Setup/Select Taxa & Groups  
Data | Setup/Select Taxa & Groups 
 
This invokes the Setup/Select Taxa & Groups dialog box for including or excluding taxa, 
defining groups of taxa, and editing names of taxa and groups. 
 
8.2.2 Setup/Select Taxa & Groups Dialog 
 
This dialog box has two sub-windows ( Taxa/Groups  and Ungrouped Taxa ), a panel bar 
between them containing a few buttons, and a command panel, with the lower part 
containing the Add, Delete , Close , and Help buttons. 
 
Taxa/Groups sub-window on the left:  It shows all the currently defined taxa and group 
names hierarchically.  If a taxon has been assigned to a group, it will appear connected 
to that group.  Groups may be displayed in a collapsed format (indicated by a + mark 
before their name). You can click '+' to expand the group to a listing of the taxa contained in it, and click ‘–‘ to collapse the group to only view the group name. Groups that do not contain any members do not have this box. Next is a checkbox indicating 
whether a given group or taxon will be included in an analysis. Following that is an icon indicating a taxon (single box) or a group (lay er of boxes).  Grayed out check boxes are 
used to indicate that some of the taxa in a group are selected and others are unselected.  
You can rearrange the order of taxa and groups using drag-and-drop. However, note that this order is not automatically used in the Data Explorer . To enforce this order, use 
the Sort command in the Data Explorer . 
 
Ungrouped Taxa Sub-window  on the right:  This shows the names of all the taxa that do 
not belong to any of the groups to facilitate your ability to move taxa into groups.  If this 
sub-window does not appear on your screen, then hold and drag the lower right corner of the dialog box to expand its width to unhide it. Appendix 
189  
Middle Command Panel:  This resides between the above-mentioned two sub-windows 
and contains a splitter on its right edge.  You can grab the splitter and move it to change 
the proportion of the space taken by the two sub-windows.  In this panel left and right 
arrow buttons are used to add or remove taxa from the groups.  Clicking the hand-with-a-pencil icon with a highlighted taxon or group name will allow you to edit that name.  Lower Command Panel :  In the lower part of the Select/Edit Taxa/Groups  window are 
buttons that are used to add and/or delete groups.  The ‘+’ and ‘–‘ buttons are also 
present on the middle command panel. 
 
Buttons
 Description  
Add Creates a new group. 
Delete Deletes the currently selected group. Any 
taxa that were assigned to the group will 
become freestanding. 
Ungroup Makes all the taxa in the selected group 
freestanding, but does not remove the 
group from the list. 
Close Closes the dialog box. 
Help Brings up help regarding the dialog box. 
 
How to perform functions:  
 
Function  Description  
Creating a new 
group Click on the Add button. Click on the 
highlighted name of the group and type in a 
new name. 
Deleting a group Select the group and click the Delete  button.  
Any taxa that were assigned to this group will 
become freestanding. 
Adding taxa to a group Drag-and-drop the taxon on the desired group 
or select one or more taxa in the Ungrouped 
Taxa  window and click on the left arrow button 
on the middle command panel.  
Removing a taxon 
from a group Click on the taxon and drag-and-drop it into a 
group (or outside all groups).  Or, select the 
taxon and click on the right arrow button on 
the middle command panel. 
Include/Exclude taxa or groups Click the checkbox next to the group or taxa name. 
Include Codon Positions  
Data | Select Preferences | Include Codon Positions  Molecular Evolutionary Genetics Analysis 
190 Use this menu item to specify the codon pos itions you would like to include in the 
nucleotide sequence analysis.  You can include any combination of 1st, 2nd, 3rd positions 
and non-coding sites.  The specified options are used only if you conduct a nucleotide-
by-nucleotide site analysis.  If relevant, you will be given this choice in the dialog box 
that appears in response to a requested analysis (e.g., distance computation or 
phylogenetic reconstruction).  Thus, you have the flexibility to select or change appropriate options at the time of the analysis.  
Include Labeled Sites  
Data | Select Preferences | Include Labeled Sites  
Use this to specify whether to include only the labeled sites in the analysis and, if so, 
which ones.  This option is available only if you have some sites labeled.  If relevant, you also will be given this choice in the dialog box that appears in response to a requested 
analysis (e.g., a distance computation or phy logenetic reconstruction).  Thus, you have 
the flexibility to select or change appropriate options at the time of the analysis. 
 
8.2.3 Setup/Select Taxa & Groups Dialog 
 
This dialog box has two sub-windows ( Taxa/Groups  and Ungrouped Taxa ), a panel bar 
between them containing a few buttons, and a command panel, with the lower part 
containing the Add, Delete , Close , and Help buttons. 
 
Taxa/Groups sub-window on the left:  It shows all the currently defined taxa and group 
names hierarchically.  If a taxon has been assigned to a group, it will appear connected 
to that group.  Groups may be displayed in a collapsed format (indicated by a + mark 
before their name). You can click '+' to expand the group to a listing of the taxa 
contained in it, and click ‘–‘ to collapse the group to only view the group name. Groups that do not contain any members do not have this box. Next is a checkbox indicating 
whether a given group or taxon will be included in an analysis. Following that is an icon indicating a taxon (single box) or a group (lay er of boxes).  Grayed out check boxes are 
used to indicate that some of the taxa in a group are selected and others are unselected.  
You can rearrange the order of taxa and groups using drag-and-drop. However, note that this order is not automatically used in the Data Explorer . To enforce this order, use 
the Sort command in the Data Explorer . 
 Ungrouped Taxa Sub-window  on the right:  This shows the names of all the taxa that do 
not belong to any of the groups to facilitate your ability to move taxa into groups.  If this sub-window does not appear on your screen, then hold and drag the lower right corner of the dialog box to expand its width to unhide it.  Middle Command Panel:  This resides between the above-mentioned two sub-windows 
and contains a splitter on its right edge.  You can grab the splitter and move it to change the proportion of the space taken by the two sub-windows.  In this panel left and right arrow buttons are used to add or remove taxa from the groups.  Clicking the hand-with-a-pencil icon with a highlighted taxon or group name will allow you to edit that name. 
 
Lower Command Panel :  In the lower part of the Select/Edit Taxa/Groups  window are 
buttons that are used to add and/or delete groups.  The ‘+’ and ‘–‘ buttons are also Appendix 
191 present on the middle command panel. 
 
Buttons  Description  
Add Creates a new group. 
Delete Deletes the currently selected group. Any taxa that were assigned to the group will become freestanding. 
Ungroup Makes all the taxa in the selected group freestanding, but does not remove the group from the list. 
Close Closes the dialog box. 
Help Brings up help regarding the dialog box. 
 
How to perform functions:
 
 
Function  Description  
Creating a new 
group Click on the Add button. Click on the highlighted name of the 
group and type in a new name. 
Deleting a group Select the group and click the Delete  button.  Any taxa that 
were assigned to this group will become freestanding. 
Adding taxa to a 
group Drag-and-drop the taxon on the desired group or select one or 
more taxa in the Ungrouped Taxa  window and click on the left 
arrow button on the middle command panel.  
Removing a taxon 
from a group Click on the taxon and drag-and-drop it into a group (or outside 
all groups).  Or, select the taxon and click on the right arrow 
button on the middle command panel. 
Include/Exclude taxa or groups Click the checkbox next to the group or taxa name. 
 
Handling Gaps and Missing Data  
Data | Select Preferences | Handling Gaps and Missing Data 
Use this to specify whether to use the Pair-wise-Deletion or the Complete- Deletion 
option for handling alignment gaps and missing data.  You also can specify these 
options in the dialog box that appears in response to a requested analysis (e.g., distance 
computation or phylogenetic reconstruction).  Therefore, you have the flexibility to select 
or change appropriate options at the time of the analysis.  
Select Preferences  
Data | Select Preferences 
This submenu specifies (1) how the alignment gaps and missing data will be handled, 
(2) which codon positions will be used, and (3) whether to restrict the analysis to the 
sites with selected labels.  One or more of these options may be disabled depending on 
the attributes of the data set.  For instance, the selection of codon positions is not valid Molecular Evolutionary Genetics Analysis 
192 when amino acid sequence data is being analyzed. 
These options also are available in the Options  dialog box that appears in response to a 
requested analysis (e.g., distance computation or phylogenetic reconstruction).  Thus, 
you have the flexibility to select and change appropriate options at the time of the 
analysis.  
DDiissttaanncceess  MMeennuu  
Use this menu to compute: pair-wise and average distances between sequences; within, 
between, and net average distances among groups; and sequence diversity statistics for 
data from multiple populations. 
 
Choose Model  
Distances | Choose Model…  
Choose this to select a specific model of change for computing distances.  The model 
also can be chosen or changed in the dialog box that appears when you request an 
analysis, such as distance computation or phylogenetic reconstruction.   
Compute Pair-wise  
Distances | Compute Pair-wise…  
Choose this to compute the distances and standard errors between pairs of taxa.  A 
Select Distance Options dialog, in which you can choose the desired distance estimation 
method and other relevant options, will appear. 
 
Compute Overall Mean  
Distances | Compute Overall Mean…  
This calculates the mean pair-wise distance and standard error for the set of sequences 
under study. The overall mean is the arithmetic mean of all individual pair-wise distances 
between taxa.  A Select Distance Options dialog, in which you can choose the desired 
distance estimation method and other relevant options, will appear.  Before using the 
bootstrap method to compute standard error, please read how MEGA  implements the 
bootstrap method for this purpose. 
 
Compute Within Groups Mean  
Distances | Compute Within Groups Means… 
This computes the mean pair-wise distances within groups of taxa.  The within group 
means are arithmetic means of all individual pair-wise distances between taxa within a group.  A Select Distance Options dialog, in which you can choose the desired distance 
estimation method and other relevant options, appears. You must have at least one 
group of taxa, with a minimum of two taxa defined, to utilize this option. 
 
Compute Sequence Diversity  
Distances | Compute Sequence Diversity 
The Sequence Diversity  submenu provides four commands for computing the population Appendix 
193 and subpopulation diversities that are useful in molecular population genetics studies.  
First, you define a group, using a population of sequences.  Unlike the generic averages 
of within group, between group, and net between group distances calculated using other 
commands in the Distances menu , formulas used in the following commands are those 
used specifically in population genetics analyses. 
The commands are: Mean Diversity within Subpopulations
 
In a subpopulation, the mean diversity is defined as  
 where 
  is the frequency of i-th sequence in the sample 
from subpopulation i, and q is the number of different sequences in this 
subpopulation. 
Mean Diversity for Entire Population  
For the entire population, the mean diversity is defined as 
, where 
  is the estimate of average frequency of the i-th 
allele in the entire population, and q is the number of different sequences in the 
entire sample. 
Mean Interpopulational Diversity  
The estimate of inter-populational diversity is given by 
 
 . 
Coefficient of Differentiation  
The estimate of the proportion of interpopulational diversity is given by  
. 
 
Compute Net Between Groups Means  
Distances | Compute Net Between Groups Means… 
This command computes the net average distances between groups of taxa.  The net 
average distance between two groups is given by 
dA = dXY – ((dX + dY)/2) 
Where, dXY is the average distance between groups X and Y, and dX and dY are the 
mean within-group distances.  A Select Distance Options dialog, in which you can 
choose the desired distance estimation method and other relevant options, will appear. 
You must have at least two groups of taxa with a minimum of two taxa each for this 
option to work.  
Compute Between Groups Means  
Distances | Compute Between Groups Means… 
This computes the average distances between groups of taxa.  The average distance is 
the arithmetic mean of all pair-wise distances between two groups in the inter-group 
comparisons.  A Select Distance Options dialog, in which you can choose the desired 
distance estimation method and other relevant options, will appear. You must have at 
least two groups of taxa for this option to work.  
PPhhyyllooggeennyy  MMeennuu  Molecular Evolutionary Genetics Analysis 
194 Phylogeny Menu  
Use the Phylogeny  menu to construct phylogenetic trees, infer their reliability using the 
bootstrap and interior branch tests, conduct molecular clock tests, and view previously 
constructed trees.  
Bootstrap Test of Phylogeny  
Phylogeny | Bootstrap Test of Phylogeny 
One of the most commonly used tests of the reliability of an inferred tree is Felsenstein's 
(1985) bootstrap test, which is evaluated using Efron's (1982) bootstrap resampling technique.  If there are m sequences, each with n nucleotides (or codons or amino 
acids), a phylogenetic tree can be reconstructed using some tree building method.  From 
each sequence, n nucleotides are randomly chosen with replacements, giving rise to m 
rows of n columns each.  These now constitute a new set of sequences.  A tree is then 
reconstructed with these new sequences using the same tree building method as before.  Next the topology of this tree is compared to that of the original tree.  Each interior branch of the original tree that is different from the bootstrap tree the sequence it 
partitions is given a score of 0; all other interior branches are given the value 1.  This 
procedure of resampling the sites and the subsequent tree reconstruction is repeated several hundred times, and the percentage of times each interior branch is given a value of 1 is noted.  This is known as the bootstrap value.  As a general rule, if the bootstrap value for a given interior branch is 95% or higher, then the topology at that branch is 
considered "correct".  See Nei and Kumar (2000) (chapter 9) for further details. 
This test is available for four different methods: Neighbor Joining, Minimum Evolution, Maximum Parsimony, and UPGMA.   
Interior Branch Test of Phylogeny  
Phylogeny | Interior Branch Test of Phylogeny 
A t-test, which is computed using the bootstrap procedure, is constructed based on the 
interior branch length and its standard error and is available only for the NJ and 
Minimum Evolution trees.   MEGA  shows the confidence probability in the Tree Explorer; 
if this value is greater than 95% for a given branch, then the inferred length for that 
branch is considered significantly positive.    See Nei and Kumar (2000) (chapter 9) for further details.  
Display Saved Tree Session  
Phylogeny | Display Saved Tree Session… 
Use this command to display a previously saved Tree Explorer session (saved in a 
filename with . MTS extension). 
 
DDiissppllaayy  NNeewwiicckk  TTrreeeess  ffrroomm  FFiillee  
Phylogeny | Display Newick Trees from File… Use this to retrieve and display one or more trees written in Newick format.  Multiple 
trees can be displayed, and their consensus built, in the Tree Explorer.  MEGA  supports Appendix 
195 the display of Newick format trees containing branch lengths as well as bootstrap or 
other counts (note that the Newick formats do not contain the total number of bootstrap replications conducted). 
 
Relative Rate Tests  
Phylogeny | Relative Rate Tests This submenu provides access to a test of the constancy of evolutionary rates between 
two sequences or clusters of sequences, using an out-group sequence.   
TTaajjiimmaa''ss  TTeesstt  ((RReellaattiivvee  RRaattee))  
Phylogeny | Relative Rate Tests | Tajima’s Test 
Use this to conduct Tajima’s relative rate test (Tajima 1993), which works in the following 
way.  Consider three sequences, 1, 2 and 3, and let 3 be the out-group.  Let nijk be the 
observed number of sites in which sequences 1, 2 and 3 have nucleotides i, j and k.  
Under the molecular clock hypothesis, E( nijk)  =  E( njik) irrespective of the substitution 
model and whether or not the substitution rate varies with the site.  If this hypothesis is 
rejected, then the molecular clock hypothesis can be rejected for this set of sequences. 
In response to this command, you can select the three sequences for conducting 
Tajima’s test.  For nucleotide sequences, this test offers the flexibility of using only transitions, only transversions, or both.  If the data is protein coding, then you can choose to analyze translated sequences or any combination of codon positions by 
clicking on the ‘Data for Analysis’ button. 
 See Nei and Kumar (2000) (page 193-196) for further description and an example.  
Construct Phylogeny  
NNeeiigghhbboorr--JJooiinniinngg  ((NNJJ))  MMeetthhoodd  
This method (Saitou and Nei 1987) is a simplified version of the minimum 
evolution (ME) method (Rzhetsky and Nei 1992). The ME method uses distance 
measures that correct for multiple hits at the same sites; it chooses a topology 
showing the smallest value of  the sum of all branches ( S) as an estimate of the 
correct tree.  However, c onstruction of an ME tree is time-consuming because, in 
principle, the S values for all topologies must be evaluated. Because the number 
of possible topologies (unr ooted trees) rapidly increases  with the number of taxa, 
it becomes very difficult to examine all topologies.  
In the case of t he NJ method, the S value is not computed for all or many 
topologies, but the examination of different topologie s is embedded in the 
algorithm, so that only one final tree is pr oduced. The algorithm of the NJ method 
is somewhat complicated and is explai ned in detail in Nei and Kumar (2000, 
page 103). 
The NJ method produces an unrooted tr ee because it does not require the 
assumption of a constant rate of ev olution.   Finding the root requires an 
outgroup taxon.  In the absence of outgroup taxa, the root is sometimes given at 
the midpoint of the longest distance connecting two taxa in the tree, which is Molecular Evolutionary Genetics Analysis 
196 referred to as mid- point rooting.  
 
MMiinniimmuumm  EEvvoolluuttiioonn  ((CCoonnssttrruucctt  PPhhyyllooggeennyy))  
Phylogeny | Construct Phylogeny | Minimum Evolution… 
This command is used to construct a phylogenetic tree under the minimum evolution 
criterion.  In this method the sum, S, of all branch length estimates, i.e. 
 S = ∑bi, 
is computed for all plausible topologies, and the topology that has the smallest S value is 
chosen as the best tree: the ME tree.  This criterion does not require the assumption of evolutionary rate constancy as needed in the UPGMA analysis.  Therefore the inferred 
phylogenetic tree is an unrooted tree, even though, for ease of inspection, it is often displayed in a manner similar to rooted trees.  MEGA  employs the Close-Neighbor-Interchange (CNI) algorithm to find the ME tree.  
This is a branch swapping method, which begins with a given initial tree.  You can ask MEGA  to automatically construct a Neighbor-Joining (NJ) tree and use that as the 
starting tree.  Alternatively, you can provide your own topology.  Note that the final tree 
produced after this search is not guaranteed to be the ME tree.  These options are available in the ME Tree Tab  of the Analysis Preferences dialog box, which is displayed 
before the phylogenetic analysis begins.  This dialog box also allows you to specify the 
distance estimation method, subset of sites to include, and whether to conduct a test of 
the inferred tree.  
MMaaxxiimmuumm  PPaarrssiimmoonnyy  ((MMPP))  MMeetthhoodd  
Maximum parsimony (MP) methods original ly were developed for morphological 
characters, and there are m any different versions (see Nei and Kumar [2000] for 
a review).  In MEGA , we consider both of thes e methods for nucleotide and 
amino acid sequence data (Eck and Dayhoff 1966; Fitch 1971).  
For constructing an MP tree, only sites at which there are at least two different kinds of 
nucleotides or amino acids, each represent ed at least twice, are used (parsimony-
informative sites). Other variable sites are not used for constructing an MP tree, 
although they are informative for distance and maximum-likelihood methods.  
MEGA  estimates MP tree branch lengths by using the average pathway method 
for unrooted trees (see Nei and Kumar [2000], page 132). 
To search for MP Trees, MEGA  provides three different types of searches: the 
max-mini branch-and-bound search, min -mini heuristic search, and close-
neighbor-interchange heuristic search.  Only the branch-and-bound search is 
guaranteed to find all the MP tr ees, but it takes prohibiti ve amount of time if the 
number of sequences is large (>15).  For details, please see chapter 7 in Nei and 
Kumar (2000)  
 
UUPPGGMMAA  
This method assumes that the rate of nucl eotide or amino acid substitution is the 
same for all evolutionary lineages. An intere sting aspect of this method is that it 
produces a tree that mimics a species tree,  with the branch lengths for two OTUs Appendix 
197 being the same after their separation.  Be cause of the assumption of a constant 
rate of evolution, this method produces  a rooted tree, though it is possible to 
remove the root for certain purposes. T he algorithm for UPGMA is discussed in 
detail in Nei and Kumar (2000, page 87). 
 
SSeelleeccttiioonn  MMeennuu  
Tajima's Test of Neutrality  
Selection | Tajima’s Test of Neutrality 
This conducts Tajima’s test of neutrality ( Tajima 1989), which compares the number of 
segregating sites per site with the nucleotide diversity.   (A site is considered segregating 
if, in a comparison of m sequences, there are two or more nucleotides at that site; 
nucleotide diversity is defined as the average number of nucleotide differences per site 
between two sequences).  If all the alleles are selectively neutral, then the product 4Nv 
(where N is the effective population size and v is the mutation rate per site) can be 
estimated in two ways, and the difference in the estimate obtained provides an indication 
of non-neutral evolution.  Please see Nei and Kumar (2000) (page 260-261) for further 
description.   
Codon Based Z-Test (large sample)  
Selection | Codon Based Z-test (large sample) 
One way to test whether positive selection is operating on a gene is to compare the 
relative abundance of synonymous and non-sy nonymous substitutions that have 
occurred in the gene sequences.  For a pair of sequences, this is done by first estimating 
the number of synonymous substi tutions per synonymous site ( dS) and the number of 
non-synonymous substitutions per non-synonymous site ( dN), and their variances: 
Var(dS) and Var( dN), respectively.  With this information, we can test the null hypothesis 
that H 0: dN = dS using a Z-test: 
 Z = ( dN - dS) / SQRT(Var( dS) + Var( dN)) 
The level of significance at which the null hypothesis is rejected depends on the 
alternative hypothesis (HA)  H
0:  dN = dS 
 HA:  (a) dN ≠ dS  (test of neutrality). 
(b) d N > dS  (positive selection). 
(c) d N < dS  (purifying selection). 
 
For alternative hypotheses (b) and (c), we use a one-tailed test and for (a) we use a two-
tailed test.  These three tests can be conducted directly for pairs of sequences, overall sequences, or within groups of sequences.  For testing for selection in a pair-wise manner, you can compute the variance of ( d
N - dS) by using either the analytical formulas 
or the bootstrap resampling method.   
For data sets containing more than two seque nces, you can compute the average number 
of synonymous substitutions and the average number of non-synonymous substitutions to 
conduct a Z-test in a manner similar to the one mentioned above.  The variance of the 
difference between these two quantities is es timated by the bootstrap method (See Nei 
and Kumar (2000) page 55).Molecular Evolutionary Genetics Analysis 
198 Codon Based Fisher's Exact Test  
Selection | Codon Based Fisher’s Exact Test 
This provides a test of selection based on the comparison of the numbers of 
synonymous and non-synonymous substitu tions between sequences.  Use this 
command to conduct a small sample test of positive selection (Zhang et al. 1997): a one-
tailed Fisher’s Exact test.  If the resulting P -value is less than 0.05, then the null 
hypothesis of neutral evolution (strictly neutral and purifying selection) is rejected.  If the 
observed number of synonymous di fferences per synonymous site ( pS) exceeds the 
number of non-synonymous differences per non-synonymous site ( pN) then MEGA  sets 
P  = 1 to indicate purifying selection, rather than positive selection.  
 
See Nei and Kumar (2000) (page 56) for further description and an example. 
  
AAlliiggnnmmeenntt  MMeennuu  
Alignment Menu  
This menu provides access to options for viewing and building DNA and protein 
sequence alignments and for exploring the web based databases (e.g., NCBI Query and BLAST searches) in the MEGA  environment. 
 
Alignment Explorer/CLUSTAL  
Alignment | Alignment Explorer/CLUSTAL 
This option displays the Alignment Explorer, which can be used to view and build DNA 
and protein sequence alignments and to explore the web based databases (e.g., NCBI Query and BLAST searches) in the MEGA  environment. 
 
Query Databanks  
Alignment | Query Databanks 
Use this to open the MEGA web-browser to search the NCBI and other web sites for 
sequence data.  
 
Show Web Browser  
Alignment | Show Web Browser 
Use this option to launch the MEGA  Web Browser. 
 
View/Edit Sequencer Files  
Alignment | View/Edit Sequencer Files Use this option to view/edit the sequence data in ABI (*.abi and .ab1) and Staden (.scf) 
files.  The Alignment Explorer pr ovides this option directly.  
 
HHeellpp  MMeennuu  Appendix 
199 Help Menu  
This menu provides access to the help index as well as the About  dialog box, which 
provides version information for MEGA . 
 
Index  
Help | Index 
This command provides access to the help file index and keyword searching facilities. 
 
About  
Help | About… 
This command will display the About  dialog box showing the copyright, authors, and 
version information for MEGA . 
 
8.2.4 MEGA Dialogs 
IInnppuutt  DDaattaa  FFoorrmmaatt  DDiiaalloogg  
The Input Data Format dialog is displayed if MEGA  does not find enough information 
about the type of data included in the input file.   
Data Type  
This displays the list of data types that MEGA  is able to analyze.  Highlight the current 
data type by clicking on it.  Depending on t he type of data selected, you may need to 
provide information about the following additional items. 
 
For Sequence Data  
• Missing Data 
Character used to show missing data in the data file; it should be set to a question 
mark (?). 
• Alignment Gap 
Character used to represent gaps inserted in the multiple sequence alignment; it is 
set to a dash (-) by default. 
• Identical Symbol 
Character used to represent identity with the first sequence in the data files; it is set to a dot (.) by default. 
 For Pair-wise Distance Data
 
• Missing Data 
Character used to show missing data in the data file; it should be set to a question 
mark (?). 
• Matrix Format 
Choose the lower-left or upper-right distance matrix for the pair-wise distance data 
type. 
 
Note : To avoid having to answer these questions every time you read your data file, Molecular Evolutionary Genetics Analysis 
200 save the data by exporting it in MEGA  format. 
 
SSeettuupp//SSeelleecctt  TTaaxxaa  &&  GGrroouuppss  DDiiaalloogg  
 
This dialog box has two sub-windows ( Taxa/Groups  and Ungrouped Taxa ), a panel bar 
between them containing a few buttons, and a command panel, with the lower part 
containing the Add, Delete , Close , and Help buttons. 
 
Taxa/Groups sub-window on the left:  It shows all the currently defined taxa and group 
names hierarchically.  If a taxon has been assigned to a group, it will appear connected 
to that group.  Groups may be displayed in a collapsed format (indicated by a + mark before their name). You can click '+' to expand the group to a listing of the taxa contained in it, and click ‘–‘ to collapse the group to only view the group name. Groups 
that do not contain any members do not have this box. Next is a checkbox indicating 
whether a given group or taxon will be included in an analysis. Following that is an icon 
indicating a taxon (single box) or a group (lay er of boxes).  Grayed out check boxes are 
used to indicate that some of the taxa in a group are selected and others are unselected.  You can rearrange the order of taxa and groups using drag-and-drop. However, note 
that this order is not automatically used in the Data Explorer . To enforce this order, use 
the Sort command in the Data Explorer . 
 Ungrouped Taxa Sub-window  on the right:  This shows the names of all the taxa that do 
not belong to any of the groups to facilitate your ability to move taxa into groups.  If this sub-window does not appear on your screen, then hold and drag the lower right corner 
of the dialog box to expand its width to unhide it. 
 Middle Command Panel:  This resides between the above-mentioned two sub-windows 
and contains a splitter on its right edge.  You can grab the splitter and move it to change the proportion of the space taken by the two sub-windows.  In this panel left and right 
arrow buttons are used to add or remove taxa from the groups.  Clicking the hand-with-
a-pencil icon with a highlighted taxon or group name will allow you to edit that name. 
 
Lower Command Panel :  In the lower part of the Select/Edit Taxa/Groups  window are 
buttons that are used to add and/or delete groups.  The ‘+’ and ‘–‘ buttons are also present on the middle command panel.  
Buttons
 Description  
Add Creates a new group. 
Delete Deletes the currently selected group. Any taxa that were 
assigned to the group will become freestanding. 
Ungroup Makes all the taxa in the selected group freestanding, but does not remove the group from the list. 
Close Closes the dialog box. 
Help Brings up help regarding the dialog box. 
 
How to perform functions:
 Appendix 
201  
Function  Description  
Creating a new 
group Click on the Add button. Click on the 
highlighted name of the group and type in a 
new name. 
Deleting a group Select the group and click the Delete  button.  
Any taxa that were assigned to this group will 
become freestanding. 
Adding taxa to a group Drag-and-drop the taxon on the desired group 
or select one or more taxa in the Ungrouped 
Taxa  window and click on the left arrow button 
on the middle command panel.  
Removing a taxon 
from a group Click on the taxon and drag-and-drop it into a 
group (or outside all groups).  Or, select the 
taxon and click on the right arrow button on 
the middle command panel. 
Include/Exclude taxa or groups Click the checkbox next to the group or taxa name. 
 
SSeettuupp//SSeelleecctt  GGeenneess  &&  DDoommaaiinnss  DDiiaalloogg  
 
Use the Gene & Domain Editor to inspect, define, and select domains, and genes,  and 
labels for individual sites. 
 The Genes & Domains dialog consists of two tabs: Define/Edit/Select  and Site Labels . 
 
Define/Edit/Select tab 
This tab contains a hierarchical listing of gene and domain names with the corresponding information organized into four columns for amino acid sequences and six 
columns for nucleotide sequences.    
Gene and domain name listing 
Each line in this display contains a small 'expand/contract' box, a checkbox, a 
gene/domain icon, and the name of the gene or domain. The 'expand/contract' box 
allows you to display or hide the information below a given gene. The checkbox shows if 
the gene or domain is currently selected fo r analysis.  All defined genes and domains 
appear below the Genes\Domain  node in the hierarchy.  All domain names are shown 
with a yellow background.  The Independent node shows the number of Independent 
sites, which are not assigned to any domains or genes. 
 
If your input data file does not contain any domains, then MEGA  automatically creates a 
domain called Data.  If you wish to creat e new domains, you should delete the Data 
domain to make all sites independent.  Remember that only independent sites can be 
assigned to domains, and sites cannot be assigned to multiple domains.  Genes are simply collections of domains, and thus gene boundaries are decided based on the Molecular Evolutionary Genetics Analysis 
202 domains contained in them.  The MEGA  gene and domain organizer is flexible and is 
designed to enable you to specify genes and domains as they appear in a genome.  For 
instance, a sequence may contain one or more genes, each of which may contain one or 
more domains.  In between genes, there may be inter-genetic domains.  In addition, 
within or between genes or domains, there may be sites that are not members of any domain.   At the bottom of this tab, you will find a toolbar with many drop-down menu buttons, which can be used to Add/Insert  new genes or domains.  The add and insert operations 
differ in the following way.  If you add a gene or domain, then the new gene or domain will be added at the end of the list to which the currently focused gene or domain belongs.   If you insert  a gene (or domain), it will be inserted by shifting all the following 
genes or domains down.  Add and Insert  commands are context sensitive. 
 
You can rearrange the relative position of genes and domains by drag-and-drop 
operations.    
Inspecting/modifying attributes of genes and domains  
When you start, all genes and domains are shown.  Click on the ‘+’ in the 
expand/contract box to expand the listing for eac h gene to its domains. Click on the ‘-‘ to 
collapse to the gene. To select and deselect genes or domains from analysis, click in the corresponding checkbox. When a gene is selected but some domains within the gene 
are not, the checkbox for the gene will be grayed. If you deselect a gene, all domains 
within that gene are automatically deselected.   On the right side of the gene and domain hierarchy, you will find at least four columns of information for each domain and gene.  All information shown for genes is computed 
based on the domains contained. 
 
The first two columns show the site number in the sequence where the domain begins (From  column) and where it ends ( To column).  The total number of sites shown next to 
the To column indicates the total number of sites automatically computed, based on the 
range of information given in the previous two columns.  A question mark (?) shows that 
the domain exists but that the range of sites is not yet specified. 
 To specify or change sites that belong to a given domain, click on the domain name.  The corresponding rows in the From  and the To columns contain a button with three 
dots (ellipses).  To change the start site, click on the ellipses in the From  column. This 
will bring up a small Site Picker  dialog box with which you can highlight the desired site 
and click OK.  In this viewer, you will see that sites have different background colors.  A 
white background marks independent sites, a red background indicates that the site is used by another domain, and a yellow background shows that the current site belongs to the domain being edited.  To cancel any changes, click on Cancel  in the Site Picker  
dialog box. 
 
For nucleotide sequences, two additional columns are found in the Define/Edit/Select 
tab:  the Coding column and the Codon Start  column.  A check-mark in the Coding 
column shows that a given domain is protein coding.  If it is checked, then the next column allows you to specify whether the first site in the domain is in the first, second, or Appendix 
203 the third codon position. 
 
Site Labels Tab 
This tab displays sequences and allows you to label individual sites.  To do this, change 
the default underscore (_) in the topmost line to the label of choice and give it a light 
green background.  The site number will be displayed below in a window, next to which 
is shown the name of the domain, along with gene, name.   Labeled sites can be 
selected or deselected for analysis.   To change or give a label to a site, click on the site and type in the character you wish to 
mark it with. You can use the left and right arrow buttons on the keyboard to move to 
and then label adjacent sites. To change a label, simply overtype it. To remove a label, use the spacebar to type a space.  Example
 
Imagine an alignment consisting of a genomic sequence, including a gene and its 
upstream and downstream regions. You can define each intron and exon as a domain, 
and then define the overall gene, assigning the exons and introns to that gene. The 
upstream and downstream regions also can be defined as domains, or possibly multiple domains, depending on the analysis you wish to perform. These domains do not have to be assigned to any gene. Furthermore, some sites may be left unassigned, as 
independent sites. These can be scattered throughout the sequence and can be 
included or excluded from analysis as a group.  If you have a complicated patterns of sites you wish to analyze as groups, and the domain gene approach is unsuitable, you should assign a category to these sites, which can be specified in addition to the groups and domains.  
SSeelleecctt  GGeenneettiicc  CCooddee  TTaabbllee  DDiiaalloogg  
This dialog selects the desired genetic code, and edits and displays the properties of the 
genetic codes.  At present only one genetic code can be selected in MEGA  at any given 
time; it is used for all coding regions in all sequences in the data set.  To select a genetic code, click in the square box to its left. 
You can also highlight any genetic code by clicking on the text. 
You can then use the following buttons found along the top of the dialog box: 
 
Button
 Description  
Add Creates a new genetic code table.  A code table editor will be shown with 
the genetic code of the currently highlighted code table loaded. 
Delete Removes the highlighted genetic code from the list.  Note that the 
standard genetic code cannot be deleted. 
Edit Modifies the highlighted genetic code or its name.  The code table editor 
will be invoked for editing the genetic code. 
View Displays the highlighted genetic code in a printable format. 
Statistics Displays the number of synonymous  and non-synonymous sites for the 
codons of the highlighted genetic code following the Nei-Gojobori (1986) 
method.  The degeneracy values for the first, second, and third codon 
positions are displayed following Li et al. (1985). Molecular Evolutionary Genetics Analysis 
204  
8.3 Appendix C: Error Messages 
8.3.1 Blank Names Are Not Permitted 
As this error message suggests, you cannot leave the name of a sequence, taxa, 
domain, or gene blank. 
8.3.2 Data File Parsing Error 
An error occurred while parsing the input data file.  Pay close attention to the message provided, then look for the error that occurred just prior to the event indicated in the file.  
8.3.3 Dayhoff/JTT Distance Could Not Be Computed 
The Dayhoff/JTT matrix-based correction could not be applied for one or more pairs of sequences. If you wish to know which pair(s), use the Distances|Pair-wise option.  They will be shown in the Distance Matrix Dialog  with a red n/c (not computable). 
 
8.3.4 Domains Cannot Overlap 
Any given site can belong to only one domain, at most.  If you would like to assign a site or range of sites belonging to one domain to a second domain, you must first change or 
delete the definition of the first domain.   
8.3.5 Equal Input Correction Failed 
This error message means that, the Equal Input Model-based correction could not be 
applied for the amino acid distances estimation. If you wish to know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  with a red n/c (not computable). 
8.3.6 Fisher's Exact Test Has Failed 
Fisher's exact test uses estimates of the number of synonymous sites (S), the number of 
non-synonymous sites (N), the number of sy nonymous differences (Sd), and the number 
of non-synonymous differences (Nd).  It fails  for a number of reasons. If the numbers are 
very large, some mathematical functions may not be able to handle them, although we have tried to avoid this by using logarithms of factorials.  To diagnose the problem, 
compute S, N, Sd, and Nd using the Distances|Pair-wise option four times.  If you still 
cannot find the problem, please contact us 
8.3.7 Gamma Distance Failed Because p > 0.99 
For amino acid distance estimation, if the proportion of amino acids between two 
sequences that are different has exceeded 99%, the gamma distance cannot be calculated.  To know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c. Appendix 
205 8.3.8 Gene Names Must Be Unique 
MEGA  requires that all gene names in a genome be unique, although, for convenience, 
many domains can have the same name.  For example, you may want to give the name 
Exon-1 to the first exon in all genes. 
8.3.9 Inapplicable Computation Requested 
You have requested a computation that is not allowed or is unavailable for the currently 
active dataset.  If you think that this is in error, then please report this potential software bug to us. 
8.3.10 Incorrect Command Used 
The selected command or option is not valid here.  Please look at the brief description provided in the error message window to determine the nature of the problem. 
8.3.11 Invalid special symbol  in molecular sequences 
Unique ASCII characters, except letters and '*', can be used as special symbols for alignment gaps, missing data, and identical si tes.  Frequently used symbols for identical 
sites, alignment gaps, and missing data are '. ', '-', and '?', respectively.  This error 
message means that you have attempted to use the same symbols for two or more of these types of sites, or a chosen symbol is not appropriate. For example, do not use N 
(the ambiguous site symbol for DNA/RNA sequences), or X (the ambiguous site symbol 
for protein sequences) because they are alr eady available as the IUPAC symbols for 
molecular sequences. 
8.3.12 Jukes-Cantor Distance Failed 
The Jukes-Cantor correction is used to calculate nucleotide distances and synonymous 
and non-synonymous substitution distances.  If the proportion of sites that are different (nucleotides, synonymous, or non-synonymous ) is greater than or equal to 75%, the 
Jukes-Cantor correction cannot be applied.  If you see this error message, then this has 
happened for one or more pairs in your data.  If you wish to know which pair(s), use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c. 
8.3.13 Kimura Distance Failed 
The Kimura (1980) distance correction is used in a number of operations, including 
calculating nucleotide distances and synonymous and non-synonymous substitution 
distances.  These formulas cannot be applied if the argument in the logarithm approaches zero or becomes negative.  If you see this error message, then this has 
happened for one or more pairs in your data.  If you wish to know which pair(s), use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c. 
8.3.14 LogDet Distance Co uld Not Be Computed 
The formula used for calculating distances contains many log terms. If some of their 
arguments approach zero too closely or become negative the LogDet correction cannot be applied.  If you wish to know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c (not computable). Molecular Evolutionary Genetics Analysis 
206  
8.3.15 Missing data or inva lid distances in the matrix 
The selected set of taxa contains one or more pairs for which the evolutionary distance 
is either invalid or not available.  Please inspect the distance data in the Data Explorer to 
identify those pairs and remove one or more taxa, as needed. 
8.3.16 No Common Sites 
For the sequences and data subset options selected, MEGA  found zero common sites.  
If you selected the complete deletion option then you might achieve better results using 
the pair-wise deletion option, as complete deletion removes all sites containing a gap 
in any part of the alignment. If you selected the pair-wise deletion option then MEGA 
was unable to calculate the distance between one and several of the sequence pairs in 
the alignment. To identify such pairs compute a pair-wise distance matrix using the p-distance method and look for the word "n/c" in place of the pair-wise distance value.   
8.3.17 Not Enough Groups Selected 
The currently active dataset or subset does not contain enough groups to conduct the 
desired analysis.  Please define or select more groups using the Setup Taxa and Groups Dialog.  
8.3.18 Not Enough Taxa Selected 
The currently active dataset or subset does not contain enough sequences or taxa to conduct the desired analysis.  Please add or select more sequences. 
8.3.19 Not Yet Implemented 
The task you requested was not activated.  This function either was not being available in your release of MEGA  or needs to be activated by us.  Please contact the authors and 
report this software bug at your earliest convenience. 
8.3.20 p distance is found to be > 1 
This peculiar situation can occur in the com putation of the proportion of synonymous (or 
non-synonymous) substitutions per site, espe cially when the number of included codons 
is small.  If you wish to know which pair(s) of sequences has this problem, please use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix 
Dialog  with a red n/c. 
The Kimura (1980) distance correction is used in a number of operations, including 
calculating nucleotide distances and synonymous and non-synonymous substitution 
distances.  These formulas cannot be applied if the argument in the logarithm approaches zero or becomes negative.  If you see this error message, then this has happened for one or more pairs in your data.  If you wish to know which pair(s), use the Distances|Pair-wise  option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c. 
8.3.21 Poisson Correcti on Failed because p > 0.99 
For an amino acid estimation of distances, the proportion of amino acids that differ 
between two sequences has exceeded 99% and the Poisson correction distance formula cannot be applied. If you wish to know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Appendix 
207 Dialog  with a red n/c (not computable). 
 
8.3.22 Tajima-Nei Distance Could Not Be Computed 
For one or more pairs of sequences, the Tajima-Nei correction could not be applied, 
which usually occurs if the argument in the log term of the formula becomes too close to 
zero.  If you wish to know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c (not computable). 
8.3.23 Tamura (1992) Distan ce Could Not Be Computed 
For one or more pairs of sequences, the Tajima-Nei correction could not be applied. This 
usually occurs if the argument in the log term of the formula becomes too close to zero 
or if it is negative, or if the G+C-content is 0% or 100%.  If you wish to know which pair(s) of sequences has this problem, use the Distances|Pair-wise option.  All such 
pairs will be shown in the Distance Matrix Dialog  with a red n/c (not computable). 
8.3.24 Tamura-Nei Distance Could Not Be Computed 
The Tamura-Nei distance formula contains many  log terms. If some of their arguments 
approach zero too closely or become negative, the Tamura-Nei model correction cannot 
be applied.  If you wish to know which pair(s) of sequences has this problem, use the 
Distances|Pair-wise option.  All such pairs will be shown in the Distance Matrix Dialog  
with a red n/c (not computable). 
8.3.25 Unexpected Error 
While carrying out the requested task, an unexpected error has occurred in MEGA .  
Please contact the authors and report this software bug as soon as possible.  We will try 
to solve the problem at the earliest possible time. 
8.3.26 User Stopped Computation 
You have aborted the current process by pressing the Stop process  button on the 
progress indicator. 
 Molecular Evolutionary Genetics Analysis 
208 8.4 Appendix D: Glossary 
8.4.1 ABI File Format 
The ABI File Format is a binary file that  is produced by ABI sequencer software. 
This data file, referred to as a "trace file" is viewable in MEGA’s Trace File Editor, 
which is part of the Alignment Explorer. 
  
8.4.2 Alignment Gaps 
Phylogenetic analysis on two or more DNA  or amino acid sequences requires 
that the sequences be aligned so that  the substitutions can be accurately 
enumerated.  During alignment, gaps must  be introduced in sequences that have 
undergone deletions or insertions.  These gaps are known as alignment gaps or 
indels. 
 
8.4.3 Alignment session 
When working in MEGA’s Alignment Explor er you can choose to save the current 
state of all data and settings in the alignmen t explorer to a file so you can archive 
your work, or save it to resume editi ng in the future. An alignment session is a 
binary file format that is saved with the .MAS file extension.  
 
 
8.4.4 Bifurcating Tree 
A bifurcating tree is one in which each anc estral lineage gives rise to exactly two 
descendent lineages.  A tree with only bifu rcating nodes is called a bifurcating 
tree.   
 
8.4.5 Branch 
A branch is a line connecting either two internal nodes to each other or an 
external node to an internal node in a phylo genetic tree.  The length of a branch 
denotes the genetic distance (e.g., number  of substitutions per unit time) 
between the two taxa it connects.  
Branch-and-Bound algorithm
 
The branch-and-bound algorithm is used to fi nd all the MP trees.  It guarantees 
to find all the MP trees without co nducting an exhaustive search.  MEGA  also 
employs the Max-mini branch-and-bound sear ch, which is described in detail in 
Kumar et al. (1993) and Nei and Kumar (2000, page 123). 
 Appendix 
209 Close-Neighbor-Interchange (CNI)  
In any method, examining all possible topolo gies is very time consuming.  This 
algorithm reduces the time spent search ing by first producing a temporary tree, 
(e.g., an NJ tree when an ME tree is bei ng sought), and then examining all of the 
topologies that are different  from this temporary tree by a topological distance of 
dT = 2 and 4.  If this is repeated many times, and all the topologies previously 
examined are avoided, one can usually obtain the tree being sought.   
For the MP method, the CNI search can start with a tree generated by the 
random addition of sequences.  This process can be repeated multiple times to 
find the MP tree. See Nei & Kumar (2000) for details.  
8.4.6 ClustalW 
ClustalW is a general purpose multiple s equence alignment program for DNA or 
proteins. You can learn more about ClustalW by visiting its website 
(
http://www.ebi.ac.uk/clustalw/ ). 
 
8.4.7 Codon 
A codon is triplet of nucleotides that  codes for a specific amino acid. 
 
8.4.8 Codon Usage 
There are 64 (43) possible codons that code for 20 amino acids (and stop signals) so 
one amino acid may be encoded by several codons (e.g., serine is encoded by six 
codons in nuclear genes). It is therefore interesting to know the codon usage for each amino acid. In MEGA,  the numbers of the 64 codons used in a gene can be computed 
either for one specific sequence or for all examined sequences.  In addition to the codon 
frequencies, MEGA  also writes the Sharp et al. (1986) relative synonymous codon 
usage (RSCU) statistic (see Nei and Kumar 2000, page 11). 
 
8.4.9 Complete-Deletion Option 
In the complete-deletion option, sites c ontaining missing data or alignment gaps 
are removed before the analysi s begins.  This is in contrast to the pair-wise-
deletion option in which sites are remo ved during the analysis as the need arises 
(e.g., pair-wise distance computation). 
 
8.4.10 Composition Distance 
Composition distance is a measure of the difference in nucleotide (or amino acid) 
composition for a given pair of sequences .  It is one half the sum of squared 
difference in counts of bases (or residues ).  MEGA 4 computes and presents the 
Composition Distance per site, which is given by the total composition distance Molecular Evolutionary Genetics Analysis 
210 between two sequences divided by the number  of positions compared, excluding 
gaps and missing data. 
 
 
8.4.11 Compress/Uncompress 
This command changes the cursor to the 'Compress/Uncompress' icon.  If you 
click on an interior branch, MEGA  will prompt you to give a name to the group 
that will be formed.  It then will compress all the lineages defined by this branch 
into a solid elongated triangle whose thi ckness is proportional to the number of 
taxa condensed. Clicking on the branch again will uncompress it. 
The cursor may be reverted to the arrow by clicking on the arrow icon on the left 
hand side of the Tree Explorer. 
 
8.4.12 Condensed Tree 
When interior branches in a phylogenetic tr ee do not have statistically significant 
lengths, choosing this command condenses the tree into a topology in which 
each branch with less than the desired stat istical significance is collapsed. 
 
Consensus Tree  
The MP method produces many equally parsimonious trees.  Choosing this 
command produces a composite tree that is a consensus among all such trees, 
for example, either as a strict cons ensus, in which all conflicting branching 
patterns among the trees are resolved by  making those nodes multifurcating or 
as a Majority-Rule consensus, in which conflicting branching patterns are 
resolved by selecting the pattern s een in more than 50% of the trees. 
 (Details are given in Nei and Kumar [2000], page 130). 
 
8.4.13 Constant Site 
 A site containing the same nucleotide or amino acid in all sequences is referred 
to as a constant site.  MEGA  identifies a site as a const ant site only if at least two 
sequences contain unambiguous nucl eotides or amino acids.  
 
8.4.14 Degeneracy 
0-fold degenerate sites  are those at which all changes are non-synonymous. 
2-fold degenerate sites  are those at which one out  of three changes is 
synonymous.  (All sites at which two out of three changes are synonymous also 
are included in this category.) 
4-fold degenerate sites  are those at which all changes are synonymous. 
8.4.15 Disparity Index 
Disparity Index measures the observed di fference in substitution patterns for a Appendix 
211 pair of sequences.  It works by com paring the nucleotide (or amino acid) 
frequencies in given pair of sequences  and using the number of observed 
differences between sequences.  MEGA 4 computes and presents the Disparity 
Index per site, which is given by the total disparity index between two sequences 
divided by the number of positions com pared, excluding gaps and missing data.  
It is more powerful than a chi-square test of the equality of base frequencies 
between sequences. 
 
 
8.4.16 Domains 
A domain is a continuous block of site s in a sequence alignment.  A domain can 
be free-standing or assigned to genes and protein-coding (e.g., exons) or non-
coding (e.g., introns). Domains can be defined in the input data, and can be 
defined and edited in the Se tup Genes Domains dialog. 
 
8.4.17 Exon 
A protein-coding gene typically consists  of multiple coding regions, known as 
exons, interspersed with non-coding DNA (introns) 
 
8.4.18 Extant Taxa 
The taxa whose sequences, other genetic information or morphological 
characters, etc. are being used for a phyl ogenetic analysis are known as extant 
taxa, irrespective of whether the indivi duals or species to which the sequences 
and other information belong ar e extant or extinct.  
 
8.4.19 Flip 
This command changes the cursor to t he 'Flip' icon. Then, if you click on an 
interior branch, MEGA  reverses the order of the li neages defined by this branch. 
The cursor will revert to the arrow if  you click on the arrow icon on the left hand 
side of the Tree Explorer.   
 
8.4.20 Format command 
A format command in a data file begins with! Format and contains at least the 
data type included in the file.  
8.4.21 Gamma parameter 
According to the gamma distribution, the subs titution rate often va ries from site to 
site within a sequence.  The shape of this  distribution is determined by a value 
known as the gamma parameter, which is also known as the shape parameter.  
 Molecular Evolutionary Genetics Analysis 
212 8.4.22 Gene 
A gene is a collection of domains. The domains included in a gene need not be 
consecutive or of the same  type.  Genes and domains can be defined in the input 
data, and can be defined and edited in t he Setup Genes and Domains dialog.  
Genes can be selected or unselect ed from an analysis.  When a gene is 
unselected, all its domains are automa tically unselected. However, a gene can 
be selected, with some of its domains unselected. 
 
8.4.23 Groups of taxa 
A group of taxa is a set of one or more taxa. Members of a group can be 
specified in the input data file, and created and edited in the Setup Taxa and 
Groups dialog. 
Groups of taxa often are constructed bas ed on their evolutionary relatedness.  
For example, sequences may be grouped ba sed on the geographic origin of the 
source individual, or sequences from a multi-gene family may be arranged into 
groups consisting of orthologous sequences. 
 
8.4.24 Indels 
Phylogenetic analysis on two or more DNA  or amino acid sequences requires 
that the sequences be aligned so that  the substitutions can be accurately 
enumerated.  During the alignment, gaps must be introduced in sequences that 
have undergone deletions or insertions.  These gaps are known as alignment 
gaps, or indels. 
 
8.4.25 Independent Sites 
In a sequence alignment, all sites that have not been assigned to any gene or 
domain are classified as independent. 
 
8.4.26 Intron 
Introns are the non-coding segments of DNA in a gene that are interspersed 
among the exons.  
 
Labeled Sites  
Sites in a sequence alignment can be ca tegorized and labeled with user-defined 
symbols. Each category is represented by a letter or a number. Each site can be 
assigned to only one category, although any  combination of categories can be 
selected for analysis. 
Labeled sites  work independently of and in addition to genes and domains, thus 
allowing complex subsets of  sites to be defined easily. 
 Appendix 
213 8.4.27 Maximum Composite Likelihood 
In general, a composite likelihood is def ined as a sum of log-likelihoods for 
related estimates. In MEGA4, the ma ximum composite likelihood is used for 
describing the sum of log-likelihoods fo r all pair-wise distances in a distance 
matrix (Tamura et al. 2004) estimated by using the Tamura-Nei (1993) model 
(see related Tamura-Nei distance). Furt her information is in the Maximum 
Composite Likelihood Method. 
 
8.4.28 Max-mini branch-and-bound search 
This is an algorithm for searching for the MP tree using the branch-and bound 
search method.  See Nei & Kumar (2000) for details. 
 
8.4.29 Maximum Parsimony Principle 
For any given topology, the sum of the minimum possible substitutions over all 
sites is known as the tree length for that topology.  The topology with the 
minimum tree length is known as the Maximum Parsimony tree. 
 
8.4.30 Mid-point rooting 
In the mid-point rooting me thod, the root of an unroot ed tree is placed at the mid-
point of the longest distance bet ween two taxa in a tree.  
 
Min-mini algorithm  
This is a heuristic search algorithm for finding the MP tree, and is somewhat 
similar to the branch-and bound search meth od.  However, in this algorithm, 
many trees that are unlikely to have a sm all local tree length are eliminated from 
the computation of their L values. Thus while the algorithm speeds up the search 
for the MP tree, as compared to the branch-and-bound search, the final tree or 
trees may not be the true MP tree(s).  The user can spec ify a search factor to 
control the extensiven ess of the search and MEGA  adds the user specified 
search factor to the current local upper bound.  Of course, the larger the search 
factor, the slower the search, since many more trees will be examined.   
 (See also Nei & Kumar (2000), pages 122, 125)  
 
8.4.31 Monophyletic 
A cluster of taxa that shared a common ancestor comparatively recently in the 
evolutionary history of  a phylogenetic tree is monophyleti c.  The term reflects the 
close relationship of the taxa with each other. 
8.4.32 mRNA 
Protein-coding genes are first transcribed  into messenger RNAs (mRNA), which Molecular Evolutionary Genetics Analysis 
214 are, in turn, translated  into amino acid sequences to make proteins. 
 
8.4.33 NCBI 
An acronym that stands for "National  Center for Biotechnology Information". 
NCBI is a federally funded resource fo r molecular biology information. NCBI 
creates databases, conducts research in  computational biology, develops 
software and tools for analyzing genome data, and disseminates biomedical 
information. You can find out more about NCBI by visiting the NCBI website 
(http://www.ncbi.nlm.nih.gov ).  
 
 
8.4.34 Newick Format 
NEWICK is a simple format used to write out trees in a text file.  While this is a 
hard-to-read format for humans, it is ve ry useful for exchanging trees between 
different types of software . An example of the content s of a NEWICK format tree 
file is given below (note that semi-c olon is needed to end the tree).  Further 
information on this format can be found at Joe Felsenstein’s website.  
 
((raccoon, bear),((sea_lion,seal),((monkey,cat), weasel)),dog); 
The above tree with branch lengths will look as follows: 
((raccoon:19.19959,bear:6.80041):0.84600,((sea_lion:11.99700, seal:12.00300):7.52973,((monkey:100.85930,cat:47.14069):20.59201, 
weasel:18.87953):2.09460):3.87382,dog:25.46154); 
If you wish to specify bootstrap values then they could appear before 
the branch lengths (e.g., in .
DND files produced by CLUSTAL) or after 
the branch lengths (e.g., in .PHB files produced by CLUSTAL).  In these 
cases, the format might look like: ((raccoon:19.19959,bear:6.80041)50:0.84600,((sea_lion:11.99700, seal:12.00300)100:7.52973,((monkey:100.85930,cat:47.14069)80:20.59201, 
weasel:18.87953)75:2.09460)50:3.87382,dog:25.46154); 
or ((raccoon:19.19959,bear:6.80041):0.84600[50],((sea_lion:11.99700, seal:12.00300):7.52973[100],((monkey:100.85930,cat:47.14069):20.59201[80], weasel:18.87953):2.09460[75]):3.87382[50],dog:25.46154); 
 
 
8.4.35 Node 
A node in a phylogenetic tree represents a taxon, the external  or terminal nodes  
represent the extant taxa and the internal nodes  represent the ancestral taxa. 
 
8.4.36 Non-synonymous change 
A nucleotide change is non-synonymous if it changes the amino acid encoded by 
the original codon.  A nuc leotide site in which one or more changes are non-
synonymous is referred to as a non- synonymous site.  If only one of three 
possible nucleotide changes at that site is non-synonymous, then the site is 1/3 Appendix 
215 non-synonymous.  If two of three nucl eotide changes are non-synonymous, then 
the site is 2/3 non-synonymous.  And, if all three possible nucleotide changes are 
non-synonymous, then the site is completely non-synonymous. 
 
8.4.37 Nucleotide Pair Frequencies 
When two nucleotide sequences are compared, the frequencies of 10 or 16 different 
types of nucleotide pairs can be computed. In MEGA,  these frequencies are presented 
in a text file. 
 
8.4.38 OLS branch length estimates 
 The ordinary least squares estimate of a branch length ( b) is given by 
 
where dij is the pair-wise distance between sequences i and j.  The coefficients 
wij’s depend on whether the branch under consi deration is internal or external.   
Coefficients w ij’s for an internal branch 
 
where, mA, mB, mC, and mC are the numbers of sequences in clusters A, B, C, 
and D, respectively. 
 
Coefficients w ij’s for an external branch 
 
 where, mA and mB are the numbers of sequences in clusters A and B. 
 
8.4.39 Orthologous Genes 
Two genes are said to be orthologous if they  are the result of a speciation event. 
8.4.40 Out-group 
An out-group is a sequence (or set of sequences) that is known to be a sister 
taxa to all other sequences in the dataset. Molecular Evolutionary Genetics Analysis 
216 8.4.41 Pair-wise-deletion option 
In the pair-wise-deletion option, sites c ontaining missing data or alignment gaps 
are removed from the analysis as t he need arises (e.g., pair-wise distance 
computation). This is in c ontrast to the complete-delet ion option in which all such 
sites are removed prior to the analysis. 
 
8.4.42 Parsimony-informative site 
A site is parsimony-informative if it cont ains at least two types of nucleotides (or 
amino acids), and at least two of them  occur with a minimum frequency of two. 
 
8.4.43 Polypeptide 
A polypeptide is a chain of many amino acids. 
 
8.4.44 Positive selection 
At the DNA sequence level, positive selectio n refers to selection in favor of non-
synonymous substitutions.  In this case , the evolutionary distance based on non-
synonymous substitutions is expected to be greater than synonymous 
substitutions.  
8.4.45 Protein parsimony 
A Maximum Parsimony analysis 
on protein sequences is known as protein 
parsimony. 
 
8.4.46 Purifying selection 
Purifying selection refers to selecti on against non-synonymous substitutions at 
the DNA level.  In this  case, the evolutionary distance based on synonymous 
substitutions is expected to be greater than the distance based on non-
synonymous substitutions.  
8.4.47 Purines 
The nucleotides adenine (A) and guanine (G) are known as purines. 
 
8.4.48 Pyrimidines 
The nucleotides cytosine (C) and thymi ne (T) are known as pyrimidines. 
8.4.49 Random addition trees This refers to the generation of random init ial trees for a heuristic search to find 
MP trees.  In this case, a tree is g enerated by randomly selecting a sequence Appendix 
217 and adding it to the growing tr ee on a randomly-selected branch. 
 
8.4.50 RSCU 
Many amino acids are coded by more than one codon; thus multiple codons for a 
given amino acid are synonymous.  Ho wever, many genes display a non-random 
usage of synonymous codons for specific am ino acids.  A measure of the extent 
of this non-randomness is given by the Relative Synonymous Codon Usage 
(RSCU) (Sharp et al. 1986).  The RSCU for a particular codon (i) is  given by                              
 RSCU
i  =  Xi / ∑∑ XI /n 
where Xi is the number of times the ith codon has been used for a given amino 
acid, and n is the number of synonymous codons for that amino acid. 
 
8.4.51 Singleton Sites 
A singleton site contains at least two types  of nucleotides (or amino acids) with, 
at most, one occurring multiple times.  MEGA  identifies a site as a singleton site 
if at least three sequences contain unambi guous nucleotides or amino acids.  
 
Site Label  
The individual sites in nucleotide or am ino acid data can be labeled to construct 
non-contiguous sets of sites.  The Se tup Genes and Domains dialog can be used 
to assign or edit site labels, in addition to  specifying them in the input data files. 
This is shown in the following example of  three-sequences in which the sites in 
the Third Gene are labeled with a ‘+’ ma rk.  An underscore marks an absence of 
any labels. 
 
!Gene=FirstGene  Domain=Exon1  Property=Coding; 
#Human_{Mammal}  ATGGTTTCTAG TCAGGTCACCATGATAGGTCTCAAT 
#Mouse_{Mammal}  ATGGTTTCTAG TCAGGTCACCATGATAGGTCCCAAT 
#Chicken_{Aves}  ATGGTTTCTAGTCAGCTCACCATGATAGGTCTCAAT  
!Gene=SecondGene  Domain=A nIntron Property=Noncoding; 
#Human     ATTCCCAGGGAATTCCCGGGGGGTTTAAGGCCCCTTTAAAGAAAGAT 
#Mouse     GTAGCGCGCGTCGTCA GAGCTCCCAAGGGTAGCAGTCACAGAAAGAT 
#Chicken   GTAAAAAAAAAAGTCAGAGCT CCCCCCAATATATATCACAGAAAGAT 
 !Gene=ThirdGene  Domain=Exon2  Property=Coding; #Human      ATCTGCTCTCGAGT ACTGATACAAATGACTTC TGCGTACAACTGA 
#Mouse      ATCTGATCTCGTGTGCTGGTACGAATGATTTCTGCGTTCAACTGA #Chicken    ATCTGCTCTCGAGTAC TGCTACCAATGACTTCTGCGTACAACTGA 
!Label      +++__-+++-a-+++-L -+++-k-+++123+++-_-+++---+++; 
 
Each site can be associated with only one label.  A label can be a letter or a number. 
For analyses that require codons, MEGA  includes only those codons in which all 
three positions are given the same label.  This site labeling system facilitates the Molecular Evolutionary Genetics Analysis 
218 analysis of specific sites, as often is required for comparing sequences of 
regulatory elements, intron-splice sites,  and antigen recognition sites in the 
genes of applications such as the Major Histocompatibility Complex. 
 
8.4.52 Staden 
The Staden file format is used to stor e data from DNA sequencing instruments. 
Each file contains the data for a si ngle reading and includes the called sequence 
as well as additional data obtained from the reading. This f ile format was first 
described in  
 Dear, S and Staden, R. "A Standard file format for data from DNA 
sequencing instruments", DNA  Sequence 3, 107-110, (1992) 
MEGA is able to display the contents of a Staden-formatted trace file using MEGA’s Trace File Editor, which is  part of the Ali gnment Explorer. 
 
8.4.53 Statements in input files 
All statements in MEGA  files start with an exclam ation mark (!) and end with a 
semicolon (;).  They are useful in specif ying various attributes  of the data and the 
data file.  There are three common st atements for all types of data: Title, 
Format , and Description .  There also are other statements that can be used 
in MEGA  files, depending on the ty pe of data being analyzed. 
 
8.4.54 Swap 
This command changes the cursor to t he 'Flip' icon.  Then, you click on an 
interior branch, MEGA  swaps the two subtrees defined by this branch.  If each of 
the subtrees is an indi vidual taxon, then Swap is the same as Flip. 
The cursor will revert to the arrow if  you click on the arrow icon on the left-hand 
side of the Tree Explorer. 
 
8.4.55 Synonymous change 
A nucleotide change is synonymous if it does not cause the codon to code for a 
different amino acid.  A nucleotide site in which one or more changes is 
synonymous is referred to as a synonym ous site.  If only one of three possible 
nucleotide changes at that si te is synonymous, then the site is 1/3 synonymous.  
If two of three nucleotide changes ar e synonymous, then the site is 2/3 
synonymous and 1/3 non-synonymous.  And,  if all three possible nucleotide 
changes are synonymous, then the site is completely synonymous.  
8.4.56 Taxa 
A taxon is the individual unit whos e evolutionary relationship is being 
investigated.  Depending on the study, "taxa"  may refer to spec ies, populations, 
individuals, or sequences within an individual. Appendix 
219  
8.4.57 Topological distance 
The topological distance quant ifies the extent of topolog ical differences between 
two given trees.  For unrooted, bifurcating trees, this distance is twice the number 
of interior branches at which t he taxa are partitioned differently. 
 
8.4.58 Topology 
The branching pattern of a tree is its topology. 
 
8.4.59 Transition 
A transition occurs when a purine is substi tuted by a purine, or a pyrimidine by a 
pyrimidine. 
 
8.4.60 Transition Matrix 
A transition matrix specif ies the probability of every possible substitution among 
the nucleotides or amino acids. 
 
8.4.61 Transition/Transversion Ratio (R) 
This is the ratio of the num ber of transitions to the num ber of transversions for a 
pair of sequences.  R becomes 0.5 when there is no bias towards either 
transitional or transversional substitu tion because, when the two kinds of 
substitution are equally probable, there ar e twice as many possible transversions 
as transitions.   MEGA  allows you to conduct an analysis of your data with a 
specified value of R.  
Note that R should not be confused with the ratio of the transition and 
transversion rates ( k = α/β).  
 
8.4.62 Translation 
Translation is the process whereby each c odon in the mRNA is translated into a 
particular amino acid, according to the genetic code specific to the species and 
its DNA, and added to the gro wing polypeptide chain. 
 
8.4.63 Transversion 
A change from a purine to a pyrimidine, or vice versa, is a transversion. 
 
8.4.64 Unrooted tree 
An unrooted tree is one in which no assu mption is made regarding the ancestor 
of all the taxa in the tree. Molecular Evolutionary Genetics Analysis 
220 8.4.65 Variable site 
A variable site contains at least two types  of nucleotides or amino acids.  Some 
variable sites can be singleton or parsimony -informative.  A site that is not 
variable is referred to as a constant site. 
  
221 9 Index 
0 
0-fold site .................................................228 
2 
2-Dimensional Data Grid 115, 149, 255, 259 
2-fold site .................................................228 
2S-fold site...............................................228 
2V-fold site...............................................228 
4 
4-fold si te ........................ 225, 226, 228, 327 
A 
ABI File Format ........................................397 
About BLAST.............................................63 About CLUS TALW.....................................60 
About dial og.....................................365,  367 
Acknowledgements .....................................4 
Add butto n ...............................................368 
Add taxa ...........................................368, 370 
Add/Inse rt ................................................370 
Add/Remove Programs ...............................9 
Adding/Modifying Genetic Code Tables ..111 
Alanine .......................................................84 
Aligning coding sequences via protein 
sequences .........................................60, 310 
Alignment Bu ilder...............................57, 307 
Alignment Explorer/CLUSTAL.................362 Alignment Gap................ 238, 245, 247, 367 
Alignment Menu.......................................361 
Alignment Menu in Alignment Explorer ....67, 
313 
Alignment session....................................399 
Amino Acid Composit ions........147, 180, 291 
Analysis Preferences..... 229, 233, 236, 240, 250, 252 
Analysis Prefer ences dialog ....................177 
Analysis Preferences/Options dialog.......177 
Arrange Taxa...........................................301 
ASCII .................... 49, 77, 83, 154, 165, 173 editing ................................................ 49, 154 
ASCII-text ..................................................77 
Asparagine.................................................84 
Aspartic Acid..............................................84 Assignin g .................................................370 
exons .......................................................370 
Average Menu .................................153, 257 
B 
Basic Sequence Statisti cs .......................179 BCL ......................................................... 243 
Between Gr oups ..................................... 257 
Bidirectionally .......................... 145, 181, 289 
Bifurcatin g Tree....................................... 400 
Blank Names Are Not Permitted............. 372 
BLAST Search .......................................... 64 Bootstrap me thod............................ 233, 245 
compute standard error .................. 233, 245 
Bootstrap Te st................................. 244,  352 
Bootstrap Test of Phylogeny........... 244, 352 Branch Le ngth......................................... 304 
Branch Line............................................. 304 
Branch tab............................................... 304 
Branch-and-b ound .......................... 240,  358 
Browse Da tabanks.................................. 363 
Bugs.......................................................... 31 
Reporting .................................................. 31 Built-in Geneti c Codes ............................ 109 
C 
Categori ze............................................... 151 
taxa ......................................................... 151 
Change Font ................................... 152, 258 
Change Font dial og box.................. 131, 275 
Change Font.Dis play ...................... 131, 275 
Choose Mo del......................................... 345 
Circle ....................................................... 301 
Citing MEGA in Publications....................... 6 
Classroom................................................. 29 
Clipboard ......................................... 169, 170 
Close Da ta .............................................. 331 
Close-Neighbor-Interchange........... 242, 403 
CLUSTAL.................................................. 94 Clusta lW.................................................. 404 
CLUSTALW Opti ons DNA ........................ 61 
CLUSTALW Options Protein .................... 62 CNI.................................................. 242, 403 
Code T able ............................................. 112 
Code Table Editor................................... 115 
Coding......................... 85, 87, 115, 259, 370 
DNA ................................................ 115, 259 
Codon .... 109, 112, 115, 123, 146, 179, 180, 182, 225, 229, 233, 236, 240, 250, 252, 259, 
267, 290, 326, 327, 344, 370, 372, 406 
find .......................................................... 115 inclusion/exclusion. 229, 233, 236, 240, 250, 
252 
positio n.................................................... 115 
Codon based Z-test ................................ 325 
Codon Usage.................. 146, 182, 290, 406 
Color Cell s ...................................... 127, 271 
Column Size r .................................. 149, 255 Molecular Evolutionary Genetics Analysis 
222 Command Statement s...................86, 87, 92 
Keywor ds...................................................87 
Writing ............................................86, 87, 92 
Common Feat ures.....................................77 
Common Si tes .........................................387 
Complete-Del etion...................................245 
Complex 2-fold  sites ................................228 
Composition Distance..............................408 
Compute Between Groups Means ..........351 
Compute Menu ........................................307 
Compute Net Between Groups Means....350 
Compute Over all Mean............................347 
Compute Pair -wise ..................................346 
Compute Sequence  Diversity..................349 
Compute standard error ..................233, 245 
Bootstrap me thod ............................ 233, 245 
Compute Within Groups Mean ................348 
Computing ...................... 112, 222, 228, 323 Statistical A ttribut es .................................112 
statisti cs...................................................323 
Computing Statistical Quantities for Nucleotide S equences...............................45 
Computing the Gamma Parameter (a) ...195, 220 Condensed Trees ....................................243 
Construct ........................ 233,  244, 357, 358 
Constructing Trees and Selecting OTUs from Nucleotide Sequences ......................38 
Constructing Trees from Distance Data ....47 
Convert To MEGA Format Main File Menu
...................................................................96 
Copy ........................................................170 
Copyri ght .....................................................1 
CPU .............................................................7 Create New Folder...................................328 
Creating Multiple Sequence Alignments ..34, 
58, 308 
Curved .....................................................301 Cut ...........................................................169 
Cutoff Values  Tab....................................299 
Cysteine.....................................................84 
D 
Data ......................................... 367, 370, 386 
Missing .............................................367, 386 
Data | Data Explorer ................329, 331, 335 
Data | Quit Data Viewer...................124, 268 
Data | Select Genetic Code Table..113, 120, 
264, 341 Data | Select Preferences339, 340, 343, 344 
Data | Setup/Select Genes .....122, 175, 266, 
337 Data | Setup/Select Taxa... 89, 93, 121, 265, 
336 
Data | Translate/Untranslate............119, 263 
Data | Write Data ............................. 123, 267 Data Descript ion Window ....................... 327 
Data Explorer. 118, 262, 323, 329, 335, 368, 
387 
Data File Pars ing Error ........................... 373 
Data menu32, 113, 117, 118, 120, 121, 122, 
261, 262, 264, 265, 266, 329, 334, 341 
Data Menu in Alignment Explorer..... 70, 316 Data Type ....................................... 335, 367 
Dataf ile...................................................... 80 
DataForm at............................................... 91 
Dataset..... 91, 115, 119, 146, 180, 182, 259, 
263, 290, 331, 380, 388, 389 
DataType ...................................... 83, 85, 91 
Dayhoff and JTT distances Gamma rates
................................................................ 221 
Dayhoff di stance ..................................... 222 
Dayhoff Distance Could Not Be Computed
................................................................ 374 
Dayhoff Mo del......................................... 220 
Define/Edit/S elect ................................... 370 
Defining Genes ......................................... 86 
Defining Gr oups.................................. 87, 92 
DefiningTaxa ............................... 89, 93, 336 
Description Stat ement Rules .................... 82 
Disclaimer ................................................... 2 
Discrete-cha racter................................... 233 
Disparity Index ........................................ 414 
Display | Co lor................................. 127, 271 
Display | Restore Input Order ......... 125, 269 
Display | S how ................................ 126,  270 
Display | Show Group Names......... 130, 274 
Display | Show Sequence Names .. 129, 273 
Display | Sort Sequences....... 132, 133, 134, 
135, 136, 276, 277, 278, 279, 280 
Display | Use Identical Symbol ....... 128, 272 Display f ont ..................................... 131,  275 
Display Menu .................. 124, 152, 258, 268 
Display Menu in Alignment Explorer. 68, 314 Display Newick Trees from File ........ 94, 355 
Display Saved Tr ee Session................... 354 
Distance Com putation ............................ 229 
Distance Correc tion Fail ed ..................... 384 
Distance Data Explorer.. 149, 151, 152, 153, 
178, 255, 259 Distance Data  Formats ............................. 90 
Distance Data Subset Selection ............. 178 
Distance Display Precision ............. 149, 255 
Distance esti mates.......................... 233, 245 
Distance Matrix Dialog... 378, 383, 384, 391, 392, 393, 394, 395 Distance Matrix Explorer 153, 255, 257, 258, 
259 
Distance menu................ 324, 327, 344, 349 
Distance Mode l Options.......................... 232 
Distance Op tions............................. 250, 252 
Distances ........ 115, 119, 183, 259, 263, 325 Index 
223 Distances | Choo se Model.......................345 
Distances | Compute Between Groups 
Means.Ch oose.........................................351 
Distances | Compute Net Between Groups 
Means.Ch oose.........................................350 
Distances | Compute Overall Mean.........347 Distances | Compute Pair-wise ...............346 
Distances | Compute Sequence Diversity
.................................................................349 
Distances | Compute Within Groups Means.Ch oose.........................................348 
Distances Disp lay Box.............................154 
Distances Menu.......................................344 
Divergence Time..............................297, 306 
Divergence Time Dialog Box...................300 
DNA ..... 77, 85, 94, 115,  124, 127, 180, 233, 
245, 259, 268, 271, 335 coding .............................................. 115, 259 
reading data from ot her formats ................94 
DNA/RNA........................................... 84, 382 
Do BLAST Search .....................................64 Domain Editor..........................................370 
Domains... 86, 122, 144, 145, 146, 147, 175, 
181, 182, 266, 288, 289, 290, 291, 337 Domains Cannot  Overlap ........................375 
Domains Di alog .......................................370 
Drag-and-d rop .........................................370 
Drosophila mitochondrial genetic code table
.................................................................109 
E 
Edit | Copy ...............................................170 
Edit | Cut ..................................................169 
Edit | Font ................................................173 
Edit | Paste ..............................................171 
Edit | Undo ...............................................172 
Edit menu ...........................................49, 154 
Edit Menu in Alignment Explorer .......69, 315 
Edit Sequence r Files ...............................365 
Edits................................................... 49, 154 
ASCII .................................................49, 154 
EMF .........................................................296 
End ......................................................85, 87 Entire Popul ation .....................................349 
Mean Divers ity.........................................349 
Equal Input Correc tion Failed..................376 
Equal Input  Model ....................................218 
Equal Input M odel Gamma......................196 
Equal Input Model Gamma rates and Heterogeneous Patterns..........................210 
Equal Input Model Heterogeneous Patterns
.................................................................222 
Estimate ...........................................222, 349 
Dayhoff di stance ......................................222 
interpopulational  diversity........................349 
Estimating Evolutionary Distances from Nucleotide S equences.............................. 36 
Exclude/include sites ...................... 123, 267 
Exit .................................. 168, 259,  332, 334 
Distance Data  Explor er........................... 259 
MEGA ..................................................... 334 
Exit Tree Ex plorer ................................... 295 
Exon............................................ 85,  87, 370 
Expand/contra ct box ............................... 370 
Export All Trees ...................................... 295 
Export Curren t Tree ................................ 295 
Export Data............................. 123, 267, 329 Export/Print Dist ances .................... 151, 259 
Exporting Sequence  Data............... 123, 267 
Exporting Sequence Data dialog .... 118, 262 
F 
Feature List............................................... 19 
File menu .................. 49, 151, 154, 259, 327 
File M enu ................................................ 334 
File Na me................................................ 328 
Files ................................ 123, 267, 295, 328 
Data | Write Data ............................ 123, 267 
Tree Expl orer .......................................... 295 
Type ........................................................ 328 
Files Of Type........................................... 328 
Find ......... 115, 173, 174, 242, 324, 357, 403 
codon ...................................................... 115 
ME........................................................... 357 
MP................................................... 242,  403 
number.................................................... 324 
Find Agai n............................................... 174 
Find Text dialog ...................................... 173 
Fisher's Exac t Test ......................... 252, 361 
Selectio n ................................................. 361 
Fisher's Exact Test Has Failed ............... 377 Fixed Column.................. 115, 149, 255, 259 
Fixed Row....................... 115,  149, 255, 259 
Font ......................................................... 173 
Font dialog .............................. 124, 268, 305 
Format di alog.......................................... 367 
Format Statem ent ......................... 83, 85, 91 
Keywords ............................................ 85, 91 
Rules......................................................... 83 Formats....................................... 77, 90, 328 
G 
G+C-conten t ................................... 191, 394 
Gamma ................... 197, 198, 201, 222, 378 
Gamma Correction Failed Because p..... 378 
Gamma dist ance..................................... 222 
Gamma model ........................................ 201 
Gaps ....................................................... 343 
Handling.................................................. 343 
Gene Names Must Be Unique................ 379 
General Comments on Statistical Tests . 242 Molecular Evolutionary Genetics Analysis 
224 General Considerations.......................83, 90 
Genes ................................................86, 370 
Genes/Domains.........................................87 
Genes\Do main.........................................370 
Genetic Code...........................................112 
Glutamic Acid.............................................84 Glycine.......................................................84 
Gojobo ri ................................................... 252 
Grid ................................. 115,  149, 255, 259 
Grishin's di stance ....................................222 
Group Name ....................................133, 277 
Groups... 87, 89, 92, 93, 115, 118, 121, 134, 149, 153, 257, 259, 262, 265, 278, 336, 348, 
350, 351 
taxa .... 87, 92, 115, 118, 149, 153, 257, 259, 262, 348, 350, 351 
Groups Di alog..........................................368 
H 
Hand-with-a-pen cil icon ...........................368 
Help ............................................. 6, 327, 368 
Help | About .............................................367 
Help Inde x........................................365, 366 
Help menu ................................... 6, 327, 365 
Hiding taxa...............................................258 
Highlight | Parsim-Info Sites ............140, 284 
Highlight 0-fold Deg enerate Sites....141, 285 
Highlight 2-fold Deg enerate Sites....142, 286 
Highlight 4-fold Deg enerate Sites....143, 287 
Highlight Conserved Sites ...............137, 281 
Highlight Me nu.................................136, 280 
Highlight Singlet on Sites..................139, 283 
Highlight Variabl e Sites ...................138, 282 
Highlighted Si tes..............................149, 293 
Highlightin g......................................115, 259 
Sites.................................................115, 259 
Histidine.....................................................84 
I 
ID .................... 133, 134, 136, 277, 278, 280 
Identic al .....................................................85 
Identical Symbol ......................................367 
Image Menu.............................................296 Importing Data From Other Formats .........94 
Inapplicable Computation Requested .....380 Include Codon Positions..........................339 
Include Label ed Site s ..............................340 
Include Site s Opti on ................................248 
Include/excl ude................................115, 259 
Include/Exclude taxa ...............149, 255, 368 
Including ........................................ 6, 94, 301 
CLUSTAL...................................................94 
MEGA ..........................................................6 
taxon ........................................................301 
Inclusion/exclusion of codon positions/labeled sites.... 229, 233, 236, 240, 
250, 252 
Inconsistenc ies ................................. 31, 328 
Incorrect Co mmand Us ed....................... 381 
Increase/decr ease .......................... 149, 255 
Indel .......................................... 85,  238, 247 
Independent s node ................................. 370 
Index ....................................................... 366 
Informati on Box....................................... 294 
Input Data Form at Dial og........................ 367 
Insert genes or domains ......................... 370 
Insertions/del etions......................... 238, 247 
Installing MEGA .......................................... 8 
Intergenic do mains ................................. 370 
Interior Branch  Test ........................ 243, 353 
Interpopulational  diversity ....................... 349 
estimate .................................................. 349 
Introduction to Walk Through MEGA........ 32 Intron........................................... 85,  87, 370 
Intron Property .............................. 86, 87, 92 
Invalid dist ances ..................................... 386 
Invalid specia l sym bol............................. 382 
Isoleucine.................................................. 84 IUPAC single letter codes......................... 84 
J 
Jukes-Cantor................... 188, 223, 224, 383 
Jukes-Cantor Correction Failed.............. 383 
Jukes-Cantor distan ce ............................ 187 
Jukes-Cantor Gamma distance .............. 197 
K 
Keywords ...................................... 85, 87, 91 
Command Stat ements .............................. 87 
Format Stat ement ............................... 85, 91 
Kimura 2-parame ter dist ance ................. 189 
Kimura gamma distan ce ......................... 198 
Kimura-2-parameter-Gamma distance ... 198 Kumar Method ........................................ 228 
Kumar@megasoftware.net................... 1, 29 
L 
Labels Ta b .............................................. 370 
Large Sample Tests of Selection............ 248 
Leaf taxa ................................................. 294 
Leucine ..................................................... 84 
Level of  CP ............................................. 243 
Linux ........................................................... 7 
Listin g...................................................... 368 
taxa ......................................................... 368 
Li-Wu- Luo ............................................... 228 
Li-Wu-Luo Me thod .................................. 225 
LogDet Distance Could Not Be Computed
................................................................ 385 
Look In .................................................... 328 Index 
225 M 
Main MEGA Window ...............................327 
Managing Taxa Wi th Groups.....................44 
Manipulating tr ee aspects........................303 
Marker Gr aphics ......................................305 
MatchChar .................................................85 
Matrix .......................................................386 
Matrix Ex plorer .........................................259 
Matrix Fo rmat...........................................367 
Maximum Composite Likelihood......195, 429 
Maximum Composite Likelihood Gamma 
Rates and Heterogeneous Patterns ........216 
Maximum Composite Likelihood Heterogeneous Patterns..........................210 
Maximum Composite Likelihood Method 195 Maximum Composite_Likelihood Gamma
.................................................................205 
Maximum Pars imony ....................... 240, 358 
Maximum-likeli hood.........................243, 358 
Max-mini branch-and-bound search........430 
ME .......................... 234, 243, 244, 356, 357 
ME Tree Tab............................................357 
Mean Divers ity.........................................349 
Entire Popul ation .....................................349 
Interpopulational  Diversity .......................349 
MEG.........................................................328 MEGA 
citing ............................................................6 classroom use............................................29 
exiting ......................................................334 
Installin g.......................................................8 
MEGA Format............................................77 MEGA Software Development Team ..........5 Menu bar ............................................49, 154 
Menus ......................................................326 Methionine .................................................84 Microsoft Word...........................................77 
Midpoint ...................................................301 
Minimum Evolution ..................234, 236, 357 Minimum Evolution Construct Phylogeny357 
Missing .............................................367, 386 
data..........................................................386 
Data .........................................................367 
Missing Da ta............................................343 
Missing Informatio n .................238, 245, 247 
Models ............................................. 183, 188 
Nei ...........................................................188 
Modified Nei- Gojobo ri..............................252 
Modified Nei-Gojo bori Method.................224 
Molecular se quences...............................382 
Monophyle tic............................................434 
MP .................. 238, 242, 243, 247, 358, 403 
construc ting .............................................358 
find ................................................... 242, 403 
MP Trees .................................................358 Multifurcati ng tree ................................... 243 
N 
Name ...................... 115, 149, 255, 258, 328 
sequences/gr oups........................... 149, 255 
taxa ......................................................... 258 
NCBI ....................................................... 436 
Neighbor Jo ining..................................... 244 
Neighbor Joining Construct Phylogeny .. 244 Neighbor-Jo ining..................................... 356 
Nei-Gojobo ri.................................... 112,  224 
Nei-Gojobori  Method............................... 223 
Net Between Gr oups ...................... 153, 257 
Neutrality ......................................... 253, 359 
Tajima's Te st................................... 253, 359 
Tests | Tajima's  Test....................... 253, 359 
New......................................................... 157 
Newick Fo rmat ........................................ 437 
Nex............................................................ 94 Nexus/PAUP............................................. 94 NJ............................ 234, 243, 244, 356, 357 
NJ/UPG MA ............................................. 233 
Noncoding............... 85, 86, 87, 92, 123, 267 Non-synonymous... 112, 223, 224, 225, 226, 
228, 248, 250, 252, 360, 377, 383 
Non-synonymous site .... 225, 226, 228, 248, 360, 361 
Notations Used ......................................... 32 
Notepad ............................................ 49, 154 
NSeqs ................................................. 85, 91 NSites ....................................................... 85 
NT ............................................................... 7 
NTaxa ................................................. 85, 91 
Nucleotide............................................... 180 Nucleotide Compos ition.................. 144, 288 
Nucleotide Pair Frequencies.. 145, 181, 289, 440 Nucleotide-by-n ucleotide ........................ 183 
Nucleotide-by-nuc leotide site.................. 339 
Number .. 112, 189, 191, 193, 198, 201, 223, 224, 225, 226, 228, 234, 244, 248, 252, 255, 
324, 356, 360, 377 
0-fold ....................................... 225, 226, 228 4-fold ....................................... 225, 226, 228 
codons .................................................... 252 
Finding .................................................... 324 
non-synonymous.... 112, 223, 224, 225, 226, 
228, 248, 360, 377 
Sites ................................................ 223, 224 taxa ................................. 234, 244, 255, 356 
transversional.......... 189, 191, 193, 198, 201 
O 
OLS branch lengt h estimates ................. 441 
Only 4-fold degen erate si tes................... 327 Molecular Evolutionary Genetics Analysis 
226 Writing ......................................................327 
Only highlight ed sites ..............................323 
Only Nei-Go jobori ....................................252 
Open ........................................................158 
Open Da ta ...............................................328 
Open Saved Alignm ent Session................53 
Operational Tax onomic Units ....................80 
Options dialog 154, 302, 303, 304, 305, 306, 
344 
quit ...........................................................154 Order................................................ 301, 368 
taxa ..................................................301, 368 OTUs .........................................80,  233, 359 
Outgroup ..........................................245, 356 
Outgroup taxa..........................................356 
Output file ................................................327 
P 
Pair-wise com parisons ............................324 
Pair-wise De letion....................................245 
Pair-wise Dist ance Da ta ..........................367 
Pair-wise menu........................................325 
Pair-wise-De letion....................................245 
Pamilo-Bianchi -Li............................. 226, 228 
Pamilo-Bianchi -Li Method........................226 
Parsimony-inf ormative.............................358 
Paste........................................................171 
Pattern Menu ...........................................183 
PAUP 3.0 .........................................123, 267 
PAUP 4.0 .........................................123, 267 
P-distance................................186, 217, 391 
Phenylal anine ............................................84 
Phy.............................................................94 PHYLIP......................................................94 PHYLIP 3. 0......................................123, 267 
Phylogenetic 6, 77, 183, 233, 236, 238, 240, 243, 244, 247, 339, 340, 343, 344, 345, 351, 352, 357, 434 
construct ..........................................233, 357 
Phylogenetic In ference ............................233 
Phylogenies ............ 115, 119, 233, 259, 263 Phylogeny | Any.......................................293 
Phylogeny | Bootstrap Test .............244, 352 
Phylogeny | Display Saved Tree 
Session.Us e.............................................354 
Phylogeny | Minimum Evolution ..............357 
Phylogeny | Neighbo r-Joining..................244 
Phylogeny m enu..............................327,  351 
Poisson ....................................219, 222, 392 
Poisson Correcti on distance....................219 
Poisson Correct ion Fail ed .......................392 
Polypeptid e..............................................446 
Position ............................................115, 177 
codon .......................................................115 
Preface ........................................................3 
Print ................................................. 166, 332 Print di alog.............................................. 295 
Printer Setu p................................... 295, 333 
Program ...................................................... 8 
uncompress ................................................ 8 
Prolin e....................................................... 84 
Protein pa rsimony ................................... 448 
Pyrimindi ne ............................................... 84 
Q 
Query Data banks.................................... 363 
Quit Data Viewer............. 118, 124, 262, 268 
Quit Option s dial og ................................. 154 
Quit View er ..................................... 151, 259 
R 
RAM ............................................................ 7 
Rate ........................................................ 187 
Read ......................................................... 94 
DNA .......................................................... 94 
Relative Ra te .................................. 245, 356 
Relative Rate  Tests................................. 355 
Removing................................................ 368 
taxon ....................................................... 368 
Reopen Da ta........................................... 330 
Replac e................................................... 175 
Reporting Bugs ......................................... 31 
Resampled da taset................................. 242 
Resampling ..................... 244, 248, 352, 360 
Residue-by-r esidue................................. 183 
Restore Input Order ........................ 125, 269 
RNA .................................................. 85,  335 
RSCU...................................................... 406 
Rules....................................... 80, 81, 82, 83 
Description Statem ent .............................. 82 
Format St atement ..................................... 83 
Taxa Names.............................................. 80 Title Stat ement .......................................... 81 
S 
Save................................................ 164, 332 
Save As................................................... 165 Save As dialog........................ 165, 295, 296 
SBL ......................................................... 294 
Scale Bar tab .......................................... 306 
Scrollbar .......................................... 115, 259 
Search | Find........................................... 173 
Search | Find  Again ................................ 174 
Search | R eplace .................................... 175 
Search me nu..................................... 49, 154 
Search Menu in Alignment Explorer . 73, 319 
Select ...................... 115, 149, 178, 259, 368 
taxa ......................................... 115, 149, 259 taxon ....................................................... 368 Select & Edit Taxa/Groups ..................... 151 
Select Genetic Co de dialog ............ 118, 262 Index 
227 Select Genetic Code Table.....113, 120, 264, 
341 
Select Genetic Code Table Dialog ..........372 
Select Pref erences ..................................344 
Select/Edit Taxa  Groups..................135, 279 
Select/Edit Taxa/G roups wi ndow.............368 
Selected Sequen ces........................126, 270 
Selection................. 248, 250, 325, 360, 361 
Fisher's Ex act Te st .................................. 361 
Large Sample  Test s ................................248 
Tests | Codon-base d Tests .............360, 361 
Z-Test ......................................................360 
Sequence Data ..........................83, 245, 367 
Sequence Data Explorer 115, 119, 120, 121, 
122, 123, 124, 136, 143, 259, 263, 264, 265, 266, 267, 268, 280, 287, 323, 327 
Sequence Data Organizer...............118, 262 
Sequence Data Subset Selection............177 Sequence Divers ity submenu..................349 
Sequence Name s ............................134, 278 
Sequencer Menu in Alignment Explorer...74, 320 
Sequences/group s...........................149, 255 
Setup/Select Genes122, 144, 145, 146, 147, 
175, 181, 182, 266, 288, 289, 290, 291, 337, 
370 
Setup/Select Genes/Domain .....................86 Setup/Select Taxa ..... 89, 93, 121, 265, 336, 
368 
Show........................................149, 255, 304 pair-wise ..........................................149, 255 
statistics/fr equency ..................................304 
Show Analysis Description ......................259 
Show Group Names ....... 130, 152, 258, 274 Show Inform ation.....................................295 
Show Input Da ta Title ..............................259 
Show Names ...........................................258 Show Only Selected Sequences .....126, 270 Show Only Sele cted Taxa .......................152 
Show Pair  Name......................................258 
Show Sequence Names ..................129, 273 
Show Web Br owser .................................364 
Show/Hid e ...............................................301 
Simple 2- fold............................................228 
Site Label s...............................................370 
Site Picker dialog .....................................370 
Sites 115, 223, 224, 238, 245, 247, 259, 324 Highlightin g......................................115, 259 
Number............................................ 223, 224 
Sites   R edundancy .................................112 
Sizer butto n......................................149, 255 
SoftWindo ws95............................................7 
SoftWindo ws98............................................7 
Sort..........................................................368 
Sort Sequences ..... 132, 133, 134, 276, 277, 278 Sort Sequences As per Taxa/Group 
Organizer ........................................ 135, 279 
Sort Sequences By Sequence Name .... 136, 
280 Sort Taxa ........................................ 152, 258 
Special Symbols ....................................... 83 SQRT .............................................. 248, 360 
Staden ..................................................... 457 
Statistical A ttribut es ................................ 112 
Computin g............................................... 112 
Statisti cs.................................................. 323 
Computin g............................................... 323 
Statistics | Am ino ............................ 147, 291 
Statistics | Codon Usage......... 146, 182, 290 Statistics | Nucleotide Composition 144, 288 Statistics | Nucleotide Pair Frequencies 145, 
181, 289 
Statistics | Use ................................ 149, 293 
Statistics | Use All Selected Sites ... 148, 292 
Statistics Menu ........................ 143, 287, 323 
Statistics/fr equency................................. 304 
Status Bar ................. 49,  115, 149, 154, 259 
Subpopulat ions ....................................... 349 
Substituti on ..................................... 324,  325 
Subtree Drawing Options (in Tree Explorer)
................................................................ 298 
Subtree Menu ......................................... 297 
Subtree Op tion........................................ 305 
Sun Workst ation.......................................... 7 
Synonymous-non-synonymous .............. 183 
Syonymous ..................................... 248, 360 
System Requirements ................................ 7 
T 
Tajima ..................... 188, 245,  253, 356, 359 
Tajima Nei distance Gamma rates ......... 200 
Tajima Nei Distance Gamma Rates and Heterogeneous patterns ......................... 211 
Tajima Nei Distance Heterogeneous pattern s ................................................... 205 
Tajima-Nei ....................................... 188, 394 
Tajima-Nei di stance ................................ 188 
Tajima-Nei Distance Could Not Be 
Comput ed ............................................... 393 
Tajima's Te st................... 245, 253, 356, 359 
Neutrality ......................................... 253, 359 
Tamura.................................................... 394 
Tamura 3 parameter Gamma rates and 
Heterogeneous patterns ......................... 214 
Tamura 3 parameter Heterogeneous 
pattern s ................................................... 206 
Tamura 3-paramet er dist ance ................ 191 
Tamura 3-parameter Gamma................. 203 Tamura-Nei............................. 193, 201, 395 
Tamura-Nei di stance ...................... 193, 201 
Tamura-Nei Distance Could Not Be Molecular Evolutionary Genetics Analysis 
228 Comput ed ................................................395 
Tamura-Nei distance Gamma rates and 
Heterogeneous patterns..........................212 
Tamura-Nei distance Heterogeneous 
Pattern s ...................................................208 
Tamura-Nei gamma  distance ..................201 
Taxa... 80, 87, 89, 90, 92, 93, 115, 118, 149, 
151, 152, 153, 177, 178, 234, 244, 255, 257, 
258, 259, 262, 301, 336, 348, 350, 351, 356, 
368, 386, 434 Adding ......................................................368 
categori ze ................................................151 
defining ........................................ 89, 93, 336 
Defining Gr oups...................................87, 92 
following...............................................87, 92 Groups87, 92, 115, 118, 149, 153, 257, 259, 
262, 348, 350, 351 
hiding .......................................................258 
listing ........................................................368 
name........................................................258 number............................ 234, 244, 255, 356 order ................................................ 301, 368 
selecting................................... 115, 149, 259 
Taxa Names ..............................................80 Rules..........................................................80 
Taxa/Group Orga nizer.....................135, 279 
Taxa/Groups............................................368 
Taxon 80, 149, 152, 255, 258, 301, 303, 368 
includin g...................................................301 
indica te ....................................................368 
manipulat e ...............................................303 
Removing.................................................368 
select .......................................................368 
Taxon I abel................................................80 
Taxon Name  tab ......................................305 
Technical Support......................................30 
Test of Positive Selection ..........................43 Tests | Codon-base d Tests .............360, 361 
Selection ..........................................360, 361 
Tests | Interior Br anch Test .............243, 353 
Tests | Relative Rate Tests .....245, 355, 356 Tests | Tajima's  Test........................253, 359 
Neutrality ..........................................253, 359 
Tests m enu..............................................327 
Tests of the Reliability of a Tree Obtained 40 
Text Editor ..... 157, 158, 164, 165, 166, 168, 
169, 170, 171, 172, 173, 174, 175 Text File Ed itor................................... 49, 154 
Text Label................................................ 305 
Threonine...................................................84 Title ..........................................77, 79, 81, 82 
Title Stat ement ...........................................81 
Rules..........................................................81 Toolbars in Alignment Explorer .........64, 311 
Topological distance................................462 
Trace Data File Viewer/Editor....................52 Transition/transversion .. 179, 184, 186, 189, 
191, 193, 198, 201, 224, 252 
Transitions + Transversions... 184, 186, 187, 
189, 191, 193, 197, 198, 201 Translate/Untran slate ..................... 119, 263 
Transversional184, 186, 189, 191, 193, 198, 201, 225, 226, 228 
Transversions 184, 186, 189, 191, 193, 198, 
201 
Tree ......................................................... 400 
Bifurcat ing............................................... 400 
Tree Data ............................................ 83, 93 
Tree Explorer . 293, 294, 295, 296, 297, 301, 
302, 307 
Tree Explorer  window ............................. 294 
Tree ta b................................................... 303 
Tree/Branch Style ................................... 301 
Treelengt h............................................... 294 
Tryptoph an................................................ 84 
Txt ....................................................... 32, 77 
U 
Uncompress................................................ 8 
program....................................................... 8 
Undo ....................................................... 172 
Unexpected Error.................................... 396 
Ungrouped Taxa ..................................... 368 
Ungrouped Taxa  window ........................ 368 
Unhide ..................................................... 368 
Uninstall MEGA........................................... 9 
Unique ASC II .......................................... 382 
Unrooted . 233, 234, 244, 356, 357, 358, 462 
Updates..................................................... 30 
UPGMA........................................... 243, 359 
Use All Selected Sites .................... 148, 292 
Use Identical Symbol ...................... 128, 272 
Use only Highlight ed Sites.............. 149, 293 
User Stopped Computation .................... 397 
User-Entered Text..................................... 32 
Using MEGA in the classroom.................. 29 
V 
Valine ........................................................ 84 
Vertebrate mito chondrial......................... 109 
View ........................................................ 115 
View menu ...................................... 301, 327 
View/Edit Sequen cer Files...................... 365 
VirtualPC..................................................... 7 
W 
Web Browser ............................................ 53 Web Explorer Tab Alignment Explorer ..... 53 
Web Menu in Alignment Explorer ..... 75, 321 Website ................................................. 8, 30 
What s New in Version 3.0 ......................... 9 Index 
229 Windows ..............................................2, 7, 9 
Windows Clipboard ..................169, 170, 171 
WinZip..........................................................8 
WordPa d....................................................77 
WordPerfect...............................................77 
Words ........................................................79 
Working With Genes and Domains ...........42 
Write Da ta................................................329 
Writing............................. 78, 86, 87, 92, 327 
Command Statement s...................86, 87, 92 
only 4-fold degene rate sites ....................327 
Writing site .......................................123, 267 Y 
Yeast mitoch ondrial ................................ 109 
Z 
ZIP file......................................................... 8 
Z-statis tic................................................. 325 
Z-Test.............................. 248, 252, 325, 360 
conduct ........................................... 248, 360 
Selectio n ................................................. 360 
 