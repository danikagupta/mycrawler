..IReprinted from the|ournal oftheAmerican Chemical Society, 91.2973 (1969).]Copyright \<)(>')bytheAmerican Chemical Society andreprinted bypermission ofthecopyright o'iwncr.
Applications ofArtificial Intelligence forChemical Inference.
I.TheNumber ofPossible Organic Compounds.
Acyclic Structures Containing C,H,O,andN1
J.lederberg, G.L.Sutherland, B.G.Buchanan, E.A.Feigenbaum,
A.V.Robertson, A.M.Duffield, andCarl Djerassi
Contribution from theDepartments ofGenetics, Computer Science, andChemistry,
Stanford University, Stanford, California 94305. Received November 18,1968
Abstract: The useotthecomputer program dlndral inconstructing thetotal number ofpossible acyclic struc-turesof
C,H,N,andOis described. Those structures containing either chemical absurdities orundesired func-tional groups arenotconstructed ifthese substructures areexplicitly listed. Conversely, ifitisdesired torestricttheoutput toanyfunctional group(s) then thiscanbeaccomplished. Examples ofthelinear notation used aregiven. Semilog plotsoftotal numbers ofisomers vs.carbon content forselected compositions summarize there-sults. Some broader implications oftheprogram arediscussed which forms thebasis forthecomputer-aided in-terpretation ofmass spectra tobereported 2insubsequent articles from ourlaboratories.
Chemistshave sensed ever since the theory of
structural isomerism was conceived that the
number oforganic compounds possible was astro-
nomical. Inretrospect, therefore, itissurprising that
there have been sofew attempts tofind mathematical
procedures forevaluating thenumber ofisomers ofa
given molecular formula. Such enumerations would
beofuniversal interest indefining theboundaries,
scope, andlimits ofthesubject. One specific useof
listsofpossible isomers isinthecomputerized inference
ofchemical structures from mass spectra.- Formal
attempts todevise analgorithm yielding thenumber of
acyclic alkanes for agiven carbon content began in
1875 with Cayley,3butitwas notuntil 1931 that
Henze and Blair solved thisproblem.4They found it
necessary toderive first thenumber ofisomeric alkyl
groups. 'Thefewother references ontheapplication
oftopology andcombinatorial analysis tochemical
problems were listed recently byBalaban.6
The first general procedure forenumerating the
isomers ofany given elemental composition was
recently devised byLederberg.7The key tothe
solution, seen from theviewpoint oftopological graph
theory (the atoms andbonds ofachemical structure
forming the nodes and edges, respectively, ofthe
graph) had been foreshadowed formonofunctional
acyclic structures, byHenze and Blair. 45Itisthat
any chemical structure, considered asatree-graph,
has aunique centroid. This centroid iseither abond
thatevenly divides thetreeinto two parts with equal
numbers ofatoms (neglecting hydrogen), orasingle
(1)This research wasfinancially supported bytheAdvanced Re-
search Projects Agency oftheOffice oftheSecretary ofDefense (Grant
SD-183), theNational Aeronautics and Space Administration (Grant
NGR-05-020-004), and theNational Institutes ofHealth (Grants CM-
-11309 andAM-04257). The award ofaFulbright Travel Grant (to
A.V.R.lfrom theAustralian-American Educational Foundation is
gratefully acknowledged.
(2)A.M.Duffield, A.V.Robertson. C.Djerassi, B.G.Buchanan,
G.L.Sutherland, E.A.Feigenbaum, and J.Lederberg, J.Am. Chem.
.Soc,91,2977(1969).
(3)A.Cayley,
Ber., 8,1056(1875).
(4)H.R.Henze andC.M.Blair, /.Am. Chem. Soc, 53,3077 (1931).
(5)H.R.Henze andC.M.
Blair, ibid., 53,3042 (1931).
(6)A.T.Balaban, Rec Chim., Acad. Rep. Populairc
Roumaine,12,
875(1967).
(7)J.Lederberg, "Topology ofMolecules, inTheMathematical Sci-ences," TheMIT Press, Cambridge, Mass., 1969, p37.atom from which each branch carries lessthan half
theatoms. The unique centroid isthen thestartingpoint foracanonical mapping ofthetree, following
rules thatarrange theconstituent radicals insystematic
sequence. These canons ofprecedence establish pri-
orities between radicals interms of,say, therelative
number ofatoms ineach (disregarding hydrogen),
heteroatom content, unsaturation present, etc., along
lines similar to,butmore compactly axiomatized than,
theCahn-Ingold-Prelog* absolute configuration con-ventions. Inthis way, theatomic connectivity canbeconveyed inalinear notational form (i.e., written
ononeline), and theformat itself contains theinfor-
mation needed torank thelinear formulas forasetof
isomers inacanonical dictionary order. Examples ofthislinear notation aregiven inTable I,which shows
tentopologically possible linear isomers ofC,H8N0 3(threonine).
Table I.TenTopologically Possible Linear Isomers of
Threonine Generated bydendral"
■Theconventions used bydendral areasfollows: period de-
notes asingle bond, *COOH and *CONHT areobvious abbrevi-ations, =denotes adouble bond, hydrogens and spaces arein-
cluded forreadability. Thetotal output amounted to3294 topo-
logically possible structures ofwhich only tenarereproduced.
Each molecule shown isrepresented asthreeorfourradicals jointed
toacentral atom. Entry 3125 corresponds to2,3-dihydroxy-2-
-methylpropionamide.
The rules orcanons ofprecedence forwriting the
linear notation, andforassigning toeach isomer ofa
given composition itsunique position inthedictionary
list,canthen beused togenerate such anexhaustive,
nonredundant list. Itiseasy towrite down the
(8)R.S.Calm, C.K.Ingold, andV.Prclog, Experientia, 12,81(1956); Angew. Chem. Intern. Ed.Engl., 5,385(1966).
Djerassi, etalIArtificial intelligence forChemical Inference3050.
3075.
3100.
3125.
3150.
3175.
3200.
3225.
3250.
3275.N...
O.CH3
C... CII3
C... CU3
C... CH3
C... Cll3
C... Cll3
C...NH2
C... OHC...
OH
C... Oii0.C113CH2.CH=O ,
CH3 O.NH2:":
COOK,
NH2
O.OH C.=CH30»
OH
CH2.OH*CONH2 ,
OH O.NH2 O.CH-CH2,
CH2.OH
O.CH3N=o,
OH CH=O CH..CH3 OH,
OH CII=CH2 N..CH3 OH,
OHCH2.OH
C.=CH3NH,
CRKS CH2.OHN«0 i2974
- structure having thelowest ranking inthehierarchy of
priorities (canonical hierarchy). Given this first
member ofthedictionary listofisomers forthat
composition, theother members are generated in
proper order bypermutation ofstructural subunits
according totherules. The linear notation and the
fact that the useofthecanons involves anordered
sequence ofbinary decisions means that thesystem is
very welladapted forcomputer use,andofcourse itwas
intentionally designed withthatendinview.
The program developed iscalled dendral9(for
DtWritic Algorithm). Itiswritten inthelist-processing
programming language lisp. Itrequires 40,000 or
more words ofmemory, depending onthenumber of
atoms inthecomposition andthespeed withwhich one
wants toseeanswers. Many options areavailable to
thechemist attheteletype console; forinstance, hecan
revise theprogram's theory ofchemical instability
(sec badlist, below), hecanrestrict structure generation
tomolecules ofaspecified class (seegoodlist, below)
orhecan monitor thestructure-generation process
through adialog with theprogram. Programming
details areavailable.'"Wepresent here some oftheresults obtained withthe
dendral program, asapplied toarange ofatomic
compositions for C,H,O,N.The output was
confined,fornow, toacyclic structural isomers; rings,
pentavalent N,andgeometrical andoptical isomerism
were excluded from consideration. Theprogram will
handle such structural features butwith correspond-
ingly greater demands oncomputer time andmemory.
Inusing thedendral program, anything that can
bedone totruncate thepotential listofisomers as
early aspossible results inmuch improved running
efficiency. With the perspective ofthe practical
organic chemist inmind, wehave deliberately restricted
the dendral output here byexcluding structures
containing functional groups that areasyetunknown,
orunstable, orlessfavored tautomeric forms. This is
achieved with badlist, which issimply aninput listof
structural fragments tobeexcluded during that run.
Theprogram then prunes thedendral treeofisomers
atevery branch forwhich abadlist entry appears.
Conversely, ifitisdesired torestrict theoutput toalist
ofisomers which allcontain agiven structural group(s),
such group(s) canbeplaced onaninput feature called
goodlist. Inthisevent theprogram ignores allother
structural possibilities. The numerical consequences
ofusing badlist andgoodlist areillustrated below.
With goodlist empty andwith thebadlist shown in
Table 11,theoutput summarized inTable 111was
generated. Selection ofthe badlist entries was
arbitrary, with theidea oftruncating thedendral
output tothose isomers with functional groups that
arereasonably stable, wellknown, andrepresent only
thepredominant form ofany tautomer. Any atomic
and bonding arrangement notexplicitly onbadlist
isincluded among theoutput structures provided it
conforms totheusual valence rules. Forexample, the
first entry inTable IIexcludes enols, butsince C=C—
O-Cisnotlisted, enol ethers arenotexcluded. The
entry O-NO,with twosingle O—Nbonds, does not
(9)Labels capitalized inthis
wayarc
programmodules.
(10) B.G.Buchanan and G.L.
Sutherland,Heuristic dendral: A
Program forGenerating Explanatory Hypotheses inOrganic Chemistry,
Memo No.
62,Stanford Artificial Intelligence Project, July 1967.Table 11. badlist Used intheGeneration ofTable 111
H-O—C—O-
O
H—O—C—N
II
O
exclude nitrites, O—N=o. The badlist selected
hereforacyclic aliphatic structures isinappropriate for
heterocyclic compounds, where some oftheentries in
Table IIdoexist assubunits ofstable structures. The
generality and flexibility ofthe dendral program
ensures that alltastes can beaccommodated. We
happen tohave excluded peroxides (Table II),but
anyone with such anexplosive interest, forexample,
could berapidly andselectively satisfied byrunning
dendral with O—Oongoodlist.
Table 111wasgenerated byHeuristic dendral onthe
PDP-6 time-sharing system attheStanford Artificial
Intelligence Laboratory. Under time-sharing con-
ditions, theprogram generates 100isomers ofanyof
these compositions inapproximately 1-4 min of
machine time (including system overhead time
apportioned toallusers). Depending upon many
factors, including thenumber ofother users ofthe
system attherun time, 4minofmachine time will
require from 4to12minormore oftime attheteletype
console. And theamount ofmachine time required
for 100isomers will also vary depending upon the
amount ofcore memory allocated, theamount ofpast
work saved intheprogram's dictionary, and the
heteroatom content ofthecomposition. Thus these
estimates arerough indicators atbest.
Practical considerations determined thenumber of
entries inthistable. Wearbitrarily decided toexclude
compositions which weestimated would have many
more than 3000 isomers (with afewexceptions).
We have found that simple semilog plots ofthe
number ofcarbon atoms vs.thenumber ofpossible
acyclic isomers yield nearly straight lines asshown in
Figure 1.The semilog plots ofTable 111before
completion were used topredict some additional
entries, asacheck ontheextrapolation method weare
advocating. Ineach case thepredictions were accurate
within 2%,often much less. Forexample, with seven
entries intheC„H, n+202section theC8andC9entries
were predicted tobe1000 and 2700 isomers: the
actual numbers were 990and 2688. With only four
entries intheC„H,„ +:)NOsection theC5andCsentries
were predicted tobe135and375isomers; theactual
numbers were 137and 376. The graphs reproduced
inFigure 1arenot exact straight lines, since aswas
pointed outbyPerry11forthealkanes, thenumbers
arenotinstrict geometric progression. Itmay beof
some interest tomathematical chemists tofind theo-
(11) D.Perry,,. Am. Chem.
Soc,54,2918 (1932).
Journal oftheAmerican Chemical Society f91:11 /May 21,1969C=C— O-H H-O— C—O—H N-N— O
C=C— N—H H—OC—N—H N—O—N
o==C— O—H H—N-C—N—H N—O—O
I
H
C^C-N— H ON—O
N=N--N H—C—NO OOOO^C— N—H
N=N— N H—C—N=o
N=N—O H—o—C=N
o—o
N—N—NN=N—H2975
_■ "Table 111. Numbers ofPossible Acyclic Isomers ofSelected Compositions
"No special significance should beattached totheexact numbers shown inthistable. Asnoted elsewhere, these numbers willchange ap-
preciably when relevant badlist orgoodlist entries areadded ordeleted tosuittheinterests ofindividual chemists. Also, these tables carry
noguarantee ofaccuracy since there isalways apossibility ofundetected hardware orsoftware (programming) errors. Running severalexamples asecond timewith thesame results hasgiven usarelatively high degree ofconfidence inthemachine itself. And wearequite
confident thatanyerrors stillintheprogram would have onlyasmall elfect ontheresults.
retical justification forthecurves presented here, and
forsimilar curves fortheother sections.
The rate atwhich thenumber ofpossible acyclic
isomers increases with added heteroatoms and
unsaturations isvery startling. Forinstance there are
three isomers of
C,HSbut362 isomers ofCiH 9N0 2.
Many other examples areevident from Figure 1and
Table 111.
Since Liebig coined theideaoffunctional groups it
hasbeen natural toorganize organic chemistry bysuch
aclassification. The example shown inTable IV
demonstrates numerically theincisive power ofthis
concept asalogical device totruncate thelistofpossible
isomers ofagiven composition. There exist 4030
isomers ofC«H 1602,using theconstraints ofTable 11,
andprobably two orthree times that number without
these constraints. When afunctional group of
particular interest isplaced ongoodlist, however, the
program generates amuch smaller listofisomers
(Table IV)each ofwhich contains only thatfunctional
group. The numbers ofthistable were computed by
theprogram without regard forconsiderations of
stability, i.e.,with badlist empty. Thus, with badlist
(Table II)filtering inaddition togoodlist selectivity,
even fewer structures willbeconsidered inmany cases.
These figures show theimportance ofbeing able to
define thefunctional groups actually present ina
molecule byasimple chemical reaction orbyspec-
troscopic methods asonecanthen eliminate approxi-
mately 90"u ofthepossible structures. Thepractical
consequences ofsuch anapproach willbecome evident
from aseries ofpapers tobepublished from our
laboratories.NUMBER OFCARBON
ATOMSFigure 1.Graphs ofrelationships between number ofacyclic iso-
mers andcarbon content forselected compositions.
Theuseofbadlist hasapractical advantage when the
generation ofsubstantial numbers ofisomers isrequired.
Djerassi, etal./Artificial Intelligence forChemical inference1 2Number ofcarbon atoms"-
-3 4 5 6 7 8 9 10 Section Comp 11 12
A
B
C
D
E
F
G
HCI.„,,
CH,„
CH,,,-.
C,H„- (
C„H 2„-t,
CH.„_»
C,H,„ ,0
CH*,-,,
CH.,,,,
C„H,„-16
CH,,,„
C,H 2„,,0
CH,„0
C„H„ ()
C„H,„_ 40
C,H ()..
C,H 2„0,
C,H,„.:,N
C„H,„+,N
CH,„.,N,
C„H,.„..N ;.
CIT„.,NO
CH, NO
C„H,„,,NO,
C„H2„nNO.
C.H,„ +:INO.,
C„H.„ +1N0 3I
I
I
0
I
1
I
I
2
2
2
2
3
0
31
1
I
2
I
1
0
2
3
2
2
5
8
6
9
9
17
7
171
1
2
0
3
4
4
2
6
8
4
5
II
24
18
31
43
83
56
1302
3
4
2
1
7
II
15
7
18
32
8
14
34
78
50
105
160
362
288
7513
5
9
6
4
0
14
33
47
32
48
110
17
40
84
241
137
350
533
1430
1313
37405
13
23
21
15
5
1
32
91
156
566
133
380
39
111
235
751
365
1116
17569
27
55
59
45
21
8
0
72
254
492
2687
359
1233
89
304
623
2334
995
3574
561718
66
152
195
182
110
45
9
1
0
171
698
1544
990
4030
211
845
1724
272735
153
375
563
629
511
262
77
13
0
405
1936
2688
507
232275
377
1048
1823
2270
2113
1304
532
135
17
1
989
5296
1238159
915
2877
8057
2460
3057355
2315
61232976
*.Table IV. The Number ofAliphatic Isomers ofCsHi 602Separated byFunctional Groups
No. Functional group name No.ofisomers ofC,Hi 602 Contained subgraph(s)
1 Acid
Ester39
2 105
3 Keto ether andaldehyde ether 329
4 Hydroxy ketone andhydroxyaldehyde
Diether (excluding enol ether)458
5 183
6 Hydroxy ether
7
8Enol andether
Hydroxy enol ether
9 Unconjugated acetal
10 Conjugated acetal
II Acyloin enol ether
12 gem-Dioi
13 Diol (excluding gem-d\o\ andenol)
14 Unconjugated peroxide
15 Unconjugated hydroperoxide
Thus with Table IIinusethere exist 751isomers of
thecomposition
C,H9N0 3(Table 111, section H).
However, with badlist inoperative thislistamounts to
3294 isomers. Hence byforbidding thegeneration of
isomers containing unwanted orchemically absurd
structures badlist substantially limits theoutput level
with acorresponding saving oncomputer time.
Itisinteresting tonote (Table 111,section A)that
15acyclic isomers ofbenzene exist. Twelve ofthese
areunbranched. Inaddition theisoprene rulerestricts
the 1823 possible acyclic isomers ofCi0H16to52
structures having twoisoprene units linked head totail
with three unsaturations inallpossible arrangements.Ofthethreonine isomers 385 were selected as
arbitrarily interesting for aliterature search.12This
disclosed thatonly 59oftheisomers hadbeen reported.
Similarly, alessdetailed investigation showed thatonly
63ofthe 1823 acyclic isomers ofd
OHi6had been
described.
dendral has been used extensively incomputer
interpretation ofmass spectra and fordetails the
reader isreferred tothefollowing paper.2
(12) The literature search wasconfined totheformula indexes of
Chemical Abstracts (Vol. 14-65) and Beilstein and wasperformed by
Mr.Don Greeley.
Journal oftheAmerican Chemical Society /91:11 /May 21,1969-COOH
COO
>COC< and CO
>COH and>CCO
(>COC<)2
>COC< and>COH