Using Annotated Peptide Mass Spectrum Libraries
for Protein Identification
R. Craig,²J. C. Cortens,³D. Fenyo,§and R. C. Beavis*,²,|
Beavis Informatics Ltd., Winnipeg, MB, Canada R3B 1G7, Manitoba Centre for Systems Biology and
Proteomics, University of Manitoba, Winnipeg, MB, Canada R3T 2N2, Rockefeller University, 1230 York
Avenue, New York, New York 10027, and Biomedical Research Centre, University of British Columbia,
Vancouver, BC, Canada V6T 1Z3
Received May 3, 2006
A system for creating a library of tandem mass spectra annotated with corresponding peptide sequences
was described. This system was based on the annotated spectra currently available in the GlobalProteome Machine Database (GPMDB). The library spectra were created by averaging together spectrathat were annotated with the same peptide sequence, sequence modifications, and parent ion charge.The library was constructed so that experimental peptide tandem mass spectra could be comparedwith those in the library, resulting in a peptide sequence identification based on scoring the similarityof the experimental spectrum with the contents of the library. A software implementation that performsthis type of library search was constructed and successfully used to obtain sequence identifications.The annotated tandem mass spectrum libraries for the
Homo sapiens ,Mus musculus , and Saccharo-
myces cerevisiae proteomes and search software were made available for download and use by other
groups.
Keywords: peptide spectrum library ¥X! Hunter ¥GPM ¥GPMDB ¥protein identification
Introduction
One of the major methods for the experimental study of the
proteins expressed by an organism is to use data derived fromcollections of tandem mass spectra to determine which proteinswere present in a particular biological sample. The most com-mon method of associating a particular tandem mass spectrumwith a peptide sequence is to compare each experimental spec-trum with theoretical spectra generated from a list of potentialpeptides, based on known, sequence-specific peptide ion frag-mentation reactions. The list of peptides is derived from all ofthe protein sequences that could possibly be expressed by aparticular organism. The comparison process generates a setof scores that indicate the similarity between any particularpeptide sequence and the experimental mass spectrum. Thepeptide (or peptides) judged to be the most similar to thespectrum can then be associated with that spectrum and theprocess repeated for all of the spectra generated by the experi-ment. When the results of all of these spectrum-to-peptidecorrelations is combined, a list of candidate proteins can begenerated for use by the biological researcher. The idea ofselecting a chemical structure based on an enumeration oftheoretical mass spectra has a long history, beginning with thework of Djerassi and Lederberg
1-3to identify organic com-pounds. Its application to peptides was made possible by the
sequence-specific bond cleavage rules described by Roepstroffand Folman
4and Biemann.5The method has become popular
for several reasons: there are practical software implementa-tions of the idea;
6-9it is simple to automate the analysis of
large data sets; and the scores can be interpreted statisticallyfor large-scale applications.
10,11
Historically, the use of theoretical fragmentation patterns for
analyzing small organic molecules was largely been replacedby another method commonly referred to as a ªlibrary search-ingº. Library searching was originally formulated to improvethe identification process, and it is also based on fragment massspectra.
12,13This type of search depended on the postulate that
a particular organic molecule would fragment in a mass spec-trometer in a manner that was characteristic of the detailedstructure of the molecule. If this statement was true, it shouldbe possible to generate a library of such fragmentation spectrausing authentic samples of each molecule of interest. Wheneach of these fragmentation spectra was associated with thecorresponding molecular structure, the problem of assigningan experimental spectrum to a structure was reduced to theproblem of determining which entry in a comprehensive libraryof annotated spectra corresponded best to the experimentalspectrum. This method proved to be easy to automate and didnot require a trained analyst to confirm the results of the matchprocess. It was also largely hypothesis-free: it was not basedon a theoretical understanding of fragmentation reactions. Thisfeature of library searching proved to be important becauseeven though a theoretical fragmentation pathway may be valid
* To whom correspondence should be addressed. E-mail: rbeavis@
proteome.ca
²Beavis Informatics Ltd.
³University of Manitoba.
§Rockefeller University.
|University of British Columbia.
10.1021/pr0602085 CCC: $33.50 2006 American Chemical Society Journal of Proteome Research 2006, 5, 1843 -1849 1843
Published on Web 07/14/2006in general, there were numerous special cases that deviate from
the general rules. Instruments that use library searching fordata interpretation have become general-purpose laboratoryequipment that can be employed effectively by any user withminimal technical training. It remains the primary method ofanalyzing GC -MS data.
14-17
The use of a library of authentic peptide spectra was
impractical when protein identification was initially demon-strated. The main reasons that it was not employed were asfollows:
1. it was unclear at the time that peptides produced similar
tandem mass spectra when examined with different brands ofmass spectrometer;
2. the set of possible protein sequences known for any
particular species was either incomplete or changing rapidly,as new DNA and RNA sequencing methods became available;and
3. the expense of generating a comprehensive set of authen-
tic peptide samples and measuring their tandem mass spectra.
Over the course of the past decade, the first two of these
difficulties have been largely resolved. Most commerciallyavailable mass spectrometers suitable for proteomics have beenfound to generate a similar set of peptide fragment ions intandem mass spectra. The variability between spectra of thesame peptide has been found to be associated with the chargeof the parent ion, rather than the specific brand of collisionallyinduced fragmentation ion source being used.
18-20With respect
to the second problem, the existence of completed genomesfor a number of important laboratory model species has sta-bilized the lists of protein sequences used in proteomics. Whilethere may be some variation in the predicted exon structureof some genes, the large-scale reannotations of genomes thatwere once common have become rare in established genomesequencing projects, such as those for human, mouse, or yeast.
The last problem, the cost of generating such a library,
remains significant. Synthesizing the necessary authentic pep-tides and measuring their tandem mass spectra is simply toocostly at present, even if a reduced set of ªproteotypicº peptidesis used.
21Either a very large investment on the part of a funding
agency or a dramatic reduction in peptide synthesis costs willbe necessary for any such library to be populated with struc-tures and spectra.
This paper explores the possibility of using an alternate
strategy to generate such a library, which does not require thesynthesis of peptide standards. This strategy involves the collec-tion and annotation of a large number of peptide tandem massspectrum data sets generated in the normal course of operationby various proteomics laboratories. With this collection ofexperimental annotations, it should be possible to develop aquality control and curation scheme resulting in a set of com-posite spectra, each the result of averaging together multipleobservations of the same peptide. The composite spectra couldthen be used as a standard spectrum library, in the samemanner as a library derived from synthetic peptide standardswould be employed.
Describing all of the necessary components of a practical
system using this strategy to identify proteins probably exceedsthe scope of a single journal article. However, simply develop-ing an annotated library of spectra using this strategy withouta search engine to use it for protein identification would be apurely academic exercise. Therefore, while the work reportedhere focuses mainly on the process necessary to use the abovescheme to create a practical annotated spectrum library, asearch engine that can use those libraries to identify proteinswas also developed and an illustrative example of its usedescribed.
Experimental Methods
The overall process used to create libraries of annotated
peptide MS/MS spectra was illustrated in Figure 1. The neces-sary software to accomplish these tasks and the annotatedspectrum libraries have been made available either by filetransfer protocol (FTP) or as source code in the GPM softwareversion control system.
22All code and databases have been
written to require as little operating-system-dependent cus-
Figure 1. An activity diagram illustrating the steps required to generate an initial library of composite spectra.research articles Craig et al.
1844 Journal of Proteome Research ¥Vol. 5, No. 8, 2006tomization as possible; that is, they could be compiled (C ++
code) or run (PERL, SQL scripts, and binaries) on MicrosoftWindows, LINUX, or Apple OSX operating systems. Some ofthe steps in the process were similar to those used to createlists of proteotypic peptides;
23however, creating spectrum
libraries has proven to be a significantly more difficult task.
Spectrum Collection and Annotation. Experimental groups
were encouraged to upload groups of tandem mass spectra toa publicly available network of search servers, that used X!Tandem
9to annotate these mass spectra with peptide se-
quences and assign goodness-of-fit quality measures. The usercould choose to contribute these annotated sets of spectra tothe GPMDB collection, in which case they were available forthe library creation process. These spectra represent data froman assortment of different brands and types of tandem massspectrometers. No attempt was made to segregate spectrabased on instrument type. The GPM public servers all use acommon set of sequences and accession numbers, based eitheron sequence collections provided by ENSEMBL
24(Homo sapi-
ens and Mus musculus )o rS G D25(Saccharomyces cerevisiae ).
Any translation necessary between these basis sets of accessionnumbers and other systems, such as the International ProteinIndex,
26was done at the last stage of the process.
Each of the individual search sites sent any new annotated
data sets to the central GPMDB server daily. These data setswere loaded into the database repository and distributed torepository server computers. The data in GPMDB has beenregularly examined by GPM contributors, staff, and other users.Annotations found to be in error were deleted. These annota-tion errors were normally caused by the use of unconventionalparameter combinations by users. When unexpected behaviorof the search engine was found, the X! Tandem software wascorrected, tested, and redeployed. At the time of completingthis manuscript, the main repository database containedapproximately 1.2 10
7annotated spectra, and the most con-
fidently assigned subsets of these spectra were selected toconstruct the sequence annotated libraries.
To efficiently create the required spectrum libraries, an
additional database was constructed. The database was popu-lated by extracting the most confidently assigned spectra fromthe main repository and organizing them based on the acces-sion number of the protein associated with the assigned pep-tide. For example, if a search was performed and a spectrum
was assigned to the peptide sequence ªSFQCELVMAKº andassociated with the identification of protein accession numberªAt2g39730.1º, then that spectrum would be associated withall other spectra found with that annotated sequence andaccession number. This process generated a list of spectra asso-ciated with an accession number, subclassified by the peptidesequence. No attempt was made at this stage to deal with theexistence of this peptide sequence in other proteins: that pro-cess was performed after the composite spectra were assem-bled. These database also stored information about each buildof the spectrum libraries so that subsequent builds could bedone incrementally rather than requiring a reclustering of thefull repository database.
The algorithm for obtaining composite spectra for inclusion
in a library was a straightforward, pairwise averaging process.The steps required were as follows.
1. Obtain all available spectra for a particular peptide
sequence, parent ion charge state, and residue modificationcombination from the spectrum cluster database (e.g., obtainall of the spectra for the sequence ªYHFMTWKº, where the
parent ion charge is +2 and the methionine residue has been
oxidized).
2. Order the resulting list of spectra, from most to least
confidently assigned (lowest to highest expectation value).
3. Delete duplicate spectra from the list.4. Start with the most confident assignment. Select the next
most confident assignment and identify sets of shared ionsbetween the two spectra: a set of ions have m/zratios within
the allowed fragment ion mass tolerance.
5. Create a new m/zvalue for each set, by calculating a
centroid of the m/z-value and intensities of the peaks in the
set. Sum together the intensities of the peaks in the set andcreate a new spectrum made up of the summed intensities andm/zcentroid pairs.
6. Take the new composite spectrum and apply the same
steps to it and the next most confident spectrum, creating anew composite.
7. Continue this process until all spectra have been included
into the composite.
8. Normalize the composite spectra so that the most intense
peak has a relative intensity of 100.
9. Select the 20 most intense peaks from the composite
spectrum and store these peaks along with the peptidesequence, parent ion charge, parent ion mass, and sequencemodification information.
10. Store the resulting libraries in XML-formatted files for
the modified and unmodified peptides found for a particularorganism.
Once the basis set of peptide sequence annotated spectra
was stored, the final step was to create a library of spectra anno-tated with the accession numbers associated with a particularprotein sequence collection. For example, if the ENSEMBLprotein sequences were used, the peptide sequences must bemapped to all ENSP-type accession numbers for proteinsequences that contain those peptide sequences. This mappingwas done by comparing the peptide sequence of each an-notated peptide with all of the protein sequences in the appro-priate sequence collection. When a particular peptide wasfound within a protein sequence, the accession number andposition of the peptide in the protein were stored along withthe annotated spectrum. Any number of accession numbersand positions could be associated with a particular spectrum.The fully annotated information for each library was stored ina formatted binary file.
Search Engine Development. A search engine to use the
annotated spectrum libraries was designed and implemented,using the C ++ class libraries developed for the X! Tandem
project. The new search engine, X! Hunter, was designed tooperate on a single thread. The search engine loaded theappropriate spectrum library and experimental spectra intomemory and then scored each experimental-library spectrumpair that was within the specified parent ion mass tolerance.A binary search tree was used to accelerate the process of find-ing these pairs. The score used to determine the match betweena library spectrum and an experimental spectrum was obtainedusing the 20 most intense peaks in the library and experimentalspectra and eq 7 in ref 11, where the two factorial terms werereplaced by a single value, n!;nwas the number of peaks that
occur in both the experimental and library spectrum. Thevector inner product between the two spectrum vectors wasalso calculated and used as an alternative scoring method. Thepeaks in experimental spectra were prefiltered in an attemptUsing Annotated Peptide Mass Spectrum Libraries research articles
Journal of Proteome Research ¥Vol. 5, No. 8, 2006 1845to remove any interfering13C isotope peaks and those corre-
sponding to neutral losses from the parent ion, such as theloss of water or ammonia. The expectation value correspondingto each score was estimated using the method describedpreviously for X! Tandem,
11by applying an average set of esti-
mation parameters.
Following the scoring process, the full sequences of proteins
corresponding to high scoring peptides were loaded from disk,and a full XML report of the results was written. The format ofthe input parameter specification and output XML files wasthe same as X! Tandem: a BIOML representation of sequencesand parameters and GAML records of histograms. The softwarewas compatible with mass spectrum input information ineither structured text (DTA, Mascot Generic Format, or PKL)or XML (mzXML or mzData) files. A fully functional version ofthis search software with a user interface was made publiclyavailable.
27
Search Engine Comparison. The input tandem mass spec-
trum set (778 spectra) was generated using a Sciex QSTAR massspectrometer, from a sample of bovine serum albumin (BSA),by the Manitoba Centre for Systems Biology and Proteomics.The default GPM parameters for QSTAR-type spectra were used.The conventional sequence and library searches were bothperformed using the ENSEMBL H. sapiens and cRAP sequences
and libraries. Both searches were run on the same computer(Hewlett-Packard, model m7470n), using the GPM Web browserinterface. The original search results were deposited in theGPMDB and can be retrieved for examination in detail usingthe following accession numbers: GPM00300004348 (conven-tional search) and GPM20100000113 (library search).
Results and Discussion
1. Characteristics of the Annotated Libraries. The popula-
tion and curation of three libraries was performed to test thesystem. Table 1 lists some of the relevant characteristics of thelibrary files. The creation of the libraries required approximately150 h of processor time. The majority of the time was requiredto generate the cluster database, which required significantamounts of disk access to read the spectra from XML resultsfiles. A small library was created using the protein sequencesin the GPM common Repository of Adventitious Proteins(cRAP), in addition to those of the model organisms. The cRAPsequences were selected from NCBI's nr sequence collection,and they represent artifact proteins commonly found in pro-teomics samples, for example, porcine trypsin or bovine serumalbumin.
The distribution of peptide lengths in the H. sapiens library
was plotted in Figure 2. As indicated by Figure 2a, the librarycontains very few peptide sequences with less than sevenresidues, reaching a maximum for peptides with approximately13 residues. The lack of short peptides was attributed to thefact that the short peptides tend to produce fragmentation
signals that are difficult to recognize using ªtheoreticalº massspectra. These peptides have a limited number of residues, andthey tend to produce few sequence-specific fragment ions,relative to longer peptides. Long peptides tend to producefragment ions that allow the sequencing of regions of themolecule, while short peptides may only have signals charac-teristic of the N- and C-terminal regions of the peptide. Forexample, a pentamer peptide may only have strong signalscorresponding to b2 and y3 ions, which may not be sufficientlycharacteristic to allow an unambiguous identification. Lowmass peptides may be occasionally identified, but usuallyrequiring a relatively intense strong tandem spectrum with acomparatively low signal-to-noise ratio. These peptides alsotend to have low molecular masses, which result in parent ionm/zvalues that can be difficult to distinguish from intense
chemical noise signals in that increase in intensity at low m/z
values.
Figure 2b represents the same data, as a percentage of the
number of unique tryptic peptide sequences of the same length,as calculated from the NCBI translation of the H. sapiens
genome (version 36, October 2005). This curve indicated thateven though the numerical size of the library may appear tobe modest, the library was sufficient to provide a representativesampling of the proteome for peptides of 10 -30 residues.
The amino acid composition of the peptides in the library
was shown in Figure 3. Figure 3a plotted the amino acid com-position of the peptides in the human library as a fraction ofthe total number of residues in the library. Figure 3b comparedthose compositions to the amino composition of the fullENSEMBL prediction of the human proteome. Both histogramswere ordered from the most enriched (aspartic acid) to themost depleted (arginine). The residues lysine and arginine areTable 1. the Current Size of Each of the Annotated Spectrum
Librariesa
H. sapiens
ENSEMBLM. musculus
ENSEMBLS. cerevisiae
SGD
disk space (megabytes) 28.5 14.9 7.0
modified peptides 45,743 21,705 13,125unmodified peptides 85,788 52,828 30,767total spectra 131,531 74,033 43,892spectra/gene 6.2 3.6 6.6
aAllowed modifications were methionine oxidation and cysteine alkyla-
tion.
Figure 2. Graph (a) shows the composition of the H. sapiens -
annotated peptide spectrum library as a function of peptidelength, in residues. Graph (b) shows the same data as a percentfraction of the total number of unique tryptic peptides presentin the human proteome with the same length.research articles Craig et al.
1846 Journal of Proteome Research ¥Vol. 5, No. 8, 2006a special case, as many of the peptides in the library were
generated by the tryptic cleavage of proteins (i.e., cleavage atthe peptide bond C-terminal to lysine or arginine residues).The difficulty in observing short peptides (see Figure 2) hasthe effect of removing those short tryptic peptides (which arerelatively rich in arginine and arginine) from the library,resulting in a relative depletion of these residues in the libraryas a whole.
The majority of residue types were within (10% of their
proteome-wide values. The hydrophobic residue tryptophanwas strongly depleted in the library compared to the proteome;however, it was also the least abundant residue in the pro-teome. Tryptophan residues can be sensitive to oxidation,resulting in a large number of possible degradation productsthat are not normally accounted for by proteomics identifica-tion searches. Tryptophan is also very hydrophobic and tendsto be found in membrane spanning domains and otherinsoluble peptides, which can cause a depletion of tryptophan-containing peptides during sample preparation and handling.
2. Demonstration of Spectrum Library-Based Protein
Identification. 2.1. General Findings. It was decided to limit
the protein identification results presented here to a simpledemonstration data set obtained from a relatively pure sample.The purpose of this paper was the discussion of the generalproperties of a library construction and library-based proteinidentification, rather explaining the many detailed differencesthat can arise between searches performed on large data setsfrom poorly characterized samples performed with differentsearch algorithms.Table 2 compares the results of performing an identification
search using the conventional search engine X! Tandem andthe spectrum library search engine, X! Hunter. The completelists of peptides identified in both cases were included asSupporting Information, and the search results themselves canbe examined using the GPMDB use interface. The calculationof the time required per spectrum excluded the time requiredto load protein sequences or spectrum libraries and the timerequired to write report information to disk: it represented onlythe calculation time required to perform the identifications.
All of the identifications in the two result sets were manually
inspected to ensure validity. A measure of the validity of theidentifications, in addition to the statistical confidence assign-ments, was that, for the X! Tandem search, only peptidesassignable to BSA were found. The X! Hunter search found onlytwo peptides associated with non-BSA proteins, both of whichwere assigned with low confidence. The number of expectedfalse positives for the X! Hunter search can be estimated bymultiplying the expectation value cutoff by the total numberof spectra identified, 0.01160)1.6, in good agreement with
the results.
In general, the spectrum library-based algorithm implemen-
tation performed significantly better than the conventionalalgorithm in terms of the number of peptides found, the con-fidence of identifications, and the time required to carry outthe search.
2.2. Speed. The time required to perform the conventional
search was approximately 1000 longer than the library-based
search. This improvement in performance has two independentunderlying causes. The first cause was simply a reduction inthe number of peptides being considered by the library search.The increase in speed corresponding to this cause was similarto that found for the proteotypic peptide search engine X! P3[23]. X! P3 performs searches approximately 10 faster than X!
Tandem by limiting its initial search to only the peptidesequences that generate the best signals for a particular proteinsequence. The list of peptides used by X! P3 is very similar tothe list of peptides used to annotate the spectrum libraries, asboth lists were composed from the same underlying data inthe GPMDB.
The other underlying cause for the speed difference between
two algorithms was the reduction in the complexity of thecalculation. In the conventional search engine, each candidatepeptide sequence must go through numerous calculations priorto the theoretical-to-experimental spectrum scoring. Initialcalculations are performed to determine the mass of the pep-tide so that it can be compared to the parent masses of theavailable mass spectra, to see if it could be a viable candidate.Next, the masses of all possible modified forms of the peptidesequence must be exhaustively enumerated. For those candi-date peptide sequences found to match the parent ion massof an experimental spectrum, the theoretical spectrum must
Figure 3. The amino acid composition of the human spectrum
library as a fraction of the total number of residues in the peptidesin the library. (a) The amino acid composition of the library, asa fraction of the total number of residues in the library. (b) Thedifference between the amino acid composition of the library andthe overall amino acid composition of the human proteome asa fraction of the proteome composition for that particular residue.Table 2. The Overall Performance of the Conventional Search
Engine X! Tandem, Compared to the Library Search Engine,X! Hunter
a
unique
peptides
assignedtotal
peptides
assignedprocessor
search time
(ms/spectrum)
conventional search 27 105 21.0
library search 36 158 0.020
aSimilar input parameters and the same set of spectra were used to
perform these searches.Using Annotated Peptide Mass Spectrum Libraries research articles
Journal of Proteome Research ¥Vol. 5, No. 8, 2006 1847be constructed. The mass of each residue is used to form
theoretical spectra for at least b- and y- fragment ion types.Multiply charged fragment ions may also need to be calculatedfor parent ions with more than two charges. As a roughmeasure of complexity, X! Tandem uses approximately 2600lines of code to calculate the permutations of modifications,parent ion masses, and theoretical spectra and only 50 linesof code to score the theoretical and experimental spectra. Thetime required to perform these calculations scales at bestlinearly with the number of peptides ( n
p) contained in the
protein sequences searched, O(n p).
The spectrum library matching implementation does not
require any of these calculations. Instead, the mass of eachexperimental spectrum was used to look up the appropriateset of library spectra within the parent ion mass tolerancespecified for the search. The lookup was performed by meansof an efficient binary search tree.
28Each library spectrum in
that set was then scored and the relevant information stored,thereby eliminating a large number of calculations. This algo-rithm results in overall performance that scales very slowly withthe number of spectra in the library ( n
l),O(log(n l)).
2.3. Sensitivity. An increase in sensitivity of the library search
algorithm as compared to the conventional one was expected.In the test data, it was able to increase both the number ofunique peptide sequences assigned by 9 (33%) and the totalnumber of assignments by 53 (50%), while only generating twofalse-positive identifications. At first glance, this sort of im-provement may not seem reasonable. The spectrum librarieswere all created out of X! Tandem-annotated spectra, so howcould it be that so many more assignments were made withthe library search? Clearly, X! Tandem must have been capableof annotating spectra from these peptide sequences, or elsethey would not be represented in the library at all. If this is so,then why have they been missed in this case?
Manual inspection of the spectra associated with the valid
assignments made by the library search that were not assignedby the theoretical spectrum approach showed that the spectrafell into two classes: (1) spectra with atypical fragment ionintensity distributions and (2) spectra with a significant numberof noise peaks. Most of the spectra that fell into the first classhad intense fragment ions caused by the neutral loss ofammonia ( -17 Da) or water ( -18 Da) from the conventional
b and y ion series, with relatively small signals correspondingto the b or y ions themselves.
The reason that the library spectrum search was more
sensitive at assigning these types of spectra was simple: thelibrary search benefited from considering only a limited num-ber of known characteristic peaks. When the results of tens ofthousands of experimental data sets were combined and eachpeptide was treated as a special case, the library spectrum'sprofile was a much more accurate representation of the exper-imental spectrum than any theoretical spectrum generatedfrom generally applicable rules. A conventional search enginecannot employ any such fine details of a generalized fragmen-tation model, as they will often generate an inappropriatechoice caused by the statistical uncertainties inherent in anymodel. Finding a few additional assignments would be of littlevalue if in doing so the validity of other results becomesquestionable. Therefore, a library search has a considerableadvantage when applied to spectra with atypical fragmentationpatterns.
3. Contrasting the Capabilities of Conventional and Library
Search Strategies. Even though spectrum library searches havesome significant practical advantages over theoretical spectrum
searches, they also have disadvantages. For example, a librarysearch cannot find anything that has not been previouslyobserved. Therefore, attempting to discover novel post-translational modifications using a library search would beinappropriate. The construction of spectrum libraries is not atrivial process, and it may not be possible to create a usefullibrary for proteomes that have not been regularly examinedusing proteomics. Therefore, library searching will only bepossible for a limited number of proteomes for the foreseeablefuture.
If a library can be constructed, however, a unique strength
is the ability to correct assignments, based on additional infor-mation. For example, if a sequence assignment has been madein error, a skilled individual may be able to determine thecorrect assignment and change the annotation in the library.Once that change has been made, the library search will alwaysproduce the correct assignment, even though the conventionalsearch will continue to make the same mistake. An applicationof this feature would be the annotation of spectra that simplydo not contain enough sequence-specific ions to be readilyassigned to any sequence. In these cases, it is often necessaryto apply higher order tandem fragmentation (MS
n) to determine
the identity of the sequence. Once that sequence has beendetermined, however, the original MS/MS spectrum can beannotated with the sequence, and it will not be necessary torepeat the more difficult (and potentially less sensitive) MS
n
analysis again.
Conclusions
We have demonstrated that it was possible to create an
annotated peptide tandem mass spectrum library of sufficientsize to be useful for the H. sapiens ,M. musculus , and S.
cerevisiae proteomes. These libraries were composed from the
most confident identifications obtained from numerous donorexperimental proteomics groups using different experimentalequipment and protocols. Therefore, these libraries representthe average set of ions generated from the subset of peptidesequences that produce interpretable tandem mass spectra.
These libraries were used to perform protein identifications,
by comparison of library spectra with experimental spectrausing an open source search engine, X! Hunter. This identifica-tion process was effective and rapid, as compared with moreconventional protein identification software.
Acknowledgment. We thank all of the laboratories that
were kind enough to contribute data to the GPMDB repository,
which made the development of the spectrum libraries pos-sible. In particular, we thank those responsible for the PeptideAtlas data repository, the Open Proteomics Database, and theHuman Plasma Proteome Project data repository. Additionaloutstanding contributions have been made by the groups ofRichard Smith, Leonard Foster, John Wilkins, Bill Vensel, PhilAndrews, and Tony Pawson. R.C.B. also thanks Stephen Stein(NIST) for discussions regarding the use of spectrum librariesin molecular identification.
Supporting Information Available: A complete list
of peptides identified using the conventional search engine X!
Tandem and the spectrum library search engine X! Hunter. Thismaterial is available free of charge via the Internet at http://pubs.acs.org.research articles Craig et al.
1848 Journal of Proteome Research ¥Vol. 5, No. 8, 2006References
(1) Lederberg, J.; Sutherland, G. L.; Buchanan, B. G.; Feigenbaum,
E. A.; Robertson, A. V.; Duffield, A. M.; Djerassi C. Applicationsof artificial intelligence for chemical inference. I. The number ofpossible organic compounds. acyclic structures containing C, H,O, and N. J. Am. Chem. Soc. 1969 ,91, 2973 -2976.
(2) Duffield, A. M.; Robertson, A. V.; Djerassi, C.; Buchanan B. G.;
Sutherland G. L.; Feigenbaum E. A.; Lederberg J. Applications ofartificial intelligence for chemical inference. II. Interpretation oflow-resolution mass spectra of ketones. J. Am. Chem. Soc. 1969 ,
91, 2977 -2981.
(3) Schroll, G.; Duffield A. M.; Djerassi, C.; Buchanan, B. G.; Suth-
erland, G. L.; Feigenbaum, E. A.; Lederberg, J. Applications ofartificial intelligence for chemical inference. III. Aliphatic ethersdiagnosed by their low-resolution mass spectra and nuclearmagnetic resonance data. J. Am. Chem. Soc. 1969 ,91, 2977 -2981.
(4) Roepstorff, P.; Fohlman, J. Proposal for a common nomenclature
for sequence ions in mass spectra of peptides. Biomed. Mass
Spectrom .1984 ,11, 601.
(5) Biemann, K.; Martin, S. A. Mass spectrometric determination of
the amino acid sequence of peptides and proteins. Mass Spec-
trom. Rev. 1987 ,6,1-76.
(6) Eng, J.; McCormack, A.; Yates, J. An approach to correlate tandem
mass spectral data of peptides with amino acid sequences in aprotein database. J. Am. Soc. Mass Spectrom. 1994 5, 976.
(7) Perkins, D. N.; Pappin, D. J.; Creasy, D. M.; Cottrell, J. S.
Probability-based protein identification by searching sequencedatabases using mass spectrometry data. Electrophoresis 1999 ,
20, 3551 -3567.
(8) Geer, L. Y.; Markey, S. P.; Kowalak, J. A.; Wagner L.; Xu, M.;
Maynard, D. M.; Yang, X.; Shi, W.; Bryant, S. H. Open massspectrometry search algorithm. J Proteome Res. 2004 ,3, 958 -
964.
(9) Craig, R.; Beavis, R. C. X! TANDEM: matching proteins with mass
spectra. Bioinformatics 2004, 20, 1466 -1467.
(10) Keller, A.; Nesvizhskii, A. I.; Kolker, E.; Aebersold, R. Empirical
statistical model to estimate the accuracy of peptide identifica-tions made by MS/MS and database search. Anal. Chem. 2002 ,
74, 5383 -5392.
(11) Fenyo È, D.; Beavis, R. C. A method for assessing the statistical
significance of mass spectrometry-based protein identificationsusing general scoring schemes. Anal. Chem. 2003 ,75, 768 -774.
(12) Heller, S. Conversational mass spectral retrieval system and its
use as an aid in structure determination. 1972 ,44, 1951 -1961.(13) Heller, S. The history of the NIST/EPA/NIH mass spectral
database, Today's Chemist at Work 1999 ,8,4 5-50.
(14) Stauffer, D. B.; McLafferty, F. W.; Ellis R. D.; Peterson, D. W.
Probability-based-matching algorithm with forward searchingcapabilities for matching unknown mass spectra of mixtures.Anal. Chem. 1985 ,57, 1056 -1060.
(15) TIAFT-User Contributed Collection of EI Mass Spectra, http://
www.tiaft.org/main/mslib.html.
(16) Mass Spectrometry Database Committee, http://www.ualberta.ca/
gjones/mslib.htm
(17) Aebi, B.; Bernhard, W. Advances in the use of mass spectral li-
braries for forensic toxicology. J. Anal. Toxicol. 2002 ,26, 149 -156.
(18) Gu, C.; Tsaprailis, G.; Breci, L.; Wysocki, V. H. Selective gas-phase
cleavage at the peptide bond C-terminal to aspartic acid in fixed-charge derivatives of Asp-containing peptides. Anal. Chem. 2000 ,
72, 5804 -5813.
(19) Wysocki, V. H.; Tsaprailis, G.; Smith, L. L.; Breci, L. A. Mobile
and localized protons: a framework for understanding peptidedissociation. J. Mass Spectrom. 2000 ,35, 1399 -1406.
(20) Tabb, D. L.; Huang, Y.; Wysocki, V. H.; Yates, J. R., III Influence
of basic residue content on fragment ion peak intensities in low-energy collision-induced dissociation spectra of peptides. Anal.
Chem. 2004 ,76, 1243 -1248.
(21) Aebersold R. Constellations in a cellular universe. Nature 2003 ,
422, 115 -116.
(22) Craig, R.; Cortens; J.; Beavis, R. C. An open source system for
analyzing, validating and storing protein identification data, J.
Proteome Res. 2004 ,3, 1234 -1242; http://www.thegpm.org.
(23) Craig, R, Cortens, J.; Beavis, R. C. The use of proteotypic peptide
profiling in a practical system for protein identification, Rapid
Commun. Mass Spectrom. 2005 ,19, 1844 -1850.
(24) Hubbard, T.; et al. Ensembl 2005, Nucleic Acids Res. ,2005 ,33,
D447 -D453.
(25) Hong, E. L.; et al. Saccharomyces Genome Database, http://
www.yeastgenome.org.
(26) Kersey, P. J.; Duarte, J.; Williams, A.; Karavidopoulou, Y.; Birney,
E.; Apweiler, R. The International Protein Index: An integrateddatabase for proteomics experiments, Proteomics 2004 ,4, 1985 -
1988.
(27) GPM X! Hunter Search page, http://h201.thegpm.org.(28) Cormen, T. H.; Leiserson, C. E.; Rivest, R. L.; Stein, C. Introduction
to Algorithms , 2nd ed.; McGraw-Hill: New York, 2001; pp
273-301.
PR0602085Using Annotated Peptide Mass Spectrum Libraries research articles
Journal of Proteome Research ¥Vol. 5, No. 8, 2006 1849